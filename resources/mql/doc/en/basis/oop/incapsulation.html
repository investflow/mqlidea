<h1>Encapsulation and Extensibility of Types</h1> 
<p><span>OOP is a balanced approach to writing software. Data and behavior are packed together. This encapsulation creates user-defined data types, extending the language data types and interacting with them. Types extensibility is an opportunity to add to the language user-defined data types, which are also easy to use, as well as <a href="/basis/types#base_types">basic types</a>.</span></p> 
<p><span>An abstract data type, for example, a string, is a description of the ideal, well known behavior type.</span></p> 
<p><span>The string user knows that the string operations, such as concatenation or print, have a certain behavior. Concatenation and print operations are called methods.</span></p> 
<p><span>A certain implementation of ADT may have some restrictions, for example, strings can be limited in length. These limitations affect the behavior opened to all. At the same time, internal or private implementation details do not affect directly the way the user sees the object. For example, the string is often implemented as an array, while the internal base address of this array and its name are not essential for the user.</span></p> 
<p><span>Encapsulation is the ability to hide the implementation details when the open interfaces to user-defined type is provided. In MQL4, as well as in C++, class and structure definitions (<a href="/basis/types/classes#class">class</a> and <a href="/basis/types/classes">struct</a>) are used for the encapsulation provisions in combination with access keywords </span><span style="color: #0000ff;">private</span><span>, </span><span style="color: #0000ff;">protected </span><span>and </span><span style="color: #0000ff;">public</span><span>. </span></p> 
<p><span>The </span><span style="color: #0000ff;">public</span><span> keyword shows that access to the members that stand behind it is open without restrictions. Without this keyword, class members are locked by default. Private members are accessible only by member functions only of its class.</span></p> 
<p><span>Protected class functions are available to class functions not only in its class, but also in its inheritor classes. Public class functions are available for any function within the scope of the class declaration. The protection makes possible to hide part of the class implementation, thus preventing unexpected changes in the structure of data. Access restriction or data hiding is a feature of the object-oriented programming.</span></p> 
<p><span>Usually, class functions are protected and declared with the </span><span style="color: #0000ff;">protected </span><span>modifier, the reading and writing of the values are performed by using special so-called set-and get-methods that are defined by the </span><span style="color: #0000ff;">public</span><span> access modifier.</span></p> 
<p><span>&nbsp;</span></p> 
<p><span style="font-weight: bold;">Example:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">class</span><span>&nbsp;CPerson</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #0000ff;">protected</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;name</span><br> <span style="color: #0000ff;">public</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">void</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetName(</span><span style="color: #0000ff;">string</span><span>&nbsp;n){m_name=n;}</span><span style="color: #808080;">//&nbsp;sets&nbsp;name</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetName(){</span><span style="color: #0000ff;">return</span><span>&nbsp;(m_name);}&nbsp;</span><span style="color: #808080;">//&nbsp;returns&nbsp;name</span><br> <span>&nbsp;&nbsp;};</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>&nbsp;</span></p> 
<p><span>This approach offers several advantages. First, by function name we can understand what it does - sets or gets the value of a class member. Secondly, perhaps in the future we will need to change the type of the m_name variable in the CPerson class or in any of its derivative classes.</span></p> 
<p><span>In this case, we'll need just to change the implementation of functions SetName() and GetName(), while objects of the CPerson class will be available for using in a program without any code changes because the user will not even know that the data type of m_name has changed.</span></p> 
<p><span style="font-weight: bold;">Example:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">struct</span><span>&nbsp;Name</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;name</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;last&nbsp;name</span><br> <span>&nbsp;&nbsp;};</span><br> <span>&nbsp;</span><br> <span style="color: #0000ff;">class</span><span>&nbsp;CPerson</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #0000ff;">protected</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;name</span><br> <span style="color: #0000ff;">public</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">void</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetName(</span><span style="color: #0000ff;">string</span><span>&nbsp;n);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetName(){</span><span style="color: #0000ff;">return</span><span>(m_name.first_name+</span><span style="color: #008080;">"&nbsp;"</span><span>+m_name.last_name);}</span><br> <span style="color: #0000ff;">private</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetFirstName(</span><span style="color: #0000ff;">string</span><span>&nbsp;full_name);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetLastName(</span><span style="color: #0000ff;">string</span><span>&nbsp;full_name);</span><br> <span>&nbsp;&nbsp;};</span><br> <span>&nbsp;</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;CPerson::SetName(</span><span style="color: #0000ff;">string</span><span>&nbsp;n)</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;m_name.first_name=GetFirstName(n);</span><br> <span>&nbsp;&nbsp;&nbsp;m_name.last_name=GetLastName(n);</span><br> <span>&nbsp;&nbsp;}</span><br> <span>&nbsp;</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;CPerson::GetFirstName(</span><span style="color: #0000ff;">string</span><span>&nbsp;full_name)</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;pos=</span><span style="color: #0000ff;">StringFind</span><span>(full_name,</span><span style="color: #008080;">"&nbsp;"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(pos&gt;0)&nbsp;</span><span style="color: #0000ff;">StringSetCharacter</span><span>(full_name,pos,0);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(full_name);</span><br> <span>&nbsp;&nbsp;}</span><br> <span>&nbsp;</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;CPerson::GetLastName(</span><span style="color: #0000ff;">string</span><span>&nbsp;full_name)</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;ret_string;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;pos=</span><span style="color: #0000ff;">StringFind</span><span>(full_name,</span><span style="color: #008080;">"&nbsp;"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(pos&gt;0)&nbsp;ret_string=</span><span style="color: #0000ff;">StringSubstr</span><span>(full_name,pos+1);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret_string=full_name;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(ret_string);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>See also</span></p> 
<p><span><a href="/basis/types">Data Types</a></span></p> 
<br>