<h1>WebRequest</h1> 
<p><span>The function sends an HTTP request to a specified server. The function has two versions:</span></p> 
<p><span>1. </span><span style="font-weight: bold;">Sending simple requests </span><span>of type "key=value" using the header Content-Type: application/x-www-form-urlencoded.</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span>int&nbsp;&nbsp;</span><span>WebRequest</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>method</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;HTTP&nbsp;method&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>url</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;URL</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>cookie</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;cookie</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>referer</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;referer</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>timeout</span><span>,</span><span>&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;timeout</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;char&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&amp;data[]</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;the&nbsp;array&nbsp;of&nbsp;the&nbsp;HTTP&nbsp;message&nbsp;body</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>data_size</span><span>,</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;</span><span>//&nbsp;data[]&nbsp;array&nbsp;size&nbsp;in&nbsp;bytes</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&amp;result[]</span><span>,</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;an&nbsp;array&nbsp;containing&nbsp;server&nbsp;response&nbsp;data</span><br> <span>&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&amp;result_headers&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;headers&nbsp;of&nbsp;server&nbsp;response</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>2. </span><span style="font-weight: bold;">Sending a request of any type</span><span> specifying the custom</span><span> set of headers for a more flexible interaction with various Web services.</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span>int&nbsp;&nbsp;</span><span>WebRequest</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>method</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;HTTP&nbsp;method</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>url</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;URL</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>headers</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;headers&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>timeout</span><span>,</span><span>&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;timeout</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;char&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&amp;data[]</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;the&nbsp;array&nbsp;of&nbsp;the&nbsp;HTTP&nbsp;message&nbsp;body</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&amp;result[]</span><span>,</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;an&nbsp;array&nbsp;containing&nbsp;server&nbsp;response&nbsp;data</span><br> <span>&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&amp;result_headers&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;headers&nbsp;of&nbsp;server&nbsp;response</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>Parameters</span></p> 
<p><span>method</span></p> 
<p><span>[in] &nbsp;HTTP method.</span></p> 
<p><span>url</span></p> 
<p><span>[in] &nbsp;URL.</span></p> 
<p><span>headers</span></p> 
<p><span>[in] &nbsp;Request headers of type "key: value", separated by a line break "\r\n".</span></p> 
<p><span>cookie</span></p> 
<p><span>[in] &nbsp;Cookie value.</span></p> 
<p><span>referer</span></p> 
<p><span>[in] &nbsp;Value of the Referer header of the HTTP request.</span></p> 
<p><span>timeout</span></p> 
<p><span>[in] &nbsp;Timeout in milliseconds.</span></p> 
<p><span>data[]</span></p> 
<p><span>[in] &nbsp;Data array of the HTTP message body.</span></p> 
<p><span>data_size</span></p> 
<p><span>[in] &nbsp;Size of the data[] array.</span></p> 
<p><span>result[]</span></p> 
<p><span>[out] &nbsp;An array containing server response data.</span></p> 
<p><span>result_headers</span></p> 
<p><span>[out] Server response headers.</span></p> 
<p><span>Returned value</span></p> 
<p><span>HTTP server response code or -1 for an error.</span></p> 
<p><span>Note</span></p> 
<p><span>To use the WebRequest() function, add the addresses of the required servers in the list of allowed URLs in the "Expert Advisors" tab of the "Options" window. Server port is automatically selected on the basis of the specified protocol - 80 for "http://" and 443 for "https://".</span></p> 
<p><span>The WebRequest() function is synchronous, which means its breaks the program execution and waits for the response from the requested server. Since the delays in receiving a response can be large, the function is not available for calls from the indicators, because indicators run in a common thread shared by all indicators and charts on one symbol. Indicator performance delay on one of the charts of a symbol may stop updating of all charts of the same symbol.</span></p> 
<p><span>The function can be called only from Expert Advisors and scripts, as they run in their own execution threads. If you try to call the function from an indicator, <a href="/check/getlasterror">GetLastError()</a> will return error 4060 Â— "Function is not allowed for call".</span></p> 
<p><span>WebRequest() cannot be executed in the <a href="/runtime/testing#alert_etc">Strategy Tester</a>.</span></p> 
<p><span style="font-weight: bold;">An example of using the first version of the </span><span>WebRequest ()</span><span style="font-weight: bold;"> function:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;cookie=</span><span style="color: #0000ff;">NULL</span><span>,headers;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">char</span><span>&nbsp;post[],result[];</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;res;</span><br> <span style="color: #808080;">//---&nbsp;to&nbsp;enable&nbsp;access&nbsp;to&nbsp;the&nbsp;server,&nbsp;you&nbsp;should&nbsp;add&nbsp;URL&nbsp;"https://www.google.com/finance"</span><br> <span style="color: #808080;">//---&nbsp;in&nbsp;the&nbsp;list&nbsp;of&nbsp;allowed&nbsp;URLs&nbsp;(Main&nbsp;Menu-&gt;Tools-&gt;Options,&nbsp;tab&nbsp;"Expert&nbsp;Advisors"):</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;google_url=</span><span style="color: #008080;">"https://www.google.com/finance"</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;Reset&nbsp;the&nbsp;last&nbsp;error&nbsp;code</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span style="color: #808080;">//---&nbsp;Loading&nbsp;a&nbsp;html&nbsp;page&nbsp;from&nbsp;Google&nbsp;Finance</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int&nbsp;</span><span>timeout=5000;&nbsp;</span><span style="color: #808080;">//---&nbsp;Timeout&nbsp;below&nbsp;1000&nbsp;(1&nbsp;sec.)&nbsp;is&nbsp;not&nbsp;enough&nbsp;for&nbsp;slow&nbsp;Internet&nbsp;connection</span><br> <span>&nbsp;&nbsp;&nbsp;res=</span><span style="color: #0000ff;">WebRequest</span><span>(</span><span style="color: #008080;">"GET"</span><span>,google_url,cookie,</span><span style="color: #0000ff;">NULL</span><span>,timeout,post,0,result,headers);</span><br> <span style="color: #808080;">//---&nbsp;Checking&nbsp;errors</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(res==-1)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Error&nbsp;in&nbsp;WebRequest.&nbsp;Error&nbsp;code&nbsp;&nbsp;="</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Perhaps&nbsp;the&nbsp;URL&nbsp;is&nbsp;not&nbsp;listed,&nbsp;display&nbsp;a&nbsp;message&nbsp;about&nbsp;the&nbsp;necessity&nbsp;to&nbsp;add&nbsp;the&nbsp;address</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">MessageBox</span><span>(</span><span style="color: #008080;">"Add&nbsp;the&nbsp;address&nbsp;'"</span><span>+google_url+</span><span style="color: #008080;">"'&nbsp;in&nbsp;the&nbsp;list&nbsp;of&nbsp;allowed&nbsp;URLs&nbsp;on&nbsp;tab&nbsp;'Expert&nbsp;Advisors'"</span><span>,</span><span style="color: #008080;">"Error"</span><span>,</span><span style="color: #0000ff;">MB_ICONINFORMATION</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Load&nbsp;successfully</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"The&nbsp;file&nbsp;has&nbsp;been&nbsp;successfully&nbsp;loaded,&nbsp;File&nbsp;size&nbsp;=%d&nbsp;bytes."</span><span>,</span><span style="color: #0000ff;">ArraySize</span><span>(result));</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Save&nbsp;the&nbsp;data&nbsp;to&nbsp;a&nbsp;file</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;filehandle=</span><span style="color: #0000ff;">FileOpen</span><span>(</span><span style="color: #008080;">"GoogleFinance.htm"</span><span>,</span><span style="color: #0000ff;">FILE_WRITE</span><span>|</span><span style="color: #0000ff;">FILE_BIN</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Checking&nbsp;errors</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(filehandle!=</span><span style="color: #0000ff;">INVALID_HANDLE</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Save&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;result[]&nbsp;array&nbsp;to&nbsp;a&nbsp;file</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">FileWriteArray</span><span>(filehandle,result,0,</span><span style="color: #0000ff;">ArraySize</span><span>(result));</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Close&nbsp;the&nbsp;file</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">FileClose</span><span>(filehandle);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><span>&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Error&nbsp;in&nbsp;FileOpen.&nbsp;Error&nbsp;code="</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>&nbsp;</span></p> 
<p><span style="font-weight: bold;">An example of using the second version of the </span><span>WebRequest()</span><span style="font-weight: bold;"> function:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">link</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"https://www.mql5.com"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">version</span><span>&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"1.00"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">strict</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">script_show_inputs</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"Sample&nbsp;script&nbsp;posting&nbsp;a&nbsp;user&nbsp;message&nbsp;"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"on&nbsp;the&nbsp;wall&nbsp;on&nbsp;mql5.com"</span><br> <span>&nbsp;</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpLogin</span><span>&nbsp;&nbsp;&nbsp;=</span><span style="color: #008080;">""</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//Your&nbsp;MQL5.com&nbsp;account</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpPassword</span><span>=</span><span style="color: #008080;">""</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//Your&nbsp;account&nbsp;password</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpFileName</span><span>=</span><span style="color: #008080;">"EURUSDM5.png"</span><span>;&nbsp;</span><span style="color: #808080;">//An&nbsp;image&nbsp;in&nbsp;folder&nbsp;MQL5/Files/</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpFileType</span><span>=</span><span style="color: #008080;">"image/png"</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//Correct&nbsp;mime&nbsp;type&nbsp;of&nbsp;the&nbsp;image</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Posting&nbsp;a&nbsp;message&nbsp;with&nbsp;an&nbsp;image&nbsp;on&nbsp;the&nbsp;wall&nbsp;at&nbsp;mql5.com&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;PostToNewsFeed(</span><span style="color: #0000ff;">string</span><span>&nbsp;login,</span><span style="color: #0000ff;">string</span><span>&nbsp;password,</span><span style="color: #0000ff;">string</span><span>&nbsp;text,</span><span style="color: #0000ff;">string</span><span>&nbsp;filename,</span><span style="color: #0000ff;">string</span><span>&nbsp;filetype)</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;res;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;To&nbsp;receive&nbsp;the&nbsp;operation&nbsp;execution&nbsp;result</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">char</span><span>&nbsp;&nbsp;&nbsp;data[];&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Data&nbsp;array&nbsp;to&nbsp;send&nbsp;POST&nbsp;requests</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">char</span><span>&nbsp;&nbsp;&nbsp;file[];&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Read&nbsp;the&nbsp;image&nbsp;here</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;str=</span><span style="color: #008080;">"Login="</span><span>+login+</span><span style="color: #008080;">"&amp;Password="</span><span>+password;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;auth,sep=</span><span style="color: #008080;">"-------Jyecslin9mp8RdKV"</span><span>;&nbsp;</span><span style="color: #808080;">//&nbsp;multipart&nbsp;data&nbsp;separator</span><br> <span style="color: #808080;">//---&nbsp;A&nbsp;file&nbsp;is&nbsp;available,&nbsp;try&nbsp;to&nbsp;read&nbsp;it</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(filename!=</span><span style="color: #0000ff;">NULL</span><span>&nbsp;&amp;&amp;&nbsp;filename!=</span><span style="color: #008080;">""</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res=</span><span style="color: #0000ff;">FileOpen</span><span>(filename,</span><span style="color: #0000ff;">FILE_READ</span><span>|</span><span style="color: #0000ff;">FILE_BIN</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(res&lt;0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Error&nbsp;opening&nbsp;the&nbsp;file&nbsp;\""+filename+"</span><span>\</span><span style="color: #008080;">""</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Read&nbsp;file&nbsp;data</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileReadArray</span><span>(res,file)!=</span><span style="color: #0000ff;">FileSize</span><span>(res))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">FileClose</span><span>(res);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Error&nbsp;reading&nbsp;the&nbsp;file&nbsp;\""+filename+"</span><span>\</span><span style="color: #008080;">""</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">FileClose</span><span>(res);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;Create&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;POST&nbsp;request&nbsp;for&nbsp;authorization</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(data,</span><span style="color: #0000ff;">StringToCharArray</span><span>(str,data,0,</span><span style="color: #0000ff;">WHOLE_ARRAY</span><span>,</span><span style="color: #0000ff;">CP_UTF8</span><span>)-1);</span><br> <span style="color: #808080;">//---&nbsp;Resetting&nbsp;error&nbsp;code</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span style="color: #808080;">//---&nbsp;Authorization&nbsp;request</span><br> <span>&nbsp;&nbsp;&nbsp;res=</span><span style="color: #0000ff;">WebRequest</span><span>(</span><span style="color: #008080;">"POST"</span><span>,</span><span style="color: #008080;">"https://www.mql5.com/en/auth_login"</span><span>,</span><span style="color: #0000ff;">NULL</span><span>,0,data,data,str);</span><br> <span style="color: #808080;">//---&nbsp;If&nbsp;authorization&nbsp;failed</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(res!=200)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Authorization&nbsp;error&nbsp;#"</span><span>+(</span><span style="color: #0000ff;">string</span><span>)res+</span><span style="color: #008080;">",&nbsp;LastError="</span><span>+(</span><span style="color: #0000ff;">string</span><span>)</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;Read&nbsp;the&nbsp;authorization&nbsp;cookie&nbsp;from&nbsp;the&nbsp;server&nbsp;response&nbsp;header</span><br> <span>&nbsp;&nbsp;&nbsp;res=</span><span style="color: #0000ff;">StringFind</span><span>(str,</span><span style="color: #008080;">"Set-Cookie:&nbsp;auth="</span><span>);</span><br> <span style="color: #808080;">//---&nbsp;If&nbsp;cookie&nbsp;not&nbsp;found,&nbsp;return&nbsp;an&nbsp;error</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(res&lt;0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Error,&nbsp;authorization&nbsp;data&nbsp;not&nbsp;found&nbsp;in&nbsp;the&nbsp;server&nbsp;response&nbsp;(check&nbsp;login/password)"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;Remember&nbsp;the&nbsp;authorization&nbsp;data&nbsp;and&nbsp;form&nbsp;the&nbsp;header&nbsp;for&nbsp;further&nbsp;requests</span><br> <span>&nbsp;&nbsp;&nbsp;auth=</span><span style="color: #0000ff;">StringSubstr</span><span>(str,res+12);</span><br> <span>&nbsp;&nbsp;&nbsp;auth=</span><span style="color: #008080;">"Cookie:&nbsp;"</span><span>+</span><span style="color: #0000ff;">StringSubstr</span><span>(auth,0,</span><span style="color: #0000ff;">StringFind</span><span>(auth,</span><span style="color: #008080;">";"</span><span>)+1)+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;data&nbsp;file,&nbsp;send&nbsp;it&nbsp;to&nbsp;the&nbsp;server</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">ArraySize</span><span>(file)!=0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Form&nbsp;the&nbsp;request&nbsp;body</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str=</span><span style="color: #008080;">"--"</span><span>+sep+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str+=</span><span style="color: #008080;">"Content-Disposition:&nbsp;form-data;&nbsp;name=\"</span><span>attachedFile_imagesLoader\</span><span style="color: #008080;">";&nbsp;filename=\""+filename+"</span><span>\</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str+=</span><span style="color: #008080;">"Content-Type:&nbsp;"</span><span>+filetype+</span><span style="color: #008080;">"\r\n\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=</span><span style="color: #0000ff;">StringToCharArray</span><span>(str,data);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res+=</span><span style="color: #0000ff;">ArrayCopy</span><span>(data,file,res-1,0);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res+=</span><span style="color: #0000ff;">StringToCharArray</span><span>(</span><span style="color: #008080;">"\r\n--"</span><span>+sep+</span><span style="color: #008080;">"--\r\n"</span><span>,data,res-1);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(data,</span><span style="color: #0000ff;">ArraySize</span><span>(data)-1);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Form&nbsp;the&nbsp;request&nbsp;header</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str=auth+</span><span style="color: #008080;">"Content-Type:&nbsp;multipart/form-data;&nbsp;boundary="</span><span>+sep+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Reset&nbsp;error&nbsp;code</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Request&nbsp;to&nbsp;send&nbsp;an&nbsp;image&nbsp;file&nbsp;to&nbsp;the&nbsp;server</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res=</span><span style="color: #0000ff;">WebRequest</span><span>(</span><span style="color: #008080;">"POST"</span><span>,</span><span style="color: #008080;">"https://www.mql5.com/upload_file"</span><span>,str,0,data,data,str);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;check&nbsp;the&nbsp;request&nbsp;result</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(res!=200)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Error&nbsp;sending&nbsp;a&nbsp;file&nbsp;to&nbsp;the&nbsp;server&nbsp;#"</span><span>+(</span><span style="color: #0000ff;">string</span><span>)res+</span><span style="color: #008080;">",&nbsp;LastError="</span><span>+(</span><span style="color: #0000ff;">string</span><span>)</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Receive&nbsp;a&nbsp;link&nbsp;to&nbsp;the&nbsp;image&nbsp;uploaded&nbsp;to&nbsp;the&nbsp;server</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str=</span><span style="color: #0000ff;">CharArrayToString</span><span>(data);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">StringFind</span><span>(str,</span><span style="color: #008080;">"{\"</span><span>Url\</span><span style="color: #008080;">":\"")==0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</span><span style="color: #0000ff;">StringFind</span><span>(str,</span><span style="color: #008080;">"\"",8);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=</span><span style="color: #0000ff;">StringSubstr</span><span>(str,8,res-8);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;If&nbsp;file&nbsp;uploading&nbsp;fails,&nbsp;an&nbsp;empty&nbsp;link&nbsp;will&nbsp;be&nbsp;returned</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(filename==</span><span style="color: #008080;">""</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"File&nbsp;sending&nbsp;to&nbsp;server&nbsp;failed"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;Create&nbsp;the&nbsp;body&nbsp;of&nbsp;a&nbsp;request&nbsp;to&nbsp;post&nbsp;an&nbsp;image&nbsp;on&nbsp;the&nbsp;server</span><br> <span>&nbsp;&nbsp;&nbsp;str&nbsp;=</span><span style="color: #008080;">"--"</span><span>+sep+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;str+=</span><span style="color: #008080;">"Content-Disposition:&nbsp;form-data;&nbsp;name=\"</span><span>content\</span><span style="color: #008080;">"\r\n\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;str+=text+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;The&nbsp;languages&nbsp;in&nbsp;which&nbsp;the&nbsp;post&nbsp;will&nbsp;be&nbsp;available&nbsp;on&nbsp;mql5.com&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;str+=</span><span style="color: #008080;">"--"</span><span>+sep+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;str+=</span><span style="color: #008080;">"Content-Disposition:&nbsp;form-data;&nbsp;name=\"</span><span>AllLanguages\</span><span style="color: #008080;">"\r\n\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;str+=</span><span style="color: #008080;">"on\r\n"</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;If&nbsp;the&nbsp;picture&nbsp;has&nbsp;been&nbsp;uploaded&nbsp;on&nbsp;the&nbsp;server,&nbsp;pass&nbsp;its&nbsp;link</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">ArraySize</span><span>(file)!=0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str+=</span><span style="color: #008080;">"--"</span><span>+sep+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str+=</span><span style="color: #008080;">"Content-Disposition:&nbsp;form-data;&nbsp;name=\"</span><span>attachedImage_0\</span><span style="color: #008080;">"\r\n\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str+=filename+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;The&nbsp;final&nbsp;string&nbsp;of&nbsp;the&nbsp;multipart&nbsp;request</span><br> <span>&nbsp;&nbsp;&nbsp;str+=</span><span style="color: #008080;">"--"</span><span>+sep+</span><span style="color: #008080;">"--\r\n"</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;Out&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;POST&nbsp;request&nbsp;together&nbsp;in&nbsp;one&nbsp;string</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">StringToCharArray</span><span>(str,data,0,</span><span style="color: #0000ff;">WHOLE_ARRAY</span><span>,</span><span style="color: #0000ff;">CP_UTF8</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(data,</span><span style="color: #0000ff;">ArraySize</span><span>(data)-1);</span><br> <span style="color: #808080;">//---&nbsp;Prepare&nbsp;the&nbsp;request&nbsp;header&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;str=auth+</span><span style="color: #008080;">"Content-Type:&nbsp;multipart/form-data;&nbsp;boundary="</span><span>+sep+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;Request&nbsp;to&nbsp;post&nbsp;a&nbsp;message&nbsp;on&nbsp;the&nbsp;user&nbsp;wall&nbsp;at&nbsp;mql5.com</span><br> <span>&nbsp;&nbsp;&nbsp;res=</span><span style="color: #0000ff;">WebRequest</span><span>(</span><span style="color: #008080;">"POST"</span><span>,</span><span style="color: #008080;">"https://www.mql5.com/ru/users/"</span><span>+login+</span><span style="color: #008080;">"/wall"</span><span>,str,0,data,data,str);</span><br> <span style="color: #808080;">//---&nbsp;Return&nbsp;true&nbsp;for&nbsp;successful&nbsp;execution</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(res==200);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;Post&nbsp;a&nbsp;message&nbsp;on&nbsp;mql5.com,&nbsp;including&nbsp;an&nbsp;image,&nbsp;the&nbsp;path&nbsp;to&nbsp;which&nbsp;is&nbsp;taken&nbsp;from&nbsp;the&nbsp;InpFileName&nbsp;parameter</span><br> <span>&nbsp;&nbsp;&nbsp;PostToNewsFeed(</span><span style="color: #800000;">InpLogin</span><span>,</span><span style="color: #800000;">InpPassword</span><span>,</span><span style="color: #008080;">"Checking&nbsp;the&nbsp;expanded&nbsp;version&nbsp;of&nbsp;WebRequest\r\n"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"(This&nbsp;message&nbsp;has&nbsp;been&nbsp;posted&nbsp;by&nbsp;the&nbsp;WebRequest.mq5&nbsp;script)"</span><span>,</span><span style="color: #800000;">InpFileName</span><span>,</span><span style="color: #800000;">InpFileType</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>&nbsp;</span></p> 
<br>