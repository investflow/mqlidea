<h1>FileFindFirst</h1> 
<p><span>The function starts the search of files or </span><span>subdirectories</span><span> in a directory in accordance with the specified filter.</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span>long&nbsp;&nbsp;</span><span>FileFindFirst</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string</span><span>&nbsp;&nbsp;&nbsp;</span><span>file_filter</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;String&nbsp;-&nbsp;search&nbsp;filter</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>string&amp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>returned_filename</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;Name&nbsp;of&nbsp;the&nbsp;file&nbsp;or&nbsp;subdirectory&nbsp;found</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>common_flag=0</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;Defines&nbsp;the&nbsp;search</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>Parameters</span></p> 
<p><span>file_filter</span></p> 
<p><span>[in] &nbsp;Search filter. A subdirectory (or sequence of nested subdirectories) relative to the \Files directory, in which files should be searched for, can be specified in the filter.</span></p> 
<p><span>returned_filename</span></p> 
<p><span>[out] &nbsp;The returned parameter, where, in case of success, the name of the first found file or subdirectory is placed. Only the file name is returned (including the extension), the directories and subdirectories are not included no matter if they are specified or not in the search filter.</span></p> 
<p><span>common_flag</span></p> 
<p><span>[in] <a href="/constants/io_constants/fileflags">Flag</a> determining the location of the file. If common_flag = FILE_COMMON, then the file is located in a shared folder for all client terminals \Terminal\Common\Files. Otherwise, the file is located in a local folder.</span></p> 
<p><span>Return Value</span></p> 
<p><span>Returns handle of the object searched, which should be used for further sorting of files and subdirectories by the <a href="/files/filefindnext">FileFindNext()</a> function, or <a href="/constants/namedconstants/otherconstants">INVALID_HANDLE</a> when there is no file and </span><span>subdirectory</span><span> corresponding to the filter (in the particular case - when the directory is empty). After searching, the handle must be closed using the <a href="/files/filefindclose">FileFindClose()</a> function.</span></p> 
<p><span>Note</span></p> 
<p><span>For security reasons, work with files is strictly controlled in the MQL4 language. Files with which file operations are conducted using MQL4 means, cannot be outside the file sandbox.</span></p> 
<p><span style="font-weight: bold;">Example:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;display&nbsp;the&nbsp;window&nbsp;of&nbsp;input&nbsp;parameters&nbsp;when&nbsp;launching&nbsp;the&nbsp;script</span><br> <span style="color: #008080;">#</span><span>property&nbsp;</span><span style="color: #0000ff;">script_show_inputs</span><br> <span style="color: #808080;">//---&nbsp;filter</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;InpFilter="Dir1\\*";</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;file_name;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;int_dir="";</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;i=1,pos=0,last_pos=-1;</span><br> <span style="color: #808080;">//---&nbsp;search&nbsp;for&nbsp;the&nbsp;last&nbsp;backslash</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">while</span><span>(!</span><span style="color: #0000ff;">IsStopped</span><span>())</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos=</span><span style="color: #0000ff;">StringFind</span><span>(InpFilter,"\\",pos+1);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(pos&gt;=0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_pos=pos;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">break</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;the&nbsp;filter&nbsp;contains&nbsp;the&nbsp;folder&nbsp;name</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(last_pos&gt;=0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int_dir=</span><span style="color: #0000ff;">StringSubstr</span><span>(InpFilter,0,last_pos+1);</span><br> <span style="color: #808080;">//---&nbsp;get&nbsp;the&nbsp;search&nbsp;handle&nbsp;in&nbsp;the&nbsp;root&nbsp;of&nbsp;the&nbsp;local&nbsp;folder</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;search_handle=</span><span style="color: #0000ff;">FileFindFirst</span><span>(InpFilter,file_name);</span><br> <span style="color: #808080;">//---&nbsp;check&nbsp;if&nbsp;the&nbsp;FileFindFirst()&nbsp;is&nbsp;executed&nbsp;successfully</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(search_handle!=</span><span style="color: #0000ff;">INVALID_HANDLE</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;in&nbsp;a&nbsp;loop,&nbsp;check&nbsp;if&nbsp;the&nbsp;passed&nbsp;strings&nbsp;are&nbsp;the&nbsp;names&nbsp;of&nbsp;files&nbsp;or&nbsp;directories</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">do</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;if&nbsp;it's&nbsp;a&nbsp;file,&nbsp;the&nbsp;function&nbsp;returns&nbsp;true,&nbsp;and&nbsp;if&nbsp;it's&nbsp;a&nbsp;directory,&nbsp;it&nbsp;returns&nbsp;error&nbsp;ERR_FILE_IS_DIRECTORY</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">FileIsExist</span><span>(int_dir+file_name);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>("%d&nbsp;:&nbsp;%s&nbsp;name&nbsp;=&nbsp;%s",i,</span><span style="color: #0000ff;">GetLastError</span><span>()==</span><span style="color: #0000ff;">ERR_FILE_IS_DIRECTORY</span><span>&nbsp;?&nbsp;"Directory"&nbsp;:&nbsp;"File",file_name);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i++;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">while</span><span>(</span><span style="color: #0000ff;">FileFindNext</span><span>(search_handle,file_name));</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;close&nbsp;the&nbsp;search&nbsp;handle</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">FileFindClose</span><span>(search_handle);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>("Files&nbsp;not&nbsp;found!");</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>See also</span></p> 
<p><span><a href="/files/filefindnext">FileFindNext()</a>, <a href="/files/filefindclose">FileFindClose()</a></span></p> 
<br>