<h1>Условный оператор ?:</h1> 
<p><span>Общая форма тернарного оператора выглядит так:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span>выражение</span><span style="color: #008080;">1&nbsp;</span><span>?&nbsp;выражение</span><span style="color: #008080;">2&nbsp;</span><span>:&nbsp;выражение</span><span style="color: #008080;">3</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>В качестве первого операнда – "выражение1" – может быть использовано любое выражение, результатом которого является значение типа <a href="/basis/types/integer/boolconst">bool</a>. Если результат равен </span><span style="color: #0000ff;">true</span><span>, то выполняется оператор, заданный вторым операндом, то есть, "выражение2". </span></p>
<p><span>Если же первый операнд paвен </span><span style="color: #0000ff;">false</span><span>, то выполняется третий операнд – "выражениеЗ". Второй и третий операнды, то есть "выражение2" и "выражениеЗ", должны возвращать значения одного типа и не должны иметь тип <a href="/basis/types/void">void</a>. Результатом выполнения условного оператора является результат "выражения2" либо результат "выражение3", в зависимости от результата "выражение1".</span></p>
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;пронормируем&nbsp;разность&nbsp;между&nbsp;ценами&nbsp;открытия&nbsp;и&nbsp;закрытия&nbsp;на&nbsp;дневной&nbsp;размах</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;true_range&nbsp;=&nbsp;(High==Low)?</span><span style="color: #008080;">0</span><span>:(Close-Open)/(High-Low);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Эта запись эквивалентна следующей</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">double</span><span>&nbsp;true_range;</span><br> <span style="color: #0000ff;">if</span><span>(High==Low)true_range=</span><span style="color: #008000;">0</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;если&nbsp;High&nbsp;и&nbsp;Low&nbsp;равны</span><br> <span style="color: #0000ff;">else</span><span>&nbsp;true_range=(Close-Open)/(High-Low);&nbsp;</span><span style="color: #808080;">//&nbsp;если&nbsp;размах&nbsp;ненулевой</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>&nbsp;</span></p> 
<h2><a id="limitation"></a>Ограничения по использованию оператора</h2> 
<p><span>Оператор на основании значения "выражение1" должен вернуть одно из двух значений - либо "выражение2", либо "выражение3". Существует ряд ограничений на эти выражения:</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 20px; margin: 2px 17px 3px 17px;"><span style="font-size:10pt; font-family: 'Trebuchet MS';color:#565656;display:inline-block;width:20px;margin-left:-20px">1.</span><span>Нельзя смешивать <a href="/basis/types/classes">пользовательский тип</a> с <a href="/basis/types#base_types">простым типом</a> или <a href="/basis/types/integer/enumeration">перечислением</a>. Для <a href="/basis/types/object_pointers">указателя</a> допустимо использовать <a href="/basis/types/void">NULL</a>.</span></p>
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 20px; margin: 2px 17px 3px 17px;"><span style="font-size:10pt; font-family: 'Trebuchet MS';color:#565656;display:inline-block;width:20px;margin-left:-20px">2.</span><span>Если типы значений простые, то типом оператора будет максимальный тип (смотри <a href="/basis/types/casting">Приведение типов</a>).</span></p>
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 20px; margin: 2px 17px 3px 17px;"><span style="font-size:10pt; font-family: 'Trebuchet MS';color:#565656;display:inline-block;width:20px;margin-left:-20px">3.</span><span>Если одно из значений имеет тип перечисление, а второе является числовым типом, то перечисление заменяется на int и действует второе правило.</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 20px; margin: 2px 17px 3px 17px;"><span style="font-size:10pt; font-family: 'Trebuchet MS';color:#565656;display:inline-block;width:20px;margin-left:-20px">4.</span><span>Если оба значения являются значениями перечислений, то их типы должны быть одинаковыми, и типом оператора будет перечисление.</span></p> 
<p><span>Ограничения для пользовательских типов (классов или структур):</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 20px; margin: 2px 17px 3px 17px;"><span style="font-size:10pt; font-family: 'Trebuchet MS';color:#565656;display:inline-block;width:20px;margin-left:-20px">a)</span><span>типы должны быть одинаковыми или один должен <a href="/basis/oop/inheritance">наследоваться</a> от другого.</span></p>
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 20px; margin: 2px 17px 3px 17px;"><span style="font-size:10pt; font-family: 'Trebuchet MS';color:#565656;display:inline-block;width:20px;margin-left:-20px">b)</span><span>если типы не одинаковы (наследование), то потомок неявно приводится к родителю, то есть типом оператора будет тип родителя.</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 20px; margin: 2px 17px 3px 17px;"><span style="font-size:10pt; font-family: 'Trebuchet MS';color:#565656;display:inline-block;width:20px;margin-left:-20px">c)</span><span>нельзя смешивать объект и указатель – либо оба выражения являются объектами, либо <a href="/basis/types/object_pointers">указателями</a>. Для указателя допустимо использовать <a href="/basis/types/void">NULL</a>.</span></p>
<p><span>Примечание</span></p> 
<p><span>Будьте внимательны при использовании условного оператора в качестве аргумента <a href="/basis/function/functionoverload">перегруженной функции</a>, так как тип результата условного оператора определяется на момент компиляции программы. И этот тип <a href="/basis/types/casting">определяется</a> как больший тип из типов "выражение2" и "выражение3".</span></p>
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">void</span><span>&nbsp;func(</span><span style="color: #0000ff;">double</span><span>&nbsp;d)&nbsp;{&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"double&nbsp;argument:&nbsp;"</span><span>,d);&nbsp;}</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;func(</span><span style="color: #0000ff;">string</span><span>&nbsp;s)&nbsp;{&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"string&nbsp;argument:&nbsp;"</span><span>,s);&nbsp;}</span><br> <span>&nbsp;</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;Expression1=true;</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;Expression2=M_PI;</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;Expression3=</span><span style="color: #008080;">"3.1415926"</span><span>;</span><br> <span>&nbsp;</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;func(Expression2);</span><br> <span>&nbsp;&nbsp;&nbsp;func(Expression3);</span><br> <span>&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;func(Expression1?Expression2:Expression3);&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;получим&nbsp;предупреждение&nbsp;компилятора&nbsp;о&nbsp;явном&nbsp;приведении&nbsp;к&nbsp;типу&nbsp;string</span><br> <span>&nbsp;&nbsp;&nbsp;func(!Expression1?Expression2:Expression3);&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;получим&nbsp;предупреждение&nbsp;компилятора&nbsp;о&nbsp;явном&nbsp;приведении&nbsp;к&nbsp;типу&nbsp;string</span><br> <span>&nbsp;&nbsp;}</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//&nbsp;&nbsp;&nbsp;Результат:</span><br> <span style="color: #808080;">//&nbsp;&nbsp;&nbsp;double&nbsp;argument:&nbsp;3.141592653589793</span><br> <span style="color: #808080;">//&nbsp;&nbsp;&nbsp;string&nbsp;argument:&nbsp;3.1415926</span><br> <span style="color: #808080;">//&nbsp;&nbsp;&nbsp;string&nbsp;argument:&nbsp;3.141592653589793</span><br> <span style="color: #808080;">//&nbsp;&nbsp;&nbsp;string&nbsp;argument:&nbsp;3.1415926</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Смотри также</span></p> 
<p><span><a href="/basis/variables/initialization">Инициализация переменных</a>, <a href="/basis/variables/variable_scope">Область видимости и время жизни переменных</a>, <a href="/basis/variables/object_live">Создание и уничтожение объектов</a></span></p>
<br>