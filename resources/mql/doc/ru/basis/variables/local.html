<h1>Локальные переменные</h1> 
<p><span>Переменная, объявленная внутри какой-либо <a href="/ru/basis/function">функции</a>, является локальной. Область видимости локальной переменной ограничена пределами функции, внутри которой она объявлена. Локальная переменная может быть <a href="/ru/basis/variables/initialization">проинициализирована</a> при помощи любого <a href="/ru/basis/operators/expression">выражения</a>. Инициализация локальной переменной производится каждый раз при вызове соответствующей функции. Локальные переменные располагаются во временной области памяти соответствующей функции.</span></p> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">int</span><span>&nbsp;somefunc()</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;ret_code=0;</span><br> <span>&nbsp;&nbsp;&nbsp;...</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(ret_code);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Область действия (или <a href="/ru/basis/variables/variable_scope">область&nbsp;видимости</a>) переменной – это часть программы, в которой на переменную можно сослаться. Переменные, объявленные внутри блока (на внутреннем уровне), имеют областью действия <a href="/ru/basis/operators/compound">блок</a>. Область действия блок начинается объявлением переменной и заканчивается конечной правой фигурной скобкой. </span></p> 
<p><span>Локальные &nbsp;переменные, объявленные в начале функции, имеют область действия блок так же, как и <a href="/ru/basis/function/call#argument">параметры&nbsp;функции</a>, являющиеся локальными переменными. Любой блок может содержать объявления переменных. Если блоки вложены и <a href="/ru/basis/syntax/identifiers">идентификатор</a> во внешнем блоке имеет такое же имя, как идентификатор во внутреннем блоке, идентификатор внешнего блока "невидим" (скрыт) до момента завершения работы внутреннего блока.</span></p> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;i=5;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;локальная&nbsp;переменная&nbsp;функции</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;i=10;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;переменная&nbsp;функции&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"В&nbsp;блоке&nbsp;i&nbsp;=&nbsp;"</span><span>,i);&nbsp;</span><span style="color: #808080;">//&nbsp;результат&nbsp;&nbsp;i&nbsp;=&nbsp;10;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Вне&nbsp;блока&nbsp;i&nbsp;=&nbsp;"</span><span>,i);&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;результат&nbsp;&nbsp;i&nbsp;=&nbsp;5;</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Это означает, что пока выполняется внутренний блок, он видит значения своих собственных локальных идентификаторов, а не значения идентификаторов с идентичными именами в охватывающем блоке. </span></p> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;i=5;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;локальная&nbsp;переменная&nbsp;функции</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;3;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Внутри&nbsp;for&nbsp;i&nbsp;=&nbsp;"</span><span>,i);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Вне&nbsp;блока&nbsp;i&nbsp;=&nbsp;"</span><span>,i);</span><br> <span>&nbsp;&nbsp;}</span><br> <span>/*&nbsp;Результат&nbsp;выполнения</span><br> <span>Внутри&nbsp;</span><span style="color: #0000ff;">for</span><span>&nbsp;i&nbsp;=&nbsp;0</span><br> <span>Внутри&nbsp;</span><span style="color: #0000ff;">for</span><span>&nbsp;i&nbsp;=&nbsp;1</span><br> <span>Внутри&nbsp;</span><span style="color: #0000ff;">for</span><span>&nbsp;i&nbsp;=&nbsp;2</span><br> <span>Вне&nbsp;блока&nbsp;i&nbsp;=&nbsp;5</span><br> <span>*/</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Локальные переменные, объявленные как <a href="/ru/basis/variables/static">static</a>, имеют областью действия блок, несмотря на то, что они существуют с самого начала выполнения программы.</span></p> 
<h2><a id="stack"></a>Стек</h2> 
<p><span>В каждой MQL4-программе под хранение локальных автоматически создаваемых переменных функций выделяется специальная область памяти, называемая стеком. Стек выделяется один на все функции и по умолчанию размер стека составляет 256 kb, размером стека можно управлять директивой компилятора <a href="/ru/basis/preprosessor/compilation">#property stacksize</a>.</span></p> 
<p><span><a href="/ru/basis/variables/static">Статические</a> локальные переменные размещаются там же, где и другие статические и <a href="/ru/basis/variables/global">глобальные</a> переменные, в специальной области памяти, существующей отдельно от стека. <a href="/ru/basis/variables/object_live">Динамически</a> создаваемые переменные также используют отдельную от стека область памяти.</span></p> 
<p><span>При каждом вызове функции для внутренних нестатических переменных отводится место на стеке. При выходе из функции память становится доступной для повторного использования.</span></p> 
<p><span>Если из первой функции производится вызов второй функции, то та в свою очередь занимает на стеке необходимый объем под свои переменные из оставшейся стековой памяти. Таким образом при вложенных вызовах функций на стеке будет заниматься память последовательно под каждую функцию. Это может привести к нехватке памяти при очередном вызове функции, такая ситуация называется переполнением стека.</span></p> 
<p><span>Поэтому для больших локальных данных лучше использовать динамическую память - при входе в функцию память под локальные нужды выделять в системе (<a href="/ru/basis/operators/newoperator">new</a>, <a href="/ru/array/arrayresize">ArrayResize()</a>), а при выходе из функции производить освобождение памяти (<a href="/ru/basis/operators/deleteoperator">delete</a>, <a href="/ru/array/arrayfree">ArrayFree()</a>).</span></p> 
<p><span>Смотри также</span></p> 
<p><span><a href="/ru/basis/types">Типы данных</a>, <a href="/ru/basis/oop/incapsulation">Инкапсуляция и расширяемость типов</a>, <a href="/ru/basis/variables/initialization">Инициализация переменных</a>, <a href="/ru/basis/variables/variable_scope">Область видимости и время жизни переменных</a>, <a href="/ru/basis/variables/object_live">Создание и уничтожение объектов</a></span></p> 
<br>