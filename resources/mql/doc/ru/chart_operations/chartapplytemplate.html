<h1>ChartApplyTemplate</h1> 
<p><span>Применяет к графику указанный шаблон. Отданная команда поступает в очередь сообщений графика и выполняется только после обработки всех предыдущих команд.</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span>bool&nbsp;&nbsp;</span><span>ChartApplyTemplate</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>long</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>chart_id</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;идентификатор&nbsp;графика</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string</span><span>&nbsp;&nbsp;</span><span>filename</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;имя&nbsp;файла&nbsp;с&nbsp;шаблоном</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Параметры</span></p> 
<p><span>chart_id</span></p> 
<p><span>[in] &nbsp;Идентификатор графика. 0 означает текущий график.</span></p> 
<p><span>filename</span></p> 
<p><span>[in] &nbsp;Имя файла, содержащего шаблон.</span></p> 
<p><span>Возвращаемое значение</span></p> 
<p><span>Возвращает true в случае удачного помещения команды в очередь графика, иначе false. Чтобы получить информацию об <a href="/constants/errorswarnings/errorcodes">ошибке</a>, необходимо вызвать функцию <a href="/check/getlasterror">GetLastError()</a>.</span></p>
<p><span>Примечание</span></p> 
<p><span>Если посредством этой функции из эксперта будет загружен новый шаблон на график, к которому он присоединен, то эксперт будет выгружен и не сможет продолжить работу.</span></p> 
<h3>Права на торговлю и использование DLL</h3> 
<p><span>Для MQL4 программы, запускаемой на графике, пользователь может при запуске разрешить или запретить:</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 20px; margin: 1px 17px 1px 30px;"><span style="font-size:10pt; font-family: 'Trebuchet MS';color:#565656;display:inline-block;width:20px;margin-left:-20px">1.</span><span>Совершение торговых операций,</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 20px; margin: 1px 17px 1px 30px;"><span style="font-size:10pt; font-family: 'Trebuchet MS';color:#565656;display:inline-block;width:20px;margin-left:-20px">2.</span><span>Вызовы функций из DLL.</span></p> 
<p style="text-align: center;"><img alt="Настройки советника" title="Настройки советника" width="629" height="318" style="margin:0px auto 0px auto;width:629px;height:318px;border:none" src="https://c.mql4.com/i/docs/ru/ea_common_settings_ru.png"></p> 
<p><span>Терминал позволяет сохранять настроенный график в виде <a href="http://www.metatrader5.com/ru/terminal/help/charts/templates_profiles" target="_blank" title="Шаблоны и профили">шаблона</a> со всеми запущенными на нем индикаторами и советниками, это позволяет быстро применять настройки шаблона к любым другим графикам. </span></p> 
<p><span>При сохранении шаблона запоминаются и права для запущенных на графике программ: право на торговлю и право на использование DLL. В целях безопасности эти права при применении шаблона к графику могут ограничиваться:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="font-weight: bold;">Права на торговлю и использование DLL не могут быть повышены при запуске советника путем применения шаблона с помощью функции ChartApplyTemplate().</span></p> </td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Если у mql4-программы, которая вызывает функцию ChartApplyTemplate(), отсутствуют права на торговлю, то эксперт, загруженный при помощи шаблона, также не будет иметь прав на торговлю вне зависимости от настроек шаблона.</span></p> 
<p><span>Если у mql4-программы, которая вызывает функцию ChartApplyTemplate(), есть права на торговлю, а в настройках шаблона права отсутствуют, то советник, загруженный при помощи шаблона, не будет иметь прав на торговлю.</span></p> 
<h3>Использование шаблонов</h3> 
<p><span>Средствами языка MQL4 можно задавать множество свойств графика, в том числе устанавливать цвета с помощью функции <a href="/chart_operations/chartsetinteger">ChartSetInteger()</a>:</span></p>
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет фона графика;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет осей, шкалы и строки OHLC;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет сетки;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет объемов и уровней открытия ордеров;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет бара вверх, тени и окантовки тела бычьей свечи;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет бара вниз, тени и окантовки тела медвежьей свечи;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет линии графика и японских свечей "Доджи";</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет тела бычьей свечи;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет тела медвежьей свечи;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет линии Bid-цены;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет линии Ask-цены;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет линии цены последней совершенной сделки (Last);</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>Цвет уровней стоп-ордеров (Stop Loss и Take Profit).</span></p> 
<p><span>Кроме того, на графике может быть множество <a href="/objects">графических объектов</a> и <a href="/indicators">индикаторов</a>. Достаточно один раз настроить внешний вид графика со всеми необходимыми индикаторами и сохранить его в виде шаблона, чтобы в последствии можно было применять этот шаблон к любому графику. </span></p>
<p><span>Функция <a href="/chart_operations/chartapplytemplate">ChartApplyTemplate()</a> предназначена для использования ранее сохраненного шаблона и может использоваться в любой mql4-программе. Вторым параметром функции ChartApplyTemplate() передается путь к имени файла, в котором находится шаблон. Поиск файла шаблона осуществляется по следующим правилам:</span></p>
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>если в начале пути стоит разделитель обратная косая черта "\" (пишется "\\"), то шаблон ищется относительно пути каталог_данных_терминала\MQL4,</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>если обратной косой черты нет, то шаблон ищется относительно исполняемого EX4-файла, в котором происходит вызов функции ChartApplyTemplate();</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>если шаблон не найден в первых двух вариантах, то поиск ведется в папке каталог_терминала\Profiles\Templates\.</span></p> 
<p><span>Здесь каталог_терминала означает папку, из которой запущен клиентский терминал MetaTrader 4, а каталог_данных_терминала означает папку, в которой хранятся изменяемые файлы и ее расположение может зависеть от типа операционной системы, имени пользователя и настроек безопасности компьютера. В общем случае это разные папки, хотя в некоторых случаях могут и совпадать.</span></p> 
<p><span>Расположение папок каталог_данных_терминала и каталог_терминала можно узнать с помощью функции <a href="/check/terminalinfostring">TerminalInfoString()</a>.</span></p>
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;каталог&nbsp;из&nbsp;которой&nbsp;запущен&nbsp;терминал</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;terminal_path=</span><span style="color: #0000ff;">TerminalInfoString</span><span>(</span><span style="color: #0000ff;">TERMINAL_PATH</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Каталог&nbsp;терминала:"</span><span>,</span><span style="color: #0000ff;">terminal_path</span><span>);</span><br> <span style="color: #808080;">//---&nbsp;каталог&nbsp;данных&nbsp;терминала,&nbsp;в&nbsp;котором&nbsp;находится&nbsp;папка&nbsp;MQL4&nbsp;с&nbsp;советниками&nbsp;и&nbsp;индикаторами</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;terminal_data_path=</span><span style="color: #0000ff;">TerminalInfoString</span><span>(</span><span style="color: #0000ff;">TERMINAL_DATA_PATH</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Каталог&nbsp;данных&nbsp;терминала:"</span><span>,</span><span style="color: #0000ff;">terminal_data_path</span><span>);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Примеры записи:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;шаблон&nbsp;ищем&nbsp;в&nbsp;папке&nbsp;каталог_данных_терминала\MQL4\</span><br> <span style="color: #0000ff;">ChartApplyTemplate</span><span>(0,</span><span style="color: #008080;">"\\first_template.tpl"</span><span>))</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;шаблон&nbsp;ищем&nbsp;в&nbsp;папке&nbsp;каталог_исполняемого_EX4_файла\,&nbsp;затем&nbsp;в&nbsp;папке&nbsp;каталог_данных&nbsp;терминала\Profiles\Templates\</span><br> <span style="color: #0000ff;">ChartApplyTemplate</span><span>(0,</span><span style="color: #008080;">"second_template.tpl"</span><span>))</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;шаблон&nbsp;ищем&nbsp;в&nbsp;папке&nbsp;каталог_исполняемого_EX4_файла\My_templates\,&nbsp;затем&nbsp;в&nbsp;папке&nbsp;каталог_терминала\Profiles\Templates\My_templates\</span><br> <span style="color: #0000ff;">ChartApplyTemplate</span><span>(0,</span><span style="color: #008080;">"My_templates\\third_template.tpl"</span><span>))</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Шаблоны не относятся к ресурсам, их нельзя включать в исполняемый файл EX4.</span></p> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr style="text-align:left;vertical-align:top;"> 
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;пример&nbsp;применения&nbsp;шаблона,&nbsp;расположенного&nbsp;в&nbsp;каталоге&nbsp;\MQL4\Files</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileIsExist</span><span>(</span><span style="color: #008080;">"my_template.tpl"</span><span>))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Шаблон&nbsp;my_template.tpl&nbsp;найден&nbsp;в&nbsp;каталоге&nbsp;\Files'"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;применим&nbsp;найденный&nbsp;шаблон</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">ChartApplyTemplate</span><span>(0,</span><span style="color: #008080;">"\\Files\\my_template.tpl"</span><span>))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Применили&nbsp;успешно&nbsp;шаблон&nbsp;'my_template.tpl'"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Не&nbsp;удалось&nbsp;применить&nbsp;шаблон&nbsp;'my_template.tpl',&nbsp;ошибка&nbsp;"</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Файл&nbsp;'my_template.tpl'&nbsp;не&nbsp;найден&nbsp;в&nbsp;папке&nbsp;"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+</span><span style="color: #0000ff;">TerminalInfoString</span><span>(</span><span style="color: #0000ff;">TERMINAL_PATH</span><span>)+</span><span style="color: #008080;">"\\MQL4\\Files"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Смотри также</span></p> 
<p><span><a href="/runtime/resources">Ресурсы</a></span></p>
<br>