<h1>ArrayResize</h1> 
<p><span>The function sets a new size for the first dimension</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>int&nbsp;&nbsp;</span><span>ArrayResize</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>void&amp;</span><span>&nbsp;&nbsp;</span><span>array[]</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;array&nbsp;passed&nbsp;by&nbsp;reference</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>new_size</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;new&nbsp;array&nbsp;size</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>reserve_size=0</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;reserve&nbsp;size&nbsp;value&nbsp;(excess)</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>Parameters</span></p> 
<p><span>array[]</span></p> 
<p><span>[out] Array for changing sizes.</span></p> 
<p><span>new_size</span></p> 
<p><span>[in] &nbsp;New size for the first dimension.</span></p> 
<p><span>reserve_size=0</span></p> 
<p><span>[in] &nbsp;Optional parameter. Distributed size to get reserve.</span></p> 
<p><span>Return Value</span></p> 
<p><span>If executed successfully, it returns count of all elements contained in the array after resizing, otherwise, returns -1, and array is not resized.</span></p> 
<p><span>Note</span></p> 
<p><span>The function can be applied only to <a href="/basis/types/dynamic_array">dynamic arrays</a>. It should be noted that you cannot change the size of dynamic arrays assigned as indicator buffers by the <a href="/customind/setindexbuffer">SetIndexBuffer()</a> function. For indicator buffers, all operations of resizing are performed by the runtime subsystem of the terminal.</span></p> 
<p><span>Total amount of elements in the array cannot exceed 2147483647.</span></p> 
<p><span>With the frequent memory allocation, it is recommended to use a third parameter that sets a reserve to reduce the number of physical memory allocations. All the subsequent calls of </span><span style="color: #0000ff;">ArrayResize</span><span> do not lead to physical reallocation of memory, but only change the size of the first array dimension within the reserved memory. It should be remembered that the third parameter will be used only during physical memory allocation. For example:</span></p> 
<div style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 8px 17px 4px 30px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">ArrayResize</span><span>(arr,1000,1000);</span><br> <span style="color: #0000ff;">for</span><span>(int&nbsp;i=1;i&lt;3000;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(arr,i,1000);</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>In this case the memory will be reallocated twice, first before entering the 2000-element loop (the array size will be set to 1000), and the second time with i equal to 2000. If we skip the third parameter, there will be 2000 physical reallocations of memory, which will slow down the program.</span></p> 
<p><span style="font-weight: bold;">Example:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;Counters</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ulong</span><span>&nbsp;start=</span><span style="color: #0000ff;">GetTickCount</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ulong</span><span>&nbsp;now;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;count=0;</span><br> <span style="color: #808080;">//---&nbsp;An&nbsp;array&nbsp;for&nbsp;demonstration&nbsp;of&nbsp;a&nbsp;quick&nbsp;version</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;arr[];</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(arr,100000,100000);</span><br> <span style="color: #808080;">//---&nbsp;Check&nbsp;how&nbsp;fast&nbsp;the&nbsp;variant&nbsp;with&nbsp;memory&nbsp;reservation&nbsp;works</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"---&nbsp;Test&nbsp;Fast:&nbsp;ArrayResize(arr,100000,100000)"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=1;i&lt;=300000;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Set&nbsp;a&nbsp;new&nbsp;array&nbsp;size&nbsp;specifying&nbsp;the&nbsp;reserve&nbsp;of&nbsp;100,000&nbsp;elements!</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(arr,i,100000);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;When&nbsp;reaching&nbsp;a&nbsp;round&nbsp;number,&nbsp;show&nbsp;the&nbsp;array&nbsp;size&nbsp;and&nbsp;the&nbsp;time&nbsp;spent</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">ArraySize</span><span>(arr)%100000==0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now=</span><span style="color: #0000ff;">GetTickCount</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count++;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"%d.&nbsp;ArraySize(arr)=%d&nbsp;Time=%d&nbsp;ms"</span><span>,count,</span><span style="color: #0000ff;">ArraySize</span><span>(arr),(now-start));</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start=now;&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;Now&nbsp;show,&nbsp;how&nbsp;slow&nbsp;the&nbsp;version&nbsp;without&nbsp;memory&nbsp;reservation&nbsp;is</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;slow[];</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(slow,100000,100000);</span><br> <span style="color: #808080;">//---&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;count=0;</span><br> <span>&nbsp;&nbsp;&nbsp;start=</span><span style="color: #0000ff;">GetTickCount</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"----&nbsp;Test&nbsp;Slow:&nbsp;ArrayResize(slow,100000)"</span><span>);</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=1;i&lt;=300000;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Set&nbsp;a&nbsp;new&nbsp;array&nbsp;size,&nbsp;but&nbsp;without&nbsp;the&nbsp;additional&nbsp;reserve</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(slow,i);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;When&nbsp;reaching&nbsp;a&nbsp;round&nbsp;number,&nbsp;show&nbsp;the&nbsp;array&nbsp;size&nbsp;and&nbsp;the&nbsp;time&nbsp;spent</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">ArraySize</span><span>(slow)%100000==0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now=</span><span style="color: #0000ff;">GetTickCount</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count++;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"%d.&nbsp;ArraySize(slow)=%d&nbsp;Time=%d&nbsp;ms"</span><span>,count,</span><span style="color: #0000ff;">ArraySize</span><span>(slow),(now-start));</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start=now;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;A&nbsp;sample&nbsp;result&nbsp;of&nbsp;the&nbsp;script</span><br> <span>/*</span><br> <span>&nbsp;&nbsp;&nbsp;Test_ArrayResize&nbsp;(EURUSD,H1)&nbsp;&nbsp;&nbsp;---&nbsp;Test&nbsp;Fast:&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(arr,100000,100000)</span><br> <span>&nbsp;&nbsp;&nbsp;Test_ArrayResize&nbsp;(EURUSD,H1)&nbsp;&nbsp;&nbsp;1.&nbsp;</span><span style="color: #0000ff;">ArraySize</span><span>(arr)=100000&nbsp;Time=0&nbsp;ms</span><br> <span>&nbsp;&nbsp;&nbsp;Test_ArrayResize&nbsp;(EURUSD,H1)&nbsp;&nbsp;&nbsp;2.&nbsp;</span><span style="color: #0000ff;">ArraySize</span><span>(arr)=200000&nbsp;Time=0&nbsp;ms</span><br> <span>&nbsp;&nbsp;&nbsp;Test_ArrayResize&nbsp;(EURUSD,H1)&nbsp;&nbsp;&nbsp;3.&nbsp;</span><span style="color: #0000ff;">ArraySize</span><span>(arr)=300000&nbsp;Time=0&nbsp;ms</span><br> <span>&nbsp;&nbsp;&nbsp;Test_ArrayResize&nbsp;(EURUSD,H1)&nbsp;&nbsp;&nbsp;----&nbsp;Test&nbsp;Slow:&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(slow,100000)</span><br> <span>&nbsp;&nbsp;&nbsp;Test_ArrayResize&nbsp;(EURUSD,H1)&nbsp;&nbsp;&nbsp;1.&nbsp;</span><span style="color: #0000ff;">ArraySize</span><span>(slow)=100000&nbsp;Time=0&nbsp;ms</span><br> <span>&nbsp;&nbsp;&nbsp;Test_ArrayResize&nbsp;(EURUSD,H1)&nbsp;&nbsp;&nbsp;2.&nbsp;</span><span style="color: #0000ff;">ArraySize</span><span>(slow)=200000&nbsp;Time=0&nbsp;ms</span><br> <span>&nbsp;&nbsp;&nbsp;Test_ArrayResize&nbsp;(EURUSD,H1)&nbsp;&nbsp;&nbsp;3.&nbsp;</span><span style="color: #0000ff;">ArraySize</span><span>(slow)=300000&nbsp;Time=228511&nbsp;ms</span><br> <span>*/</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>See also</span></p> 
<p><span><a href="/array/arrayinitialize">ArrayInitialize</a></span></p> 
<br>