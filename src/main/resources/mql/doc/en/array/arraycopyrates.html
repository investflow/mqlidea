<h1>ArrayCopyRates</h1> 
<p><span>Copies rates data to the array and returns the amount of bars copied. There are 2 variants of the function:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>int&nbsp;&nbsp;</span><span>ArrayCopyRates</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>MqlRates&amp;</span><span>&nbsp;&nbsp;</span><span>rates_array[]</span><span>,&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;MqlRates&nbsp;array,&nbsp;passed&nbsp;by&nbsp;reference</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>string&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span>symbol=NULL</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;symbol</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>timeframe=0&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;timeframe</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>Copies rates data to the RateInfo[][6] two-dimensional array of double type and returns the amount of bars copied.</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>int&nbsp;&nbsp;</span><span>ArrayCopyRates</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>void&amp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>dest_array[][]</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;destination&nbsp;array,&nbsp;passed&nbsp;by&nbsp;reference</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>string&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span>symbol=NULL</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;symbol</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>timeframe=0&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;timeframe</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>Parameters</span></p> 
<p><span>rates_array[]</span></p> 
<p><span>[out] &nbsp;Destination array of <a href="/constants/structures/mqlrates">MqlRates</a> type.</span></p> 
<p><span>dest_array[]</span></p> 
<p><span>[out] &nbsp;Two-dimensional destination array of <a href="/basis/types/double">double</a> type.</span></p> 
<p><span>symbol=NULL</span></p> 
<p><span>[in] &nbsp;Symbol name.</span></p> 
<p><span>timeframe=0</span></p> 
<p><span>[in] &nbsp;Timeframe. It can be any of <a href="/constants/chartconstants/enum_timeframes">ENUM_TIMEFRAMES</a> enumeration values. 0 means the current chart timeframe.</span></p> 
<p><span>Returned value</span></p> 
<p><span>The function returns copied bars amount, or -1 if failed. </span></p> 
<p><span>If data (symbol name and/or timeframe differ from the current ones) are requested from another chart, the situation is possible that the corresponding chart was not opened in the client terminal and the necessary data must be requested from the server. In this case, error ERR_HISTORY_WILL_UPDATED (4066 - the requested history data are under updating) will be placed in the last_error variable, and one will has to re-request (see example of <a href="/array/arraycopyseries">ArrayCopySeries()</a>).</span></p> 
<p><span>Note</span></p> 
<p><span>This rates array is normally used to pass data to a DLL function.</span></p> 
<p><span>In the first variant of the function it performs the virtual data copying to the array of </span><span><a href="/constants/structures/mqlrates">MqlRates</a> type. It means that if timeseries data has been updated, </span><span>rates_array[] array always will refer to the actual data.</span></p> 
<p><span>In the second variant it performs the real data copying to dest_array[][] array. The d</span><span>estination array will be resized to the size of the timeseries (even if the destination array has been declared as static).</span></p> 
<p><span>First dimension of RateInfo array contains bars amount, second dimension has 6 elements:</span></p> 
<p><span>0 - time,</span><br> <span>1 - open,</span><br> <span>2 - low,</span><br> <span>3 - high,</span><br> <span>4 - close,</span><br> <span>5 - volume.</span></p> 
<p><span style="font-weight: bold;">Example:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">copyright</span><span>&nbsp;</span><span style="color: #008080;">"Copyright&nbsp;Â©&nbsp;2013,&nbsp;MetaQuotes&nbsp;Software&nbsp;Corp."</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">link</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"https://www.mql5.com"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">version</span><span>&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"1.00"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">strict</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"Expert&nbsp;Advisor&nbsp;displaying&nbsp;two&nbsp;cases&nbsp;of"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"ArrayCopyRates()&nbsp;function&nbsp;call"</span><br> <span style="color: #808080;">//---&nbsp;destination&nbsp;array&nbsp;for&nbsp;physical&nbsp;copying&nbsp;of&nbsp;historical&nbsp;data</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;double_array[][6];</span><br> <span style="color: #808080;">//---&nbsp;destination&nbsp;array&nbsp;for&nbsp;logical&nbsp;copying&nbsp;of&nbsp;historical&nbsp;data</span><br> <span style="color: #0000ff;">MqlRates</span><span>&nbsp;mqlrates_array[];</span><br> <span style="color: #808080;">//---&nbsp;first&nbsp;call&nbsp;flag</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;first_call;</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Expert&nbsp;initialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;</span><span style="color: #0000ff;">OnInit</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;run&nbsp;this&nbsp;EA&nbsp;at&nbsp;chart&nbsp;with&nbsp;M1&nbsp;timeframe</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">Period</span><span>()!=</span><span style="color: #0000ff;">PeriodSeconds</span><span>(</span><span style="color: #0000ff;">PERIOD_M1</span><span>)/60)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Alert</span><span>(</span><span style="color: #008080;">"The&nbsp;Expert&nbsp;Advisor&nbsp;must&nbsp;be&nbsp;attached&nbsp;to&nbsp;M1&nbsp;chart!"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">INIT_FAILED</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;first&nbsp;call</span><br> <span>&nbsp;&nbsp;&nbsp;first_call=</span><span style="color: #0000ff;">true</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;all&nbsp;ok</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">INIT_SUCCEEDED</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Expert&nbsp;deinitialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnDeinit</span><span>(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;reason)</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;delete&nbsp;all&nbsp;comments</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Comment</span><span>(</span><span style="color: #008080;">""</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Expert&nbsp;tick&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnTick</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(first_call)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;copying&nbsp;physically&nbsp;&nbsp;double_array</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayCopyRates</span><span>(double_array,</span><span style="color: #0000ff;">NULL</span><span>,0);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;virtual&nbsp;copying&nbsp;-&gt;&nbsp;mqlrates_array&nbsp;will&nbsp;contain&nbsp;the&nbsp;reference&nbsp;on&nbsp;the&nbsp;data</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayCopyRates</span><span>(mqlrates_array,</span><span style="color: #0000ff;">NULL</span><span>,0);&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;cancel&nbsp;first&nbsp;call&nbsp;flag</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_call=</span><span style="color: #0000ff;">false</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;at&nbsp;each&nbsp;tick&nbsp;print&nbsp;the&nbsp;values&nbsp;of&nbsp;the&nbsp;0-th&nbsp;array&nbsp;element&nbsp;to&nbsp;see&nbsp;the&nbsp;difference</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Comment</span><span>(</span><span style="color: #008080;">"The&nbsp;values&nbsp;of&nbsp;double_array[]&nbsp;are&nbsp;not&nbsp;changed&nbsp;(because&nbsp;of&nbsp;real&nbsp;data&nbsp;copying):\n"</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"0&nbsp;-&nbsp;time:&nbsp;"</span><span>,(</span><span style="color: #0000ff;">datetime</span><span>)double_array[0][0],</span><span style="color: #008080;">"\n"</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"1&nbsp;-&nbsp;open:&nbsp;"</span><span>,double_array[0][1],</span><span style="color: #008080;">"\n"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"2&nbsp;-&nbsp;low:&nbsp;"</span><span>,double_array[0][2],</span><span style="color: #008080;">"\n"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"3&nbsp;-&nbsp;high:&nbsp;"</span><span>,double_array[0][3],</span><span style="color: #008080;">"\n"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"4&nbsp;-&nbsp;close:&nbsp;"</span><span>,double_array[0][4],</span><span style="color: #008080;">"\n"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"5&nbsp;-&nbsp;volume:&nbsp;"</span><span>,</span><span style="color: #0000ff;">DoubleToString</span><span>(double_array[0][5],0),</span><span style="color: #008080;">"\n\n"</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"The&nbsp;values&nbsp;of&nbsp;mqlrates_array[]&nbsp;are&nbsp;changed&nbsp;(because&nbsp;of&nbsp;virtual&nbsp;data&nbsp;copying):\n"</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"0&nbsp;-&nbsp;time:&nbsp;"</span><span>,mqlrates_array[0].</span><span style="color: #0000ff;">time</span><span>,</span><span style="color: #008080;">"\n"</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"1&nbsp;-&nbsp;open:&nbsp;"</span><span>,mqlrates_array[0].</span><span style="color: #0000ff;">open</span><span>,</span><span style="color: #008080;">"\n"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"2&nbsp;-&nbsp;low:&nbsp;"</span><span>,mqlrates_array[0].</span><span style="color: #0000ff;">low</span><span>,</span><span style="color: #008080;">"\n"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"3&nbsp;-&nbsp;high:&nbsp;"</span><span>,mqlrates_array[0].</span><span style="color: #0000ff;">high</span><span>,</span><span style="color: #008080;">"\n"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"4&nbsp;-&nbsp;close:&nbsp;"</span><span>,mqlrates_array[0].</span><span style="color: #0000ff;">close</span><span>,</span><span style="color: #008080;">"\n"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"5&nbsp;-&nbsp;volume:&nbsp;"</span><span>,mqlrates_array[0].</span><span style="color: #0000ff;">tick_volume</span><span>);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><img alt="ArrayCopyRates" width="610" height="440" style="margin:0px auto 0px auto;width:610px;height:440px;border:none" src="https://c.mql4.com/i/docs/en/arraycopyrates.png"></p> 
<br>