<h1>FolderClean</h1> 
<p><span>The function deletes all files in a specified folder.</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>bool&nbsp;&nbsp;</span><span>FolderClean</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>string</span><span>&nbsp;&nbsp;</span><span>folder_name</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;String&nbsp;with&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;deleted&nbsp;folder</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>common_flag=0</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;Scope</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>Parameters</span></p> 
<p><span>folder_name</span></p> 
<p><span>[in] The name of the directory where you want to delete all files. Contains the full path to the folder.</span></p> 
<p><span>common_flag=0</span></p> 
<p><span>[in] <a href="/constants/io_constants/fileflags">Flag</a> determining the location of the directory. If common_flag = FILE_COMMON, then the directory is in the shared folder for all client terminals \Terminal\Common\Files. Otherwise, the directory is in a local folder(MQL4\files or MQL4\tester\files in case of testing).</span></p> 
<p><span>Return Value</span></p> 
<p><span>Returns true if successful, otherwise false.</span></p> 
<p><span>Note</span></p> 
<p><span>For security reasons, work with files is strictly controlled in the MQL4 language. Files with which file operations are conducted using MQL4 means, cannot be outside the file sandbox.</span></p> 
<p><span>This function should be used with caution, since all the files and all subdirectories are deleted irretrievably.</span></p> 
<p><span style="font-weight: bold;">Example:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Demo_FolderClean.mq5&nbsp;|</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright&nbsp;2011,&nbsp;MetaQuotes&nbsp;Software&nbsp;Corp.&nbsp;|</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://www.mql5.com&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">copyright</span><span>&nbsp;</span><span style="color: #008080;">"Copyright&nbsp;2011,&nbsp;MetaQuotes&nbsp;Software&nbsp;Corp."</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">link</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"https://www.mql5.com"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">version</span><span>&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"1.00"</span><br> <span style="color: #808080;">//---&nbsp;Description</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"The&nbsp;script&nbsp;shows&nbsp;a&nbsp;sample&nbsp;use&nbsp;of&nbsp;FolderClean()."</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"First,&nbsp;files&nbsp;are&nbsp;created&nbsp;in&nbsp;the&nbsp;specified&nbsp;folder&nbsp;using&nbsp;the&nbsp;FileOpen()&nbsp;function."</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"Then,&nbsp;before&nbsp;the&nbsp;files&nbsp;are&nbsp;deleted,&nbsp;a&nbsp;warning&nbsp;is&nbsp;shown&nbsp;using&nbsp;MessageBox()."</span><br> <span style="color: #008080;">&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;Show&nbsp;the&nbsp;dialog&nbsp;of&nbsp;input&nbsp;parameters&nbsp;when&nbsp;starting&nbsp;the&nbsp;script</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">script_show_inputs</span><br> <span style="color: #808080;">//---&nbsp;Input&nbsp;parameters</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;</span><span style="color: #800000;">foldername</span><span>=</span><span style="color: #008080;">"demo_folder"</span><span>;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Create&nbsp;a&nbsp;folder&nbsp;in&nbsp;MQL4/Files/</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files=5;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;The&nbsp;number&nbsp;of&nbsp;files&nbsp;to&nbsp;create&nbsp;and&nbsp;delete</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;name=</span><span style="color: #008080;">"testfile"</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;First&nbsp;open&nbsp;or&nbsp;create&nbsp;files&nbsp;in&nbsp;the&nbsp;terminal&nbsp;data&nbsp;folder</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;N=0;N&lt;files;N++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;in&nbsp;the&nbsp;foem&nbsp;of&nbsp;'demo_folder\testfileN.txt'</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;filemane=</span><span style="color: #0000ff;">StringFormat</span><span>(</span><span style="color: #008080;">"%s\\%s%d.txt"</span><span>,</span><span style="color: #800000;">foldername</span><span>,name,N);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Open&nbsp;a&nbsp;file&nbsp;with&nbsp;the&nbsp;flag&nbsp;for&nbsp;writing,&nbsp;in&nbsp;this&nbsp;case&nbsp;the&nbsp;'demo_folder'&nbsp;will&nbsp;be&nbsp;created&nbsp;automatically</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;handle=</span><span style="color: #0000ff;">FileOpen</span><span>(filemane,</span><span style="color: #0000ff;">FILE_WRITE</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Find&nbsp;out&nbsp;if&nbsp;the&nbsp;FileOpen()&nbsp;function&nbsp;was&nbsp;successful</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(handle==</span><span style="color: #0000ff;">INVALID_HANDLE</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Failed&nbsp;to&nbsp;create&nbsp;file&nbsp;%s.&nbsp;Error&nbsp;code"</span><span>,filemane,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"File&nbsp;%s&nbsp;has&nbsp;been&nbsp;successfully&nbsp;opened"</span><span>,filemane);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;The&nbsp;opened&nbsp;file&nbsp;is&nbsp;not&nbsp;needed&nbsp;any&nbsp;more,&nbsp;so&nbsp;close&nbsp;it</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">FileClose</span><span>(handle);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;Check&nbsp;the&nbsp;number&nbsp;of&nbsp;files&nbsp;in&nbsp;the&nbsp;folder&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;k=FilesInFolder(</span><span style="color: #800000;">foldername</span><span>+</span><span style="color: #008080;">"\\*.*"</span><span>,0);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Totally&nbsp;the&nbsp;folder&nbsp;%s&nbsp;contains&nbsp;%d&nbsp;files"</span><span>,</span><span style="color: #800000;">foldername</span><span>,k);</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;Show&nbsp;a&nbsp;dialog&nbsp;to&nbsp;ask&nbsp;the&nbsp;user</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;choice=</span><span style="color: #0000ff;">MessageBox</span><span>(</span><span style="color: #0000ff;">StringFormat</span><span>(</span><span style="color: #008080;">"You&nbsp;are&nbsp;going&nbsp;to&nbsp;delete&nbsp;%d&nbsp;files&nbsp;from&nbsp;folder&nbsp;%s.&nbsp;Do&nbsp;you&nbsp;want&nbsp;to&nbsp;continue?"</span><span>,</span><span style="color: #800000;">foldername</span><span>,k),</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"Deleting&nbsp;files&nbsp;from&nbsp;the&nbsp;folder"</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">MB_YESNO</span><span>|</span><span style="color: #0000ff;">MB_ICONQUESTION</span><span>);&nbsp;</span><span style="color: #808080;">//&nbsp;&nbsp;Two&nbsp;buttons&nbsp;-&nbsp;"Yes"&nbsp;and&nbsp;"No"</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;Run&nbsp;an&nbsp;action&nbsp;depending&nbsp;on&nbsp;the&nbsp;selected&nbsp;variant</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(choice==</span><span style="color: #0000ff;">IDYES</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Start&nbsp;to&nbsp;delete&nbsp;files</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Trying&nbsp;to&nbsp;delete&nbsp;all&nbsp;files&nbsp;from&nbsp;folder&nbsp;%s"</span><span>,</span><span style="color: #800000;">foldername</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FolderClean</span><span>(</span><span style="color: #800000;">foldername</span><span>,0))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Files&nbsp;have&nbsp;been&nbsp;successfully&nbsp;deleted,&nbsp;%d&nbsp;files&nbsp;left&nbsp;in&nbsp;folder&nbsp;%s"</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800000;">foldername</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FilesInFolder(</span><span style="color: #800000;">foldername</span><span>+</span><span style="color: #008080;">"\\*.*"</span><span>,0));</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Failed&nbsp;to&nbsp;delete&nbsp;files&nbsp;from&nbsp;folder&nbsp;%s.&nbsp;Error&nbsp;code&nbsp;%d"</span><span>,</span><span style="color: #800000;">foldername</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Deletion&nbsp;canceled"</span><span>);</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Returns&nbsp;the&nbsp;number&nbsp;of&nbsp;files&nbsp;in&nbsp;the&nbsp;specified&nbsp;folder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;FilesInFolder(</span><span style="color: #0000ff;">string</span><span>&nbsp;path,</span><span style="color: #0000ff;">int</span><span>&nbsp;flag)</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;count=0;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;handle;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;filename;</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;handle=</span><span style="color: #0000ff;">FileFindFirst</span><span>(path,filename,flag);</span><br> <span style="color: #808080;">//---&nbsp;If&nbsp;at&nbsp;least&nbsp;one&nbsp;file&nbsp;found,&nbsp;search&nbsp;for&nbsp;more&nbsp;files</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(handle!=</span><span style="color: #0000ff;">INVALID_HANDLE</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Show&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"File&nbsp;%s&nbsp;found"</span><span>,filename);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Increase&nbsp;the&nbsp;counter&nbsp;of&nbsp;found&nbsp;files/folders</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count++;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Start&nbsp;search&nbsp;in&nbsp;all&nbsp;files/folders&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">while</span><span>(</span><span style="color: #0000ff;">FileFindNext</span><span>(handle,filename))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"File&nbsp;%s&nbsp;found"</span><span>,filename);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count++;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;Do&nbsp;not&nbsp;forget&nbsp;to&nbsp;close&nbsp;the&nbsp;search&nbsp;handle&nbsp;upon&nbsp;completion</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">FileFindClose</span><span>(handle);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><span>&nbsp;</span><span style="color: #808080;">//&nbsp;Failed&nbsp;to&nbsp;get&nbsp;the&nbsp;handle</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Files&nbsp;search&nbsp;in&nbsp;folder&nbsp;%s&nbsp;failed"</span><span>,path);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;Return&nbsp;the&nbsp;result</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>&nbsp;count;</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>See also</span></p> 
<p><span><a href="/files/filefindfirst">FileFindFirst()</a>, <a href="/files/filefindnext">FileFindNext()</a>, <a href="/files/filefindclose">FileFindClose()</a></span></p> 
<br>