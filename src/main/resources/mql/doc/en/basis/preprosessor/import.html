<h1>Importing Function (#import)</h1> 
<p><span>Functions are imported from compiled MQL4 modules (*.ex4 files) and from operating system modules (*.dll files). The module name is specified in the </span><span style="font-style: italic;">#import</span><span> directive. For compiler to be able to correctly form the imported function call and organize proper <a href="/basis/function/parameterpass">transmission parameters</a>, the full description of <a href="/basis/function">functions</a> is needed. Function descriptions immediately follow the </span><span style="font-style: italic;">#import "module name"</span><span> directive. New command </span><span style="font-style: italic;">#import</span><span> (can be without parameters) completes the block of imported function descriptions.</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#import</span><span>&nbsp;</span><span style="color: #008080;">"file_name"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;func1&nbsp;define;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;func2&nbsp;define;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;...</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;funcN&nbsp;define;</span><br> <span style="color: #0000ff;">#import</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>Imported functions can have any names. Functions having the same names but from different modules can be imported at the same time. Imported functions can have names that coincide with the names of built-in functions. Operation of <a href="/basis/operations/other#context_allow">scope resolution</a> defines which of the functions should be called.</span></p> 
<p><span>The order of searching for a file specified after the </span><span style="color: #0000ff;">#import</span><span> keyword is described in <a href="/runtime/imports">Call of Imported Functions</a>.</span></p> 
<p><span>Since the imported functions are outside the compiled module, the compiler can not verify the validity of passed parameters. Therefore, to avoid run-time errors, one must accurately describe the composition and order of parameters passed to imported functions. Parameters passed to imported functions (both from EX4, and from the DLL-module) can have default values.</span></p> 
<p><span>The following can't be used for parameters in imported functions:</span></p> 
<ul style="text-indent:0px; padding-left:0; margin-top:0; margin-bottom:0; margin-left: 30px;list-style-position:outside; list-style-type:disc"> 
 <li style="text-align: justify; padding: 0px 0px 0px 0px; margin-top: 3px; margin-right: 17px; margin-bottom: 3px;"><span><a href="/basis/types/object_pointers">pointers</a> (*);</span></li> 
 <li style="text-align: justify; padding: 0px 0px 0px 0px; margin-top: 3px; margin-right: 17px; margin-bottom: 3px;"><span>links to objects that contain <a href="/basis/types/dynamic_array">dynamic arrays</a> and/or pointers.</span></li> 
</ul> 
<p><span>Classes, string arrays or complex objects that contain strings and/or dynamic arrays of any types cannot be passed as a parameter to functions imported from DLL.</span></p> 
<p><span style="font-weight: bold;">Examples:</span></p> 
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody>
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#import</span><span>&nbsp;</span><span style="color: #008080;">"user32.dll"</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxW(</span><span style="color: #0000ff;">uint</span><span>&nbsp;hWnd,</span><span style="color: #0000ff;">string</span><span>&nbsp;lpText,</span><span style="color: #0000ff;">string</span><span>&nbsp;lpCaption,</span><span style="color: #0000ff;">uint</span><span>&nbsp;uType);</span><br> <span style="color: #0000ff;">#import</span><span>&nbsp;</span><span style="color: #008080;">"stdlib.ex4"</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;ErrorDescription(</span><span style="color: #0000ff;">int</span><span>&nbsp;error_code);</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;RGB(</span><span style="color: #0000ff;">int</span><span>&nbsp;red_value,</span><span style="color: #0000ff;">int</span><span>&nbsp;green_value,</span><span style="color: #0000ff;">int</span><span>&nbsp;blue_value);</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;CompareDoubles(</span><span style="color: #0000ff;">double</span><span>&nbsp;number1,</span><span style="color: #0000ff;">double</span><span>&nbsp;number2);</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;DoubleToStrMorePrecision(</span><span style="color: #0000ff;">double</span><span>&nbsp;number,</span><span style="color: #0000ff;">int</span><span>&nbsp;precision);</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;IntegerToHexString(</span><span style="color: #0000ff;">int</span><span>&nbsp;integer_number);</span><br> <span style="color: #0000ff;">#import</span><span>&nbsp;</span><span style="color: #008080;">"ExpertSample.dll"</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;GetIntValue(</span><span style="color: #0000ff;">int</span><span>);</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;GetDoubleValue(</span><span style="color: #0000ff;">double</span><span>);</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;GetStringValue(</span><span style="color: #0000ff;">string</span><span>);</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;GetArrayItemValue(</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;arr[],</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">int</span><span>);</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;SetArrayItemValue(</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;arr[],</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">double</span><span>);</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;GetRatesItemValue(</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;rates[][6],</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">int</span><span>);</span><br> <span style="color: #0000ff;">#import</span></p></td> 
   </tr> 
  </tbody>
 </table> 
</div> 
<p><span>To import functions during execution of a mql4 program, early binding is used. This means that the library is loaded during the loading of a program using its ex4 program.</span></p> 
<p><span>It's not recommended to use a fully qualified name of the loadable module of type </span><span style="font-style: italic;">Drive:\Directory\FileName.Ext</span><span>. MQL4 libraries are loaded from the </span><span style="font-style: italic;">terminal_dir\MQL4\Libraries</span><span> folder.</span></p> 
<p><span>See also</span></p> 
<p><span><a href="/basis/preprosessor/include">Including Files</a></span></p> 
<br>