<h1>MathSrand</h1> 
<p><span>Устанавливает начальное состояние для генерации ряда псевдослучайных целых чисел.</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>void&nbsp;&nbsp;</span><span>MathSrand</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;</span><span>seed</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;инициализирующее&nbsp;число</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Параметры</span></p> 
<p><span>seed</span></p> 
<p><span>[in] &nbsp;Начальное число для ряда случайных чисел.</span></p> 
<p><span>Возвращаемое значение</span></p> 
<p><span>Нет возвращаемого значения.</span></p> 
<p><span>Примечание</span></p> 
<p><span>Функция <a href="/math/mathrand">MathRand()</a> предназначена для генерации последовательности псевдослучайных чисел. Вызов MathSrand() с определенным инициализирующим числом позволяет получать всегда одну и ту же последовательность псевдослучайных чисел. </span></p>
<p><span>Для гарантированного получения неповторяющейся последовательности используйте вызов MathSrand(GetTickCount()), так как значение <a href="/common/gettickcount">GetTickCount()</a> увеличивается с момента запуска операционной системы и не повторяется в течение 49 дней, пока не переполнится встроенный счетчик миллисекунд. Использование MathSrand(TimeCurrent()) не подходит по той причине, что функция <a href="/dateandtime/timecurrent">TimeCurrent()</a> возвращает время прихода последнего тика, которое может не меняться долгое время, например, в выходные дни.</span></p>
<p><span>Инициализацию генератора псевдослучайных чисел с помощью MathSrand() для индикаторов и экспертов лучше всего делать в обработчике OnInit(), это избавит от последующих многократных перезапусков генератора в OnTick() и OnCalculate(). </span></p> 
<p><span>Вместо функции MathSrand() можно использовать функцию </span><span style="color: #0000ff;">srand</span><span>().</span></p> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"Индикатор&nbsp;демонстрирует&nbsp;центральную&nbsp;предельную&nbsp;&nbsp;теорему,&nbsp;которая&nbsp;гласит:"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"Сумма&nbsp;достаточно&nbsp;большого&nbsp;количества&nbsp;слабо&nbsp;зависимых&nbsp;случайных&nbsp;величин,&nbsp;"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"имеющих&nbsp;примерно&nbsp;одинаковые&nbsp;масштабы&nbsp;(ни&nbsp;одно&nbsp;из&nbsp;слагаемых&nbsp;не&nbsp;доминирует,"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"не&nbsp;вносит&nbsp;в&nbsp;сумму&nbsp;определяющего&nbsp;вклада),&nbsp;имеет&nbsp;распределение,&nbsp;близкое&nbsp;к&nbsp;нормальному."</span><br> <span style="color: #008080;">&nbsp;</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">indicator_separate_window</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">indicator_buffers</span><span>&nbsp;1</span><br> <span style="color: #999999;">//---&nbsp;свойства&nbsp;графического&nbsp;построения</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">indicator_label1</span><span>&nbsp;&nbsp;</span><span style="color: #008080;">"Label"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">indicator_type1</span><span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">DRAW_HISTOGRAM</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">indicator_color1</span><span>&nbsp;&nbsp;</span><span style="color: #0000ff;">clrRoyalBlue</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">indicator_style1</span><span>&nbsp;&nbsp;</span><span style="color: #0000ff;">STYLE_SOLID</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">indicator_width1</span><span>&nbsp;&nbsp;5</span><br> <span style="color: #999999;">//---&nbsp;input&nbsp;переменная</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c0504d;">sample_number</span><span>=10;</span><br> <span style="color: #999999;">//---&nbsp;индикаторный&nbsp;буфер&nbsp;для&nbsp;отрисовки&nbsp;распределения</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LabelBuffer[];</span><br> <span style="color: #999999;">//---&nbsp;счетчик&nbsp;тиков</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ticks_counter;</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Custom&nbsp;indicator&nbsp;initialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnInit</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;связывание&nbsp;массива&nbsp;и&nbsp;индикаторного&nbsp;буфера</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">SetIndexBuffer</span><span>(0,LabelBuffer,</span><span style="color: #0000ff;">INDICATOR_DATA</span><span>);</span><br> <span style="color: #999999;">//---&nbsp;развернем&nbsp;индикаторный&nbsp;буфер&nbsp;из&nbsp;настоящего&nbsp;в&nbsp;прошлое</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArraySetAsSeries</span><span>(LabelBuffer,</span><span style="color: #0000ff;">true</span><span>);</span><br> <span style="color: #999999;">//---&nbsp;инициализируем&nbsp;генератор&nbsp;случайных&nbsp;чисел</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">MathSrand</span><span>(</span><span style="color: #0000ff;">GetTickCount</span><span>());</span><br> <span style="color: #999999;">//---&nbsp;инициализируем&nbsp;счетчик&nbsp;тиков</span><br> <span>&nbsp;&nbsp;&nbsp;ticks_counter=0;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Custom&nbsp;indicator&nbsp;iteration&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;</span><span style="color: #0000ff;">OnCalculate</span><span>(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;rates_total,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;prev_calculated,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;datetime&nbsp;&amp;time[],</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;open[],</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;high[],</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;low[],</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;close[],</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;&amp;tick_volume[],</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;&amp;volume[],</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&amp;spread[])</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;при&nbsp;нулевом&nbsp;счетчике&nbsp;обнулим&nbsp;буфер&nbsp;индикатора</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(ticks_counter==0)&nbsp;</span><span style="color: #0000ff;">ArrayInitialize</span><span>(LabelBuffer,0);</span><br> <span style="color: #999999;">//---&nbsp;увеличим&nbsp;счетчик</span><br> <span>&nbsp;&nbsp;&nbsp;ticks_counter++;</span><br> <span style="color: #999999;">//---&nbsp;нужно&nbsp;периодически&nbsp;сбрасывать&nbsp;счетчик&nbsp;тиков,&nbsp;чтобы&nbsp;оживлять&nbsp;распределение</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(ticks_counter&gt;100)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Обнулили&nbsp;значения&nbsp;индикатора,&nbsp;начнем&nbsp;заполнять&nbsp;ячейки&nbsp;снова"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ticks_counter=0;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;получим&nbsp;выборку&nbsp;случайных&nbsp;значений,&nbsp;как&nbsp;сумму&nbsp;трех&nbsp;чисел&nbsp;от&nbsp;0&nbsp;до&nbsp;7</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;</span><span style="color: #c0504d;">sample_number</span><span>;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;вычисление&nbsp;индекса&nbsp;ячейки,&nbsp;куда&nbsp;выпадет&nbsp;случайное&nbsp;число&nbsp;как&nbsp;сумма&nbsp;трех&nbsp;других</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;rand_index=0;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;получим&nbsp;три&nbsp;случайных&nbsp;числа&nbsp;от&nbsp;0&nbsp;до&nbsp;7</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;k=0;k&lt;3;k++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;остаток&nbsp;от&nbsp;деления&nbsp;на&nbsp;7&nbsp;вернет&nbsp;значение&nbsp;от&nbsp;0&nbsp;до&nbsp;6</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rand_index+=MathRand()%7;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;увеличим&nbsp;на&nbsp;единицу&nbsp;значение&nbsp;в&nbsp;ячейке&nbsp;с&nbsp;номером&nbsp;rand_index</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LabelBuffer[rand_index]++;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;выход&nbsp;из&nbsp;обработчика&nbsp;OnCalculate()</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(rates_total);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<br>