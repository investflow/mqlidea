<h1>Указатели объектов</h1> 
<p><span>В MQL4 существует возможность динамически создавать объекты сложного типа. Это делается при помощи <a href="/basis/operators/newoperator">оператора&nbsp;new</a>, который возвращает описатель созданного объекта. Описатель имеет размер 8 байт. Синтаксически описатели объектов в MQL4 похожи на указатели в C++.</span></p>
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>MyObject*&nbsp;hobject=&nbsp;</span><span style="color: #0000ff;">new</span><span>&nbsp;MyObject();</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>В отличие от C++, переменная hobject из вышеприведенного примера не является указателем на память, а является дескриптором объекта. Кроме того, в языке MQL5 все объекты в параметрах функции обязательно должны передаваться по ссылке. Примеры передачи объектов в качестве параметра функции:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">class</span><span>&nbsp;Foo</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #0000ff;">public</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_name;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_id;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">static</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_counter;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;конструкторы&nbsp;и&nbsp;деструкторы</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Foo(</span><span style="color: #0000ff;">void</span><span>){Setup(</span><span style="color: #008080;">"noname"</span><span>);};</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Foo(</span><span style="color: #0000ff;">string</span><span>&nbsp;name){Setup(name);};</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~Foo(</span><span style="color: #0000ff;">void</span><span>){};</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;инициализируем&nbsp;объект&nbsp;Foo</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">void</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setup(</span><span style="color: #0000ff;">string</span><span>&nbsp;name)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_name=name;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_counter++;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_id=s_counter;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;};</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;Foo::s_counter=0;</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;объявим&nbsp;объект&nbsp;как&nbsp;переменную&nbsp;с&nbsp;автоматическим&nbsp;созданием</span><br> <span>&nbsp;&nbsp;&nbsp;Foo&nbsp;foo1;</span><br> <span style="color: #808080;">//---&nbsp;вариант&nbsp;передачи&nbsp;объекта&nbsp;по&nbsp;ссылке</span><br> <span>&nbsp;&nbsp;&nbsp;PrintObject(foo1);</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;объявим&nbsp;указатель&nbsp;на&nbsp;объект&nbsp;и&nbsp;создадим&nbsp;его&nbsp;с&nbsp;помощью&nbsp;оператора&nbsp;'new'</span><br> <span>&nbsp;&nbsp;&nbsp;Foo&nbsp;*foo2=</span><span style="color: #0000ff;">new</span><span>&nbsp;Foo(</span><span style="color: #008080;">"foo2"</span><span>);</span><br> <span style="color: #808080;">//---&nbsp;вариант&nbsp;передачи&nbsp;указателя&nbsp;на&nbsp;объект&nbsp;по&nbsp;ссылке</span><br> <span>&nbsp;&nbsp;&nbsp;PrintObject(foo2);&nbsp;</span><span style="color: #808080;">//&nbsp;указатель&nbsp;на&nbsp;объект&nbsp;автоматически&nbsp;преобразуется&nbsp;компилятором</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;объявим&nbsp;массив&nbsp;объектов&nbsp;Foo</span><br> <span>&nbsp;&nbsp;&nbsp;Foo&nbsp;foo_objects[5];</span><br> <span style="color: #808080;">//---&nbsp;вариант&nbsp;передачи&nbsp;массива&nbsp;объектов</span><br> <span>&nbsp;&nbsp;&nbsp;PrintObjectsArray(foo_objects);&nbsp;</span><span style="color: #808080;">//&nbsp;отдельная&nbsp;функция&nbsp;для&nbsp;передачи&nbsp;массива&nbsp;объектов</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;объявим&nbsp;массив&nbsp;указателей&nbsp;на&nbsp;объекты&nbsp;типа&nbsp;Foo</span><br> <span>&nbsp;&nbsp;&nbsp;Foo&nbsp;*foo_pointers[5];</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;5;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foo_pointers[i]=</span><span style="color: #0000ff;">new</span><span>&nbsp;Foo(</span><span style="color: #008080;">"foo_pointer"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;вариант&nbsp;передачи&nbsp;массива&nbsp;указателей</span><br> <span>&nbsp;&nbsp;&nbsp;PrintPointersArray(foo_pointers);&nbsp;</span><span style="color: #808080;">//&nbsp;отдельная&nbsp;функция&nbsp;для&nbsp;передачи&nbsp;массива&nbsp;указателей</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;перед&nbsp;завершением&nbsp;работы&nbsp;обязательно&nbsp;удаляем&nbsp;объекты,&nbsp;созданные&nbsp;как&nbsp;указатели</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">delete</span><span>(foo2);</span><br> <span style="color: #808080;">//---&nbsp;удаляем&nbsp;массив&nbsp;указателей</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;size=</span><span style="color: #0000ff;">ArraySize</span><span>(foo_pointers);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;5;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">delete</span><span>(foo_pointers[i]);</span><br> <span style="color: #808080;">//---&nbsp;&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;Объекты&nbsp;всегда&nbsp;передаются&nbsp;по&nbsp;ссылке&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;PrintObject(Foo&nbsp;&amp;object)</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">__FUNCTION__</span><span>,</span><span style="color: #008080;">":&nbsp;"</span><span>,object.m_id,</span><span style="color: #008080;">"&nbsp;Object&nbsp;name="</span><span>,object.m_name);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Передача&nbsp;массива&nbsp;объектов&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;PrintObjectsArray(Foo&nbsp;&amp;objects[])</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;size=</span><span style="color: #0000ff;">ArraySize</span><span>(objects);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;size;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrintObject(objects[i]);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Передача&nbsp;массива&nbsp;указателей&nbsp;на&nbsp;объект&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;PrintPointersArray(Foo*&nbsp;&amp;objects[])</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;size=</span><span style="color: #0000ff;">ArraySize</span><span>(objects);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;size;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrintObject(objects[i]);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Смотри также</span></p> 
<p><span><a href="/basis/variables">Переменные</a>, <a href="/basis/variables/initialization">Инициализация переменных</a>, <a href="/basis/variables/variable_scope">Область видимости и время жизни переменных</a>, <a href="/basis/variables/object_live">Создание и уничтожение объектов</a></span></p>
<br>