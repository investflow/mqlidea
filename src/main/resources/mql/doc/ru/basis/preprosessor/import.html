<h1>Импорт функций (#import)</h1> 
<p><span>Импорт функций осуществляется из откомпилированных модулей MQL4 (файлы *.ex4) и из модулей операционной системы (файлы *.dll). Имя модуля указывается в директиве </span><span style="font-style: italic;">#import</span><span>. Для того чтобы компилятор мог правильно оформить вызов импортируемой функции и организовать правильную <a href="/basis/function/parameterpass">передачу&nbsp;параметров</a>, необходимо полное описание <a href="/basis/function">функций</a>. Описания функций следуют непосредственно за директивой </span><span style="font-style: italic;">#import "имя модуля"</span><span>. Новая команда </span><span style="font-style: italic;">#import</span><span> (можно без параметров) завершает блок описания импортируемых функций.</span></p>
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#import</span><span>&nbsp;</span><span style="color: #008080;">"имя_файла"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;func1&nbsp;define;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;func2&nbsp;define;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;...</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;funcN&nbsp;define;</span><br> <span style="color: #0000ff;">#import</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Импортируемые функции могут иметь любые имена. Можно одновременно импортировать из разных модулей функции с одинаковыми именами. Импортируемые функции могут иметь имена, совпадающие с именами встроенных функций. Операция <a href="/basis/operations/other#context_allow">разрешения контекста</a> определяет, какая из функций должна вызываться.</span></p>
<p><span>Порядок поиска файла, указанного после ключевого слова </span><span style="color: #0000ff;">#import</span><span>, описан в разделе <a href="/runtime/imports">Вызов импортируемых функций</a>.</span></p>
<p><span>Так как импортируемые функции находятся вне компилируемого модуля, компилятор не может проверить правильность передаваемых параметров. Поэтому, во избежание ошибок выполнения, необходимо точно описывать состав и порядок параметров, передаваемых в импортируемые функции. Параметры, передаваемые в импортируемые функции (как из EX4, так и из DLL-модулей), могут иметь значения по умолчанию.</span></p> 
<p><span>В импортируемых функциях в качестве параметров нельзя использовать:</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span><a href="/basis/types/object_pointers">указатели</a> (*);</span></p>
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>ссылки на объекты, содержащие <a href="/basis/types/dynamic_array">динамические массивы</a> и/или указатели.</span></p>
<p><span>В импортируемые из DLL функции нельзя передавать в качестве параметра классы, массив строк или сложные объекты, содержащие строки и/или динамические массивы любых типов.</span></p> 
<p><span style="font-weight: bold;">Примеры:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#import</span><span>&nbsp;</span><span style="color: #008080;">"user32.dll"</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxW(</span><span style="color: #0000ff;">uint</span><span>&nbsp;hWnd,</span><span style="color: #0000ff;">string</span><span>&nbsp;lpText,</span><span style="color: #0000ff;">string</span><span>&nbsp;lpCaption,</span><span style="color: #0000ff;">uint</span><span>&nbsp;uType);</span><br> <span style="color: #0000ff;">#import</span><span>&nbsp;</span><span style="color: #008080;">"stdlib.ex4"</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;ErrorDescription(</span><span style="color: #0000ff;">int</span><span>&nbsp;error_code);</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;RGB(</span><span style="color: #0000ff;">int</span><span>&nbsp;red_value,</span><span style="color: #0000ff;">int</span><span>&nbsp;green_value,</span><span style="color: #0000ff;">int</span><span>&nbsp;blue_value);</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;CompareDoubles(</span><span style="color: #0000ff;">double</span><span>&nbsp;number1,</span><span style="color: #0000ff;">double</span><span>&nbsp;number2);</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;DoubleToStrMorePrecision(</span><span style="color: #0000ff;">double</span><span>&nbsp;number,</span><span style="color: #0000ff;">int</span><span>&nbsp;precision);</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;IntegerToHexString(</span><span style="color: #0000ff;">int</span><span>&nbsp;integer_number);</span><br> <span style="color: #0000ff;">#import</span><span>&nbsp;</span><span style="color: #008080;">"ExpertSample.dll"</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;GetIntValue(</span><span style="color: #0000ff;">int</span><span>);</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;GetDoubleValue(</span><span style="color: #0000ff;">double</span><span>);</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;GetStringValue(</span><span style="color: #0000ff;">string</span><span>);</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;GetArrayItemValue(</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;arr[],</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">int</span><span>);</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;SetArrayItemValue(</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;arr[],</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">double</span><span>);</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;GetRatesItemValue(</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;rates[][6],</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">int</span><span>,</span><span style="color: #0000ff;">int</span><span>);</span><br> <span style="color: #0000ff;">#import</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p style="page-break-inside: avoid;"><span>&nbsp;</span></p> 
<p><span>Для импорта функций во время выполнения mql4-программы используется раннее связывание. Это значит, что библиотека загружается в процессе загрузки использующей ее ex4-программы.</span></p> 
<p><span>Не рекомендуется использовать полностью квалифицированное имя загружаемого модуля вида </span><span style="font-style: italic;">Drive:\Directory\FileName.Ext</span><span>. Библиотеки MQL4 загружаются из папки </span><span style="font-style: italic;">terminal_dir\MQL4\Libraries</span><span>. </span></p> 
<p><span>Смотри также</span></p> 
<p><span><a href="/basis/preprosessor/include">Включение файлов</a></span></p>
<br>