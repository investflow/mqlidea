<h1>Условная компиляция (#ifdef, #ifndef, #else, #endif)</h1> 
<p><span>Директивы условной компиляции препроцессора позволяют компилировать или пропускать часть программы в зависимости от выполнения некоторого условия.</span></p> 
<p><span>Условие может принимать одну из описываемых ниже форм.</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#ifdef</span><span>&nbsp;identifier</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;код,&nbsp;находящийся&nbsp;здесь,&nbsp;компилируется,&nbsp;если&nbsp;identifier&nbsp;уже&nbsp;был&nbsp;определен&nbsp;для&nbsp;препроцессора&nbsp;в&nbsp;команде&nbsp;#define.</span><br> <span style="color: #0000ff;">#endif</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#ifndef</span><span>&nbsp;identifier</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;код,&nbsp;находящийся&nbsp;здесь,&nbsp;компилируется,&nbsp;если&nbsp;identifier&nbsp;в&nbsp;данный&nbsp;момент&nbsp;не&nbsp;определен&nbsp;командой&nbsp;препроцессора&nbsp;#define.</span><br> <span style="color: #0000ff;">#endif</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>За любой из команд условной компиляции может следовать произвольное число строк, содержащих, возможно, команду вида #else и заканчивающихся #endif. Если проверяемое условие справедливо, то строки между #else и #endif игнорируются. Если же проверяемое условие не выполняется, то игнорируются все строки между проверкой и командой #else, а если ее нет, то командой #endif.</span></p> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#ifndef</span><span>&nbsp;TestMode</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#define</span><span>&nbsp;TestMode</span><br> <span style="color: #0000ff;">#endif</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;#ifdef</span><span>&nbsp;TestMode</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Test&nbsp;mode"</span><span>);</span><br> <span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;#else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Normal&nbsp;mode"</span><span>);</span><br> <span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;#endif</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>В зависимости от типа программы и режима компиляции стандартные макросы определяются следующим образом:</span></p> 
<p><span>Макрос __MQL4__ &nbsp;доступен при компиляции файла *.mq4, при компиляции *.mq5 доступен макрос __MQL5__.</span><br> <span>Макрос _DEBUG доступен при компиляции под отладку.</span><br> <span>Макрос _RELEASE доступен при компиляции не под отладку.</span></p> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;#ifdef</span><span>&nbsp;</span><span style="color: #333399;">__MQL5__</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#ifdef</span><span>&nbsp;</span><span style="color: #333399;">_DEBUG</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Hello&nbsp;from&nbsp;MQL5&nbsp;compiler&nbsp;[DEBUG]"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#ifdef</span><span>&nbsp;</span><span style="color: #333399;">_RELEASE</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Hello&nbsp;from&nbsp;MQL5&nbsp;compiler&nbsp;[RELEASE]"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#endif</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#endif</span><br> <span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;#else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#ifdef</span><span>&nbsp;</span><span style="color: #333399;">__MQL4__</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#ifdef</span><span>&nbsp;</span><span style="color: #333399;">_DEBUG</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Hello&nbsp;from&nbsp;MQL4&nbsp;compiler&nbsp;[DEBUG]"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#ifdef</span><span>&nbsp;</span><span style="color: #333399;">_RELEASE</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Hello&nbsp;from&nbsp;MQL4&nbsp;compiler&nbsp;[RELEASE]"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#endif</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#endif</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">#endif</span><br> <span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;#endif</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p style="page-break-inside: avoid;"><span>&nbsp;</span></p> 
<br>