<h1>Перегрузка операций</h1> 
<p><span>Для удобства чтения и написания кода разрешается перегрузка некоторых операций. Оператор перегрузки записывается с помощью ключевого слова </span><span style="color: #0000ff;">operator</span><span>. Разрешена перегрузка следующих операций:</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>бинарные +,-,/,*,%,&lt;&lt;,&gt;&gt;,==,!=,&lt;,&gt;,&lt;=,&gt;=,=,+=,-=,/=,*=,%=,&amp;=,|=,^=,&lt;&lt;=,&gt;&gt;=,&amp;&amp;,||,&amp;,|,^;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>унарные +,-,++,--,!,~;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>оператор присваивания =;</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>оператор индексации []. </span></p> 
<p><span>Перегрузка операций позволяет использовать операционную нотацию (запись в виде простых выражений) к сложным объектам - структурам и классам. Запись выражений с использованием перегруженных операций упрощает восприятие исходного кода, так как более сложная реализация сокрыта.</span></p> 
<p><span>Для примера рассмотрим широко применяемые в математике комплексные числа, которые состоят из действительной и мнимой части. В языке MQL4 нет типа данных для представления комплексных чисел, но есть возможность создать новый тип данных в виде <a href="/basis/types/classes">структуры или класса</a>. Объявим структуру complex и определим в ней четыре метода, реализующие четыре арифметические операции:</span></p>
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Структура&nbsp;для&nbsp;операций&nbsp;с&nbsp;комплексными&nbsp;числами&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">struct</span><span>&nbsp;complex</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;re;&nbsp;</span><span style="color: #999999;">//&nbsp;действительная&nbsp;часть</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im;&nbsp;</span><span style="color: #999999;">//&nbsp;мнимая&nbsp;часть</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;конструкторы</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex():re(0.0),im(0.0)&nbsp;{&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;r):re(r),im(0.0)&nbsp;{&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;r,</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;i):re(r),im(i)&nbsp;{&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;o):re(o.re),im(o.im)&nbsp;{&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;арифметические&nbsp;операции</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;сложение</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sub(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;вычитание</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mul(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;умножение</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Div(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;деление</span><br> <span>&nbsp;&nbsp;};</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Теперь мы можем объявлять в своем коде переменные, представляющие комплексные числа, и работать с ними. </span></p> 
<p><span> Например так:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;объявим&nbsp;и&nbsp;инициализируем&nbsp;переменные&nbsp;комплексного&nbsp;типа</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;a(2,4),b(-4,-2);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a=%.2f+i*%.2f,&nbsp;&nbsp;&nbsp;b=%.2f+i*%.2f"</span><span>,a.re,a.im,b.re,b.im);</span><br> <span style="color: #999999;">//---&nbsp;сложим&nbsp;два&nbsp;числа</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;z;</span><br> <span>&nbsp;&nbsp;&nbsp;z=a.Add(a,b);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a+b=%.2f+i*%.2f"</span><span>,z.re,z.im);</span><br> <span style="color: #999999;">//---&nbsp;умножим&nbsp;два&nbsp;числа</span><br> <span>&nbsp;&nbsp;&nbsp;z=a.Mul(a,b);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a*b=%.2f+i*%.2f"</span><span>,z.re,z.im);</span><br> <span style="color: #999999;">//---&nbsp;разделим&nbsp;два&nbsp;числа</span><br> <span>&nbsp;&nbsp;&nbsp;z=a.Div(a,b);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a/b=%.2f+i*%.2f"</span><span>,z.re,z.im);</span><br> <span style="color: #999999;">//---</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Но было бы удобнее для привычных арифметических операций с комплексными числами использовать привычные операторы "+","-","*" и "/".</span></p> 
<p><span>Ключевое слово </span><span style="color: #0000ff;">operator</span><span> используется для того чтобы определить функцию-член, осуществляющую преобразование типа. Унарные и бинарные операции для переменных-объектов класса могут быть перегружены как нестатические функции-члены. Они неявно действуют на объект класса. </span></p> 
<p><a id="binary"></a><span>Большинство бинарных операций можно перегружать как обычные функции, принимающие один или оба аргумента в виде переменной класса или в виде указателя на объект данного класса. Для нашего типа complex перегрузка в объявлении будет выглядеть так:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;операторы</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;</span><span style="color: #0000ff;">operator</span><span>+(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(Add(this,r));&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;</span><span style="color: #0000ff;">operator</span><span>-(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(Sub(this,r));&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;</span><span style="color: #0000ff;">operator</span><span>*(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(Mul(this,r));&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;</span><span style="color: #0000ff;">operator</span><span>/(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(Div(this,r));&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Полный пример скрипта:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;объявим&nbsp;и&nbsp;инициализируем&nbsp;переменные&nbsp;комплексного&nbsp;типа</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;a(2,4),b(-4,-2);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a=%.2f+i*%.2f,&nbsp;&nbsp;&nbsp;b=%.2f+i*%.2f"</span><span>,a.re,a.im,b.re,b.im);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//a.re=5;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//a.im=1;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//b.re=-1;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//b.im=-5;</span><br> <span style="color: #999999;">//---&nbsp;сложим&nbsp;два&nbsp;числа</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;z=a+b;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a+b=%.2f+i*%.2f"</span><span>,z.re,z.im);</span><br> <span style="color: #999999;">//---&nbsp;умножим&nbsp;два&nbsp;числа</span><br> <span style="color: #999999;">&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;z=a*b;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a*b=%.2f+i*%.2f"</span><span>,z.re,z.im);</span><br> <span style="color: #999999;">//---&nbsp;разделим&nbsp;два&nbsp;числа</span><br> <span>&nbsp;&nbsp;&nbsp;z=a/b;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a/b=%.2f+i*%.2f"</span><span>,z.re,z.im);</span><br> <span style="color: #999999;">//---</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Структура&nbsp;для&nbsp;операций&nbsp;с&nbsp;комплексными&nbsp;числами&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">struct</span><span>&nbsp;complex</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;re;&nbsp;</span><span style="color: #999999;">//&nbsp;действительная&nbsp;часть</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im;&nbsp;</span><span style="color: #999999;">//&nbsp;мнимая&nbsp;часть</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;конструкторы</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex():re(0.0),im(0.0)&nbsp;{&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;r):re(r),im(0.0)&nbsp;{&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;r,</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;i):re(r),im(i)&nbsp;{&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complex(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;o):re(o.re),im(o.im)&nbsp;{&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;арифметические&nbsp;операции</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;сложение</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sub(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;вычитание</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mul(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;умножение</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Div(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;деление</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;бинарные&nbsp;операторы</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;</span><span style="color: #0000ff;">operator</span><span>+(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(Add(this,r));&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;</span><span style="color: #0000ff;">operator</span><span>-(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(Sub(this,r));&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;</span><span style="color: #0000ff;">operator</span><span>*(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(Mul(this,r));&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;</span><span style="color: #0000ff;">operator</span><span>/(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(Div(this,r));&nbsp;}</span><br> <span>&nbsp;&nbsp;};</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Сложение&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>complex&nbsp;complex::Add(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;res;</span><br> <span style="color: #999999;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;res.re=l.re+r.re;</span><br> <span>&nbsp;&nbsp;&nbsp;res.im=l.im+r.im;</span><br> <span style="color: #999999;">//---&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>&nbsp;res;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Вычитание&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>complex&nbsp;complex::Sub(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;res;</span><br> <span style="color: #999999;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;res.re=l.re-r.re;</span><br> <span>&nbsp;&nbsp;&nbsp;res.im=l.im-r.im;</span><br> <span style="color: #999999;">//---&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>&nbsp;res;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Умножение&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>complex&nbsp;complex::Mul(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;res;</span><br> <span style="color: #999999;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;res.re=l.re*r.re-l.im*r.im;</span><br> <span>&nbsp;&nbsp;&nbsp;res.im=l.re*r.im+l.im*r.re;</span><br> <span style="color: #999999;">//---&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>&nbsp;res;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Деление&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>complex&nbsp;complex::Div(</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;l,</span><span style="color: #0000ff;">const</span><span>&nbsp;complex&nbsp;&amp;r)&nbsp;</span><span style="color: #0000ff;">const</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;пустое&nbsp;комплексное&nbsp;число</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;res(</span><span style="color: #0000ff;">EMPTY_VALUE</span><span>,</span><span style="color: #0000ff;">EMPTY_VALUE</span><span>);</span><br> <span style="color: #999999;">//---&nbsp;проверка&nbsp;на&nbsp;ноль</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(r.re==0&nbsp;&amp;&amp;&nbsp;r.im==0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">__FUNCTION__</span><span>+</span><span style="color: #008080;">":&nbsp;number&nbsp;is&nbsp;zero"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(res);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;вспомогательные&nbsp;переменные</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;e;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;f;</span><br> <span style="color: #999999;">//---&nbsp;выбор&nbsp;варианта&nbsp;вычисления</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">MathAbs</span><span>(r.im)&lt;</span><span style="color: #0000ff;">MathAbs</span><span>(r.re))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;=&nbsp;r.im/r.re;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;r.re+r.im*e;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.re=(l.re+l.im*e)/f;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.im=(l.im-l.re*e)/f;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;=&nbsp;r.re/r.im;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;r.im+r.re*e;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.re=(l.im+l.re*e)/f;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.im=(-l.re+l.im*e)/f;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>&nbsp;res;</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>&nbsp;</span></p> 
<p><a id="unary"></a><span>Большинство унарных операций для классов можно перегружать как обычные функции, принимающие единственный аргумент-объект класса или указатель на него. Добавим перегрузку унарных операций "-" и "!".</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Структура&nbsp;для&nbsp;операций&nbsp;с&nbsp;комплексными&nbsp;числами&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">struct</span><span>&nbsp;complex</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;re;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;действительная&nbsp;часть</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;мнимая&nbsp;часть</span><br> <span>...</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;унарные&nbsp;операторы&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;</span><span style="color: #0000ff;">operator</span><span>-()&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;</span><span style="color: #999999;">//&nbsp;унарный&nbsp;минус</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">operator</span><span>!()&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>;&nbsp;</span><span style="color: #999999;">//&nbsp;отрицание</span><br> <span>&nbsp;&nbsp;};</span><br> <span>...</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Перегрузка&nbsp;оператора&nbsp;"унарный&nbsp;минус"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>complex&nbsp;complex::</span><span style="color: #0000ff;">operator</span><span>-()&nbsp;</span><span style="color: #0000ff;">const</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;res;</span><br> <span style="color: #999999;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;res.re=-re;</span><br> <span>&nbsp;&nbsp;&nbsp;res.im=-im;</span><br> <span style="color: #999999;">//---&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>&nbsp;res;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Перегрузка&nbsp;оператора&nbsp;"логическое&nbsp;отрицание"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;complex::</span><span style="color: #0000ff;">operator</span><span>!()&nbsp;</span><span style="color: #0000ff;">const</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;действительная&nbsp;и&nbsp;мнимая&nbsp;часть&nbsp;комплексного&nbsp;числа&nbsp;равны&nbsp;нулю?</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>&nbsp;(re!=0&nbsp;&amp;&amp;&nbsp;im!=0);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>&nbsp;</span></p> 
<p><span>Теперь мы можем проверять значение комплексного числа на ноль и получать отрицательное значение:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;объявим&nbsp;и&nbsp;инициализируем&nbsp;переменные&nbsp;комплексного&nbsp;типа</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;a(2,4),b(-4,-2);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a=%.2f+i*%.2f,&nbsp;&nbsp;&nbsp;b=%.2f+i*%.2f"</span><span>,a.re,a.im,b.re,b.im);</span><br> <span style="color: #999999;">//---&nbsp;разделим&nbsp;два&nbsp;числа</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;z=a/b;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"a/b=%.2f+i*%.2f"</span><span>,z.re,z.im);</span><br> <span style="color: #999999;">//---&nbsp;комплексное&nbsp;число&nbsp;по&nbsp;умолчанию&nbsp;равно&nbsp;нулю&nbsp;(в&nbsp;конструкторе&nbsp;по&nbsp;умолчанию&nbsp;re==0&nbsp;и&nbsp;im==0)</span><br> <span>&nbsp;&nbsp;&nbsp;complex&nbsp;zero;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"!zero="</span><span>,!zero);</span><br> <span style="color: #999999;">//---&nbsp;присвоим&nbsp;отрицательное&nbsp;значение</span><br> <span>&nbsp;&nbsp;&nbsp;zero=-z;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"z=%.2f+i*%.2f,&nbsp;&nbsp;zero=%.2f+i*%.2f"</span><span>,z.re,z.im,&nbsp;zero.re,zero.im);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"-zero=%.2f+i*%.2f"</span><span>,-zero.re,-zero.im);</span><br> <span style="color: #999999;">//---&nbsp;еще&nbsp;раз&nbsp;проверим&nbsp;на&nbsp;равенство&nbsp;нулю&nbsp;&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"!zero="</span><span>,!zero);</span><br> <span style="color: #999999;">//---</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Обратите внимание, что нам не пришлось в данном случае перегружать операцию присваивания "=", так как <a href="/basis/types/classes#simple_structure">структуры простых типов</a> можно копировать друг в друга напрямую. Таким образом, теперь мы можем писать код для расчетов с участием комплексных чисел в привычной манере.</span></p>
<p><a id="indexing"></a><span>Перегрузка оператора индексирования позволяет получать значения массивов, заключенных в объект, более простым и привычным способом, и это также способствует лучшей читаемости и пониманию исходного кода программ. Например, нам необходимо обеспечить доступ к символу в строке по указанной позиции. Строка в языке MQL4 является отдельным типом <a href="/basis/types/stringconst">string</a>, который не является массивом символов, но с помощью перегруженной операции индексации в созданном классе CString мы можем обеспечить простую и прозрачную работу:</span></p>
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Класс&nbsp;для&nbsp;доступа&nbsp;к&nbsp;символам&nbsp;в&nbsp;строке&nbsp;как&nbsp;в&nbsp;массиве&nbsp;символов&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">class</span><span>&nbsp;CString</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_string;</span><br> <span>&nbsp;&nbsp;</span><br> <span style="color: #0000ff;">public</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CString(</span><span style="color: #0000ff;">string</span><span>&nbsp;str=</span><span style="color: #ff00ff;">NULL</span><span>):m_string(str)&nbsp;{&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ushort</span><span>&nbsp;</span><span style="color: #0000ff;">operator</span><span>[]&nbsp;(</span><span style="color: #0000ff;">int</span><span>&nbsp;x)&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">StringGetCharacter</span><span>(m_string,x));&nbsp;}</span><br> <span>&nbsp;&nbsp;};</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;массив&nbsp;для&nbsp;получения&nbsp;символов&nbsp;из&nbsp;строки</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x[]={&nbsp;19,4,18,19,27,14,15,4,17,0,19,14,17,27,26,28,27,5,14,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17,27,2,11,0,18,18,27,29,30,19,17,8,13,6&nbsp;};</span><br> <span>&nbsp;&nbsp;&nbsp;CString&nbsp;str(</span><span style="color: #008080;">"abcdefghijklmnopqrstuvwxyz[&nbsp;]CS"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;res;</span><br> <span style="color: #999999;">//---&nbsp;составим&nbsp;фразу,набрав&nbsp;символы&nbsp;из&nbsp;переменной&nbsp;str</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0,n=ArraySize(x);i&lt;n;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res+=</span><span style="color: #0000ff;">ShortToString</span><span>(str[x[i]]);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;выведем&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(res);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>&nbsp;</span></p> 
<p><span>Другой пример перегрузки операции индексирования - работа с матрицами. Матрица представляет собою двумерный динамический массив, размеры массивов заранее неопределены. Поэтому нельзя объявить массив вида array[][] без указания размера второго измерения и затем передавать этот массив в качестве параметра. Выходом может служить специальный класс CMatrix, который содержит в себе массив объектов класса CRow.</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;операции&nbsp;сложения&nbsp;и&nbsp;умножения&nbsp;матриц</span><br> <span>&nbsp;&nbsp;&nbsp;CMatrix&nbsp;A(3),B(3),C();</span><br> <span style="color: #999999;">//---&nbsp;готовим&nbsp;массивы&nbsp;под&nbsp;строки</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;a1[3]={1,2,3},&nbsp;a2[3]={2,3,1},&nbsp;a3[3]={3,1,2};</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;b1[3]={3,2,1},&nbsp;b2[3]={1,3,2},&nbsp;b3[3]={2,1,3};</span><br> <span style="color: #999999;">//---&nbsp;заполняем&nbsp;матрицы</span><br> <span>&nbsp;&nbsp;&nbsp;A[0]=a1;&nbsp;A[1]=a2;&nbsp;A[2]=a3;</span><br> <span>&nbsp;&nbsp;&nbsp;B[0]=b1;&nbsp;B[1]=b2;&nbsp;B[2]=b3;</span><br> <span style="color: #999999;">//---&nbsp;выведем&nbsp;матрицы&nbsp;в&nbsp;журнал&nbsp;"Эксперты"</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"----&nbsp;элементы&nbsp;матрицы&nbsp;A"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(A.</span><span style="color: #0000ff;">String</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"----&nbsp;элементы&nbsp;матрицы&nbsp;B"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(B.</span><span style="color: #0000ff;">String</span><span>());</span><br> <span>&nbsp;</span><br> <span style="color: #999999;">//---&nbsp;сложение&nbsp;матриц</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"----&nbsp;сложение&nbsp;матриц&nbsp;A&nbsp;и&nbsp;B"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;C=A+B;</span><br> <span style="color: #999999;">//---&nbsp;вывод&nbsp;форматированного&nbsp;строкового&nbsp;представления</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(C.</span><span style="color: #0000ff;">String</span><span>());</span><br> <span>&nbsp;</span><br> <span style="color: #999999;">//---&nbsp;умножение&nbsp;матриц</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"----&nbsp;произведение&nbsp;матриц&nbsp;A&nbsp;и&nbsp;B"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;C=A*B;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(C.</span><span style="color: #0000ff;">String</span><span>());</span><br> <span>&nbsp;</span><br> <span style="color: #999999;">//---&nbsp;а&nbsp;теперь&nbsp;&nbsp;покажем&nbsp;как&nbsp;получать&nbsp;значения&nbsp;в&nbsp;стиле&nbsp;динамических&nbsp;массивов&nbsp;matrix[i][j]</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Выводим&nbsp;значения&nbsp;матрицы&nbsp;C&nbsp;поэлементно"</span><span>);</span><br> <span style="color: #999999;">//---&nbsp;перебираем&nbsp;в&nbsp;цикле&nbsp;строки&nbsp;матрицы&nbsp;-&nbsp;объекты&nbsp;CRow</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;3;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;com=</span><span style="color: #008080;">"|&nbsp;"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;формируем&nbsp;для&nbsp;значения&nbsp;строки&nbsp;из&nbsp;матрицы</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;j=0;j&lt;3;j++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;получим&nbsp;элемент&nbsp;матрицы&nbsp;по&nbsp;номерам&nbsp;строки&nbsp;и&nbsp;столбца</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;element=C[i][j];</span><span style="color: #999999;">//&nbsp;[i]&nbsp;-&nbsp;доступ&nbsp;к&nbsp;CRow&nbsp;в&nbsp;массиве&nbsp;m_rows[]&nbsp;,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;[j]&nbsp;-&nbsp;перегруженный&nbsp;оператор&nbsp;индексации&nbsp;в&nbsp;CRow</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;com=com+</span><span style="color: #0000ff;">StringFormat</span><span>(</span><span style="color: #008080;">"a(%d,%d)=%G&nbsp;;&nbsp;"</span><span>,i,j,element);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;com+=</span><span style="color: #008080;">"|"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;выводим&nbsp;значения&nbsp;строки</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(com);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Класс&nbsp;"Строка"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">class</span><span>&nbsp;CRow</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #0000ff;">private</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_array[];</span><br> <span style="color: #0000ff;">public</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;конструкторы&nbsp;и&nbsp;деструктор</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CRow(</span><span style="color: #0000ff;">void</span><span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(m_array,0);&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CRow(</span><span style="color: #0000ff;">const</span><span>&nbsp;CRow&nbsp;&amp;r)&nbsp;{&nbsp;</span><span style="color: #0000ff;">this</span><span>=r;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CRow(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;array[]);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~CRow(</span><span style="color: #0000ff;">void</span><span>){};</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;количество&nbsp;элементов&nbsp;в&nbsp;строке</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size(</span><span style="color: #0000ff;">void</span><span>)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">ArraySize</span><span>(m_array));}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;возвращает&nbsp;строку&nbsp;со&nbsp;значениями&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">String</span><span>(</span><span style="color: #0000ff;">void</span><span>)&nbsp;</span><span style="color: #0000ff;">const</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;оператор&nbsp;индексации</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">operator</span><span>[](</span><span style="color: #0000ff;">int</span><span>&nbsp;i)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(m_array[i]);&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;операторы&nbsp;присваивания</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">void</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">operator</span><span>=(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&amp;array[]);&nbsp;</span><span style="color: #999999;">//&nbsp;массив</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">void</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">operator</span><span>=(</span><span style="color: #0000ff;">const</span><span>&nbsp;CRow&nbsp;&amp;&nbsp;r);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;другой&nbsp;объект&nbsp;CRow</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">operator</span><span>*(</span><span style="color: #0000ff;">const</span><span>&nbsp;CRow&nbsp;&amp;o);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//&nbsp;объект&nbsp;CRow&nbsp;для&nbsp;умножения</span><br> <span>&nbsp;&nbsp;};</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Конструктор&nbsp;для&nbsp;инициализации&nbsp;строки&nbsp;массивом&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;&nbsp;CRow::CRow(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;array[])</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;size=</span><span style="color: #0000ff;">ArraySize</span><span>(array);</span><br> <span style="color: #999999;">//---&nbsp;если&nbsp;массив&nbsp;не&nbsp;пустой</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(size&gt;0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(m_array,size);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;заполним&nbsp;значениями</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;size;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_array[i]=array[i];</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Операция&nbsp;присваивания&nbsp;для&nbsp;массива&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;CRow::</span><span style="color: #0000ff;">operator</span><span>=(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;array[])</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;size=</span><span style="color: #0000ff;">ArraySize</span><span>(array);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(size==0)&nbsp;</span><span style="color: #0000ff;">return</span><span>;</span><br> <span style="color: #999999;">//---&nbsp;заполняем&nbsp;массив&nbsp;значениями</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(m_array,size);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;size;i++)&nbsp;m_array[i]=array[i];</span><br> <span style="color: #999999;">//---&nbsp;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Операция&nbsp;присваивания&nbsp;для&nbsp;СRow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;CRow::</span><span style="color: #0000ff;">operator</span><span>=(</span><span style="color: #0000ff;">const</span><span>&nbsp;CRow&nbsp;&nbsp;&amp;r)</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;size=r.Size();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(size==0)&nbsp;</span><span style="color: #0000ff;">return</span><span>;</span><br> <span style="color: #999999;">//---&nbsp;заполняем&nbsp;массив&nbsp;значениями</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(m_array,size);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;size;i++)&nbsp;m_array[i]=r[i];</span><br> <span style="color: #999999;">//---&nbsp;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Оператор&nbsp;умножения&nbsp;на&nbsp;другую&nbsp;строку&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">double</span><span>&nbsp;CRow::</span><span style="color: #0000ff;">operator</span><span>*(</span><span style="color: #0000ff;">const</span><span>&nbsp;CRow&nbsp;&amp;o)</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;res=0;</span><br> <span style="color: #999999;">//---&nbsp;проверки</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;size=Size();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(size!=o.Size()&nbsp;||&nbsp;size==0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">__FUNCSIG__</span><span>,</span><span style="color: #008080;">":&nbsp;Ошибка&nbsp;умножения&nbsp;двух&nbsp;матриц,&nbsp;не&nbsp;совпадают&nbsp;размеры"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(res);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;умножим&nbsp;поэлементно&nbsp;массивы&nbsp;и&nbsp;сложим&nbsp;произведения</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;size;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res+=m_array[i]*o[i];</span><br> <span style="color: #999999;">//---&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(res);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Возвращает&nbsp;форматированное&nbsp;строковое&nbsp;представление&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;CRow::</span><span style="color: #0000ff;">String</span><span>(</span><span style="color: #0000ff;">void</span><span>)&nbsp;</span><span style="color: #0000ff;">const</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;out=</span><span style="color: #008080;">""</span><span>;</span><br> <span style="color: #999999;">//---&nbsp;если&nbsp;размер&nbsp;массива&nbsp;больше&nbsp;нуля</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;size=</span><span style="color: #0000ff;">ArraySize</span><span>(m_array);</span><br> <span style="color: #999999;">//---&nbsp;работаем&nbsp;только&nbsp;при&nbsp;ненулевом&nbsp;кол-ве&nbsp;элементов&nbsp;в&nbsp;массиве</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(size&gt;0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out=</span><span style="color: #008080;">"{"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;size;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;собираем&nbsp;значения&nbsp;в&nbsp;строку</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out+=</span><span style="color: #0000ff;">StringFormat</span><span>(</span><span style="color: #008080;">"&nbsp;%G;"</span><span>,m_array[i]);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out+=</span><span style="color: #008080;">"&nbsp;}"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(out);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Класс&nbsp;"Матрица"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">class</span><span>&nbsp;CMatrix</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #0000ff;">private</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;CRow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_rows[];</span><br> <span>&nbsp;</span><br> <span style="color: #0000ff;">public</span><span>:</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;конструкторы&nbsp;и&nbsp;деструктор</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMatrix(</span><span style="color: #0000ff;">void</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMatrix(</span><span style="color: #0000ff;">int</span><span>&nbsp;rows)&nbsp;&nbsp;{&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(m_rows,rows);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~CMatrix(</span><span style="color: #0000ff;">void</span><span>){};</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;получение&nbsp;размеров&nbsp;матрицы</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rows()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">ArraySize</span><span>(m_rows));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cols()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(Rows()&gt;0?&nbsp;m_rows[0].Size():0);&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;возвращает&nbsp;значения&nbsp;столбца&nbsp;в&nbsp;виде&nbsp;строки&nbsp;CRow</span><br> <span>&nbsp;&nbsp;&nbsp;CRow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetColumnAsRow(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;col_index)&nbsp;</span><span style="color: #0000ff;">const</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;возвращает&nbsp;строку&nbsp;со&nbsp;значениями&nbsp;матрицы&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">String</span><span>(</span><span style="color: #0000ff;">void</span><span>)&nbsp;</span><span style="color: #0000ff;">const</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;оператор&nbsp;индексации&nbsp;возвращает&nbsp;строку&nbsp;по&nbsp;ее&nbsp;номеру</span><br> <span>&nbsp;&nbsp;&nbsp;CRow&nbsp;*</span><span style="color: #0000ff;">operator</span><span>[](</span><span style="color: #0000ff;">int</span><span>&nbsp;i)&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">GetPointer</span><span>(m_rows[i]));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;оператор&nbsp;сложения</span><br> <span>&nbsp;&nbsp;&nbsp;CMatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">operator</span><span>+(</span><span style="color: #0000ff;">const</span><span>&nbsp;CMatrix&nbsp;&amp;m);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;оператор&nbsp;умножения</span><br> <span>&nbsp;&nbsp;&nbsp;CMatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">operator</span><span>*(</span><span style="color: #0000ff;">const</span><span>&nbsp;CMatrix&nbsp;&amp;m);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;оператор&nbsp;присваивания</span><br> <span>&nbsp;&nbsp;&nbsp;CMatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span><span style="color: #0000ff;">operator</span><span>=(</span><span style="color: #0000ff;">const</span><span>&nbsp;CMatrix&nbsp;&amp;m);</span><br> <span>&nbsp;&nbsp;};</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Конструктор&nbsp;по&nbsp;умолчанию,&nbsp;создает&nbsp;массив&nbsp;строк&nbsp;нулевого&nbsp;размера&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>CMatrix::CMatrix(</span><span style="color: #0000ff;">void</span><span>)</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;нулевое&nbsp;количество&nbsp;строк&nbsp;в&nbsp;матрице&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(m_rows,0);</span><br> <span style="color: #999999;">//---&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Возвращает&nbsp;значения&nbsp;столбца&nbsp;в&nbsp;виде&nbsp;строки&nbsp;CRow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>CRow&nbsp;&nbsp;CMatrix::GetColumnAsRow(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;col_index)&nbsp;</span><span style="color: #0000ff;">const</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;переменная&nbsp;для&nbsp;получения&nbsp;значений&nbsp;из&nbsp;столбца</span><br> <span>&nbsp;&nbsp;&nbsp;CRow&nbsp;row();</span><br> <span style="color: #999999;">//---&nbsp;количество&nbsp;строк&nbsp;в&nbsp;матрице</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;rows=Rows();</span><br> <span style="color: #999999;">//---&nbsp;если&nbsp;количество&nbsp;строк&nbsp;больше&nbsp;нуля,&nbsp;выполняем&nbsp;операцию</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(rows&gt;0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;массив&nbsp;для&nbsp;получения&nbsp;значений&nbsp;столбца&nbsp;с&nbsp;индексом&nbsp;col_index</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;array[];</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(array,rows);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;заполнение&nbsp;массива</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;rows;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;проверка&nbsp;номера&nbsp;столбца&nbsp;для&nbsp;i-ой&nbsp;строки&nbsp;на&nbsp;выход&nbsp;за&nbsp;пределы&nbsp;массива</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(col_index&gt;=</span><span style="color: #0000ff;">this</span><span>[i].Size())</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">__FUNCSIG__</span><span>,</span><span style="color: #008080;">":&nbsp;Ошибка!&nbsp;Номер&nbsp;столбца&nbsp;"</span><span>,col_index,</span><span style="color: #008080;">"&gt;&nbsp;размера&nbsp;строки&nbsp;"</span><span>,i);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">break</span><span>;&nbsp;</span><span style="color: #999999;">//&nbsp;row&nbsp;останется&nbsp;неинициализированным&nbsp;объектом</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array[i]=</span><span style="color: #0000ff;">this</span><span>[i][col_index];</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;создадим&nbsp;строку&nbsp;CRow&nbsp;на&nbsp;основе&nbsp;значений&nbsp;массива&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row=array;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(row);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Сложение&nbsp;двух&nbsp;матриц&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>CMatrix&nbsp;CMatrix::</span><span style="color: #0000ff;">operator</span><span>+(</span><span style="color: #0000ff;">const</span><span>&nbsp;CMatrix&nbsp;&amp;m)</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;количество&nbsp;строк&nbsp;и&nbsp;столбцов&nbsp;в&nbsp;переданной&nbsp;матрице</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;cols=m.Cols();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;rows=m.Rows();</span><br> <span style="color: #999999;">//---&nbsp;матрица&nbsp;для&nbsp;получения&nbsp;результата&nbsp;сложения&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;CMatrix&nbsp;res(rows);</span><br> <span style="color: #999999;">//---&nbsp;размеры&nbsp;матрицы&nbsp;должны&nbsp;совпадать</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(cols!=Cols()&nbsp;||&nbsp;rows!=Rows())</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;нельзя&nbsp;произвести&nbsp;сложение</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">__FUNCSIG__</span><span>,</span><span style="color: #008080;">":&nbsp;Ошибка&nbsp;сложения&nbsp;двух&nbsp;матриц,&nbsp;не&nbsp;совпадают&nbsp;размеры"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(res);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;вспомогательный&nbsp;массив</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;arr[];</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(arr,cols);</span><br> <span style="color: #999999;">//---&nbsp;перебираем&nbsp;строки&nbsp;для&nbsp;сложения</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;rows;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;запишем&nbsp;результаты&nbsp;сложений&nbsp;строк&nbsp;матриц&nbsp;в&nbsp;массив</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;k=0;k&lt;cols;k++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr[k]=</span><span style="color: #0000ff;">this</span><span>[i][k]+m[i][k];</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;поместим&nbsp;массив&nbsp;в&nbsp;строку&nbsp;матрицы</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[i]=arr;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;вернем&nbsp;результат&nbsp;сложения&nbsp;матриц</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(res);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Умножение&nbsp;двух&nbsp;матриц&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>CMatrix&nbsp;CMatrix::</span><span style="color: #0000ff;">operator</span><span>*(</span><span style="color: #0000ff;">const</span><span>&nbsp;CMatrix&nbsp;&amp;m)</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;кол-во&nbsp;столбцов&nbsp;первой&nbsp;матрицы&nbsp;кол-во&nbsp;строк&nbsp;в&nbsp;переданной&nbsp;матрице</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;cols1=Cols();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;rows2=m.Rows();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;rows1=Rows();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;cols2=m.Cols();</span><br> <span style="color: #999999;">//---&nbsp;матрица&nbsp;для&nbsp;получения&nbsp;результата&nbsp;сложения&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;CMatrix&nbsp;res(rows1);</span><br> <span style="color: #999999;">//---&nbsp;матрицы&nbsp;должны&nbsp;быть&nbsp;согласованы</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(cols1!=rows2)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;нельзя&nbsp;произвести&nbsp;умножение</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">__FUNCSIG__</span><span>,</span><span style="color: #008080;">":&nbsp;Ошибка&nbsp;умножения&nbsp;двух&nbsp;матриц,&nbsp;формат&nbsp;не&nbsp;согласован&nbsp;"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"-&nbsp;число&nbsp;столбцов&nbsp;в&nbsp;первом&nbsp;сомножителе&nbsp;должно&nbsp;быть&nbsp;равно&nbsp;числу&nbsp;строк&nbsp;во&nbsp;втором"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(res);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;вспомогательный&nbsp;массив</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;arr[];</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(arr,cols1);</span><br> <span style="color: #999999;">//---&nbsp;заполняем&nbsp;строки&nbsp;в&nbsp;матрице&nbsp;произведения</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;rows1;i++)</span><span style="color: #999999;">//&nbsp;перебираем&nbsp;строки</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;обнулим&nbsp;массив-приемник</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayInitialize</span><span>(arr,0);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;перебираем&nbsp;элементы&nbsp;в&nbsp;строке</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;k=0;k&lt;cols1;k++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;возьмем&nbsp;из&nbsp;матрицы&nbsp;m&nbsp;значения&nbsp;к-го&nbsp;столбца&nbsp;в&nbsp;виде&nbsp;строки&nbsp;Crow</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CRow&nbsp;column=m.GetColumnAsRow(k);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;перемножим&nbsp;две&nbsp;строки&nbsp;и&nbsp;запишем&nbsp;результат&nbsp;скалярного&nbsp;умножения&nbsp;векторов&nbsp;в&nbsp;i-ый&nbsp;элемент</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr[k]=</span><span style="color: #0000ff;">this</span><span>[i]*column;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #999999;">//---&nbsp;поместим&nbsp;массив&nbsp;arr[]&nbsp;в&nbsp;i-ую&nbsp;строку&nbsp;матрицы</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[i]=arr;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;вернем&nbsp;произведение&nbsp;двух&nbsp;матриц</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(res);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Операция&nbsp;присваивания&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span>CMatrix&nbsp;*CMatrix::</span><span style="color: #0000ff;">operator</span><span>=(</span><span style="color: #0000ff;">const</span><span>&nbsp;CMatrix&nbsp;&amp;m)</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #999999;">//---&nbsp;узнаем&nbsp;и&nbsp;зададим&nbsp;количество&nbsp;строк&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;rows=m.Rows();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(m_rows,rows);</span><br> <span style="color: #999999;">//---&nbsp;заполним&nbsp;наши&nbsp;строки&nbsp;значениями&nbsp;строк&nbsp;переданной&nbsp;матрицы</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;rows;i++)&nbsp;</span><span style="color: #0000ff;">this</span><span>[i]=m[i];</span><br> <span style="color: #999999;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">GetPointer</span><span>(</span><span style="color: #0000ff;">this</span><span>));</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #999999;">//|&nbsp;Строковое&nbsp;представление&nbsp;матрицы&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #999999;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;CMatrix::</span><span style="color: #0000ff;">String</span><span>(</span><span style="color: #0000ff;">void</span><span>)&nbsp;</span><span style="color: #0000ff;">const</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;out=</span><span style="color: #008080;">""</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;rows=Rows();</span><br> <span style="color: #999999;">//---&nbsp;формируем&nbsp;построчно</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;rows;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out=out+</span><span style="color: #0000ff;">this</span><span>[i].</span><span style="color: #0000ff;">String</span><span>()+</span><span style="color: #008080;">"\r\n"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #999999;">//---&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(out);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Смотри также</span></p> 
<p><span><a href="/basis/oop/overload">Перегрузка</a>, <a href="/basis/operations/mathoperation">Арифметические операции</a>, <a href="/basis/function/functionoverload">Перегрузка функций</a>, <a href="/basis/operations/rules">Приоритеты и порядок операций</a></span></p>
<br>