<h1>FileMove</h1> 
<p><span>Перемещает файл из локальной или общей папки в другую папку.</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>bool&nbsp;&nbsp;</span><span>FileMove</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string</span><span>&nbsp;&nbsp;</span><span>src_file_name</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;имя&nbsp;файла&nbsp;для&nbsp;операции&nbsp;перемещения</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>common_flag</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;расположение&nbsp;файла</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string</span><span>&nbsp;&nbsp;</span><span>dst_file_name</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;имя&nbsp;файла&nbsp;назначения</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>mode_flags</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;способ&nbsp;доступа&nbsp;и/или&nbsp;расположение&nbsp;файла</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Параметры</span></p> 
<p><span>src_file_name</span></p> 
<p><span>[in] &nbsp;Имя файла для перемещения/переименования.</span></p> 
<p><span>common_flag</span></p> 
<p><span>[in] <a href="/constants/io_constants/fileflags">Флаг</a>, определяющий местоположение файла. Если common_flag=FILE_COMMON, то файл находится в общей папке всех клиентских терминалов \Terminal\Common\Files. В противном случае файл находится в локальной папке (</span><span>common_flag=0</span><span>).</span></p>
<p><span>dst_file_name</span></p> 
<p><span>[in] &nbsp;Имя результатного файла.</span></p> 
<p><span>mode_flags</span></p> 
<p><span>[in] <a href="/constants/io_constants/fileflags">Флаги доступа</a>. Параметр может содержать только 2 флага: FILE_REWRITE и/или FILE_COMMON - остальные флаги игнорируются. Если файл уже существует и при этом не был указан флаг FILE_REWRITE, то файл не будет переписан, и функция возвратит false.</span></p>
<p><span>Возвращаемое значение</span></p> 
<p><span>В случае неудачи функция возвращает false.</span></p> 
<p><span>Примечание</span></p> 
<p><span>Из соображений безопасности в языке MQL4 строго контролируется работа с файлами. Файлы, с которыми проводятся файловые операции средствами языка MQL4, не могут находиться за пределами файловой "песочницы".</span></p> 
<p><span>Если новый файл существовал, то копирование будет производиться в зависимости от наличия флага FILE_REWRITE в значении параметра mode_flags.</span></p> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;покажем&nbsp;окно&nbsp;входных&nbsp;параметров&nbsp;при&nbsp;запуске&nbsp;скрипта</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">script_show_inputs</span><br> <span style="color: #808080;">//---&nbsp;входные&nbsp;параметры</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpSrcName</span><span>=</span><span style="color: #008080;">"data.txt"</span><span>;</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpDstName</span><span>=</span><span style="color: #008080;">"newdata.txt"</span><span>;</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpSrcDirectory</span><span>=</span><span style="color: #008080;">"SomeFolder"</span><span>;</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpDstDirectory</span><span>=</span><span style="color: #008080;">"OtherFolder"</span><span>;</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;local=</span><span style="color: #0000ff;">TerminalInfoString</span><span>(</span><span style="color: #0000ff;">TERMINAL_DATA_PATH</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;common=</span><span style="color: #0000ff;">TerminalInfoString</span><span>(</span><span style="color: #0000ff;">TERMINAL_COMMONDATA_PATH</span><span>);</span><br> <span style="color: #808080;">//---&nbsp;получим&nbsp;пути&nbsp;к&nbsp;файлам</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;src_path=</span><span style="color: #800000;">InpSrcDirectory</span><span>+</span><span style="color: #008080;">"//"</span><span>+</span><span style="color: #800000;">InpSrcName</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;dst_path=</span><span style="color: #800000;">InpDstDirectory</span><span>+</span><span style="color: #008080;">"//"</span><span>+</span><span style="color: #800000;">InpDstName</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;проверим,&nbsp;существуют&nbsp;ли&nbsp;файл&nbsp;источника&nbsp;(если&nbsp;нет&nbsp;-&nbsp;выход)</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileIsExist</span><span>(src_path))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"%s&nbsp;file&nbsp;exists&nbsp;in&nbsp;the&nbsp;%s\\Files\\%s&nbsp;folder"</span><span>,</span><span style="color: #800000;">InpSrcName</span><span>,local,</span><span style="color: #800000;">InpSrcDirectory</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Error,&nbsp;%s&nbsp;source&nbsp;file&nbsp;not&nbsp;found"</span><span>,</span><span style="color: #800000;">InpSrcName</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;проверим,&nbsp;существует&nbsp;ли&nbsp;уже&nbsp;файл&nbsp;результата</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileIsExist</span><span>(dst_path,</span><span style="color: #0000ff;">FILE_COMMON</span><span>))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"%s&nbsp;file&nbsp;exists&nbsp;in&nbsp;the&nbsp;%s\\Files\\%s&nbsp;folder"</span><span>,</span><span style="color: #800000;">InpDstName</span><span>,common,</span><span style="color: #800000;">InpDstDirectory</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;файл&nbsp;существует,&nbsp;перемещение&nbsp;нужно&nbsp;проводить&nbsp;с&nbsp;флагом&nbsp;FILE_REWRITE</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileMove</span><span>(src_path,0,dst_path,</span><span style="color: #0000ff;">FILE_COMMON</span><span>|</span><span style="color: #0000ff;">FILE_REWRITE</span><span>))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"%s&nbsp;file&nbsp;moved"</span><span>,</span><span style="color: #800000;">InpSrcName</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Error!&nbsp;Code&nbsp;=&nbsp;%d"</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"%s&nbsp;file&nbsp;does&nbsp;not&nbsp;exist&nbsp;in&nbsp;the&nbsp;%s\\Files\\%s&nbsp;folder"</span><span>,</span><span style="color: #800000;">InpDstName</span><span>,common,</span><span style="color: #800000;">InpDstDirectory</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;файл&nbsp;не&nbsp;существует,&nbsp;перемещение&nbsp;нужно&nbsp;проводить&nbsp;без&nbsp;флага&nbsp;FILE_REWRITE</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileMove</span><span>(src_path,0,dst_path,</span><span style="color: #0000ff;">FILE_COMMON</span><span>))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"%s&nbsp;file&nbsp;moved"</span><span>,</span><span style="color: #800000;">InpSrcName</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Error!&nbsp;Code&nbsp;=&nbsp;%d"</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;теперь&nbsp;файл&nbsp;перемещен,&nbsp;проверим&nbsp;это</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileIsExist</span><span>(dst_path,</span><span style="color: #0000ff;">FILE_COMMON</span><span>)&nbsp;&amp;&amp;&nbsp;!</span><span style="color: #0000ff;">FileIsExist</span><span>(src_path,0))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Success!"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Error!"</span><span>);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Смотри также</span></p> 
<p><span><a href="/files/fileisexist">FileIsExist()</a></span></p>
<br>