<h1>FileCopy</h1> 
<p><span>Копирует исходный файл из локальной или общей папки в другой файл.</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>bool&nbsp;&nbsp;</span><span>FileCopy</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string</span><span>&nbsp;&nbsp;</span><span>src_file_name</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;имя&nbsp;файла&nbsp;источника</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>common_flag</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;расположение&nbsp;файла</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>const&nbsp;string</span><span>&nbsp;&nbsp;</span><span>dst_file_name</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;имя&nbsp;файла&nbsp;назначения</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>mode_flags</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;способ&nbsp;доступа&nbsp;и/или&nbsp;расположение&nbsp;файла</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Параметры</span></p> 
<p><span>src_file_name</span></p> 
<p><span>[in] &nbsp;Имя файла для копирования.</span></p> 
<p><span>common_flag</span></p> 
<p><span>[in] <a href="/constants/io_constants/fileflags">Флаг</a>, определяющий местоположение файла. Если common_flag=FILE_COMMON, то файл находится в общей папке всех клиентских терминалов \Terminal\Common\Files. В противном случае файл находится в локальной папке (например, </span><span>common_flag=0</span><span>).</span></p>
<p><span>dst_file_name</span></p> 
<p><span>[in] &nbsp;Имя результатного файла.</span></p> 
<p><span>mode_flags</span></p> 
<p><span>[in] <a href="/constants/io_constants/fileflags">Флаги доступа</a>. Параметр может содержать только 2 флага: FILE_REWRITE и/или FILE_COMMON - остальные флаги игнорируются. Если файл уже существует и при этом не был указан флаг FILE_REWRITE, то файл не будет переписан, и функция возвратит false.</span></p>
<p><span>Возвращаемое значение</span></p> 
<p><span>В случае неудачи функция возвращает false.</span></p> 
<p><span>Примечание</span></p> 
<p><span>Из соображений безопасности в языке MQL4 строго контролируется работа с файлами. Файлы, с которыми проводятся файловые операции средствами языка MQL4, не могут находиться за пределами файловой "песочницы".</span></p> 
<p><span>Если новый файл существовал, то копирование будет производиться в зависимости от наличия флага FILE_REWRITE в значении параметра mode_flags.</span></p> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;покажем&nbsp;окно&nbsp;входных&nbsp;параметров&nbsp;при&nbsp;запуске&nbsp;скрипта</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">script_show_inputs</span><br> <span style="color: #808080;">//---&nbsp;входные&nbsp;параметры</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpSrc</span><span>=</span><span style="color: #008080;">"source.txt"</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;источник</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;</span><span style="color: #800000;">InpDst</span><span>=</span><span style="color: #008080;">"destination.txt"</span><span>;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;копия</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800000;">InpEncodingType</span><span>=</span><span style="color: #0000ff;">FILE_ANSI</span><span>;&nbsp;</span><span style="color: #808080;">//&nbsp;ANSI=32&nbsp;или&nbsp;UNICODE=64</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;отобразим&nbsp;содержимое&nbsp;источника&nbsp;(он&nbsp;должен&nbsp;существовать)</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!FileDisplay(</span><span style="color: #800000;">InpSrc</span><span>))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;проверим,&nbsp;существует&nbsp;ли&nbsp;уже&nbsp;файл&nbsp;копии&nbsp;(не&nbsp;обязан&nbsp;быть&nbsp;создан)</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!FileDisplay(</span><span style="color: #800000;">InpDst</span><span>))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;файл&nbsp;копии&nbsp;не&nbsp;существует,&nbsp;копирование&nbsp;без&nbsp;флага&nbsp;FILE_REWRITE&nbsp;(правильное&nbsp;копирование)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileCopy</span><span>(</span><span style="color: #800000;">InpSrc</span><span>,0,</span><span style="color: #800000;">InpDst</span><span>,0))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"File&nbsp;is&nbsp;copied!"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"File&nbsp;is&nbsp;not&nbsp;copied!"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;файл&nbsp;копии&nbsp;уже&nbsp;существует,&nbsp;попробуем&nbsp;скопировать&nbsp;без&nbsp;флага&nbsp;FILE_REWRITE&nbsp;(неправильное&nbsp;копирование)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileCopy</span><span>(</span><span style="color: #800000;">InpSrc</span><span>,0,</span><span style="color: #800000;">InpDst</span><span>,0))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"File&nbsp;is&nbsp;copied!"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"File&nbsp;is&nbsp;not&nbsp;copied!"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;содержимое&nbsp;файла&nbsp;InpDst&nbsp;останется&nbsp;прежним</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileDisplay(</span><span style="color: #800000;">InpDst</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;скопируем&nbsp;еще&nbsp;раз&nbsp;с&nbsp;флагом&nbsp;FILE_REWRITE&nbsp;(правильное&nbsp;копирование&nbsp;при&nbsp;существовании&nbsp;файла)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">FileCopy</span><span>(</span><span style="color: #800000;">InpSrc</span><span>,0,</span><span style="color: #800000;">InpDst</span><span>,</span><span style="color: #0000ff;">FILE_REWRITE</span><span>))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"File&nbsp;is&nbsp;copied!"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"File&nbsp;is&nbsp;not&nbsp;copied!"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;получили&nbsp;копию&nbsp;файла&nbsp;InpSrc</span><br> <span>&nbsp;&nbsp;&nbsp;FileDisplay(</span><span style="color: #800000;">InpDst</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Чтение&nbsp;содержимого&nbsp;файла&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;FileDisplay(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;file_name)</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;сбросим&nbsp;значение&nbsp;ошибки</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span style="color: #808080;">//---&nbsp;откроем&nbsp;файл</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;file_handle=</span><span style="color: #0000ff;">FileOpen</span><span>(file_name,</span><span style="color: #0000ff;">FILE_READ</span><span>|</span><span style="color: #0000ff;">FILE_TXT</span><span>|</span><span style="color: #800000;">InpEncodingType</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(file_handle!=</span><span style="color: #0000ff;">INVALID_HANDLE</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;отобразим&nbsp;в&nbsp;цикле&nbsp;содержимое&nbsp;файла</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"+---------------------+"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"File&nbsp;name&nbsp;=&nbsp;%s"</span><span>,file_name);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">while</span><span>(!</span><span style="color: #0000ff;">FileIsEnding</span><span>(file_handle))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">FileReadString</span><span>(file_handle));</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"+---------------------+"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;закроем&nbsp;файл</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">FileClose</span><span>(file_handle);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">true</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;не&nbsp;удалось&nbsp;открыть&nbsp;файл</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"%s&nbsp;is&nbsp;not&nbsp;opened,&nbsp;error&nbsp;=&nbsp;%d"</span><span>,file_name,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<br>