<h1>EventChartCustom</h1> 
<p><span>Генерирует пользовательское событие для указанного графика.</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>bool&nbsp;&nbsp;</span><span>EventChartCustom</span><span>(</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>long</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>chart_id</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;идентификатор&nbsp;графика-получателя&nbsp;события</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>ushort</span><span>&nbsp;&nbsp;</span><span>custom_event_id</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;идентификатор&nbsp;события</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>long</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>lparam</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;параметр&nbsp;типа&nbsp;long</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>double</span><span>&nbsp;&nbsp;</span><span>dparam</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;параметр&nbsp;типа&nbsp;double</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span>string</span><span>&nbsp;&nbsp;</span><span>sparam</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//&nbsp;строковый&nbsp;параметр&nbsp;события</span><br> <span>&nbsp;&nbsp;&nbsp;);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Параметры</span></p> 
<p><span>chart_id</span></p> 
<p><span>[in] &nbsp;Идентификатор графика. 0 означает текущий график.</span></p> 
<p><span>custom_event_id</span></p> 
<p><span>[in] &nbsp;Идентификатор пользовательского события. Этот идентификатор автоматически добавляется к значению <a href="/constants/chartconstants/enum_chartevents">CHARTEVENT_CUSTOM</a> и преобразуется к целому типу.</span></p>
<p><span>lparam</span></p> 
<p><span>[in] &nbsp;Параметр события типа long, передаваемый функции <a href="/basis/function/events#onchartevent">OnChartEvent</a>.</span></p>
<p><span>dparam</span></p> 
<p><span>[in] &nbsp;Параметр события типа double, передаваемый функции OnChartEvent.</span></p> 
<p><span>sparam</span></p> 
<p><span>[in] &nbsp;Параметр события типа string, передаваемый функции OnChartEvent. Если строка имеет длину больше, чем 63 символа, то строка усекается.</span></p> 
<p><span>Возвращаемое значение</span></p> 
<p><span>Возвращает true в случае удачной постановки пользовательского события в очередь событий графика – получателя события. В случае ошибки возвращает false, для получения кода ошибки используйте <a href="/check/getlasterror">GetLastError()</a>.</span></p>
<p><span>Примечание</span></p> 
<p><span>Эксперт или индикатор, прикрепленный к указанному графику, обрабатывает данное событие при помощи функции <a href="/basis/function/events#onchartevent">OnChartEvent</a>(int event_id, long&amp; lparam, double&amp; dparam, string&amp; sparam).</span></p>
<p><span>Для каждого типа события входные параметры функции OnChartEvent() имеют определенные значения, которые необходимы для обработки этого события. В таблице перечислены события и значения, которые передаются через параметры.</span></p> 
<div style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 8px 17px 7px 17px;"> 
 <table cellpadding="5" border="1" style="border:solid 2px #b1c2d6; border-spacing:0px; border-collapse:collapse;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; background-color:#dbe9f9; padding:5px; border:solid thin #b1c2d6;"><p><span style="font-weight: bold;">Событие</span></p> </td> 
    <td style="vertical-align:top; background-color:#dbe9f9; padding:5px; border:solid thin #b1c2d6;"><p><span style="font-weight: bold;">Значение параметра id</span></p> </td> 
    <td style="vertical-align:top; background-color:#dbe9f9; padding:5px; border:solid thin #b1c2d6;"><p><span style="font-weight: bold;">Значение параметра lparam</span></p> </td> 
    <td style="vertical-align:top; background-color:#dbe9f9; padding:5px; border:solid thin #b1c2d6;"><p><span style="font-weight: bold;">Значение параметра dparam</span></p> </td> 
    <td style="vertical-align:top; background-color:#dbe9f9; padding:5px; border:solid thin #b1c2d6;"><p><span style="font-weight: bold;">Значение параметра &nbsp;sparam</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Событие нажатия клавиатуры</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_KEYDOWN</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>код нажатой клавиши</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Количество нажатий клавиши,сгенерированных за время её удержания в нажатом состоянии</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Строковое значение битовой маски, описывающее статус кнопок клавиатуры</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>События мыши </span><span>(если для графика установлено свойство <a href="/constants/chartconstants/enum_chart_property#enum_chart_property_integer">CHART_EVENT_MOUSE_MOVE</a>=true)</span></p> </td>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_MOUSE_MOVE</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>X координата</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Y координата</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Строковое значение битовой маски, описывающее статус кнопок мыши</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Событие создания графического объекта (если для графика установлено свойство <a href="/constants/chartconstants/enum_chart_property#enum_chart_property_integer">CHART_EVENT_OBJECT_CREATE</a>=true)</span></p> </td>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_OBJECT_CREATE</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Имя созданного графического объекта</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Событие изменения свойств объекта через диалог свойств</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_OBJECT_CHANGE</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Имя измененного графического объекта</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Событие удаления графического объекта (если для графика установлено свойство <a href="/constants/chartconstants/enum_chart_property#enum_chart_property_integer">CHART_EVENT_OBJECT_DELETE</a>=true)</span></p> </td>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_OBJECT_DELETE</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Имя удаленного графического объекта</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Событие щелчка мыши на графике</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_CLICK</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>X координата</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Y координата</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Событие щелчка мыши на графическом объекте</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_OBJECT_CLICK</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>X координата</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Y координата</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Имя графического объекта, на котором произошло событие</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Событие перемещения графического объекта при помощи мыши</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_OBJECT_DRAG</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Имя перемещенного графического объекта</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Событие окончания редактирования текста в поле ввода графического объекта "Поле ввода"</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_OBJECT_ENDEDIT</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Имя графического объекта "Поле ввода", в котором завершилось редактирование текста</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Событие изменения графика</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_CHART_CHANGE</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>—</span></p> </td> 
   </tr> 
   <tr>
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Пользовательское событие с номером N</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>CHARTEVENT_CUSTOM+N</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Значение, заданное функцией EventChartCustom()</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Значение, заданное функцией EventChartCustom()</span></p> </td> 
    <td style="vertical-align:top; padding:5px; border:solid thin #b1c2d6;"><p><span>Значение, заданное функцией EventChartCustom()</span></p> </td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span style="font-weight: bold;">Пример:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ButtonClickExpert.mq5&nbsp;|</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright&nbsp;2009,&nbsp;MetaQuotes&nbsp;Software&nbsp;Corp.&nbsp;|</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://www.mql5.com&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">copyright</span><span>&nbsp;</span><span style="color: #008080;">"2009,&nbsp;MetaQuotes&nbsp;Software&nbsp;Corp."</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">link</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"https://www.mql5.com"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">version</span><span>&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">"1.00"</span><br> <span style="color: #008080;">&nbsp;</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;buttonID=</span><span style="color: #008080;">"Button"</span><span>;</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;labelID=</span><span style="color: #008080;">"Info"</span><span>;</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;broadcastEventID=5000;</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Expert&nbsp;initialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;</span><span style="color: #0000ff;">OnInit</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;создадим&nbsp;кнопку,&nbsp;для&nbsp;передачи&nbsp;пользовательских&nbsp;событий</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectCreate</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJ_BUTTON</span><span>,0,100,100);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_COLOR</span><span>,</span><span style="color: #0000ff;">clrWhite</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_BGCOLOR</span><span>,</span><span style="color: #0000ff;">clrGray</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_XDISTANCE</span><span>,100);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_YDISTANCE</span><span>,100);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_XSIZE</span><span>,200);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_YSIZE</span><span>,50);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetString</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_FONT</span><span>,</span><span style="color: #008080;">"Arial"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetString</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_TEXT</span><span>,</span><span style="color: #008080;">"Кнопка"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_FONTSIZE</span><span>,10);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_SELECTABLE</span><span>,0);</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;создадим&nbsp;метку&nbsp;для&nbsp;вывода&nbsp;информации</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectCreate</span><span>(0,labelID,</span><span style="color: #0000ff;">OBJ_LABEL</span><span>,0,100,100);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,labelID,</span><span style="color: #0000ff;">OBJPROP_COLOR</span><span>,</span><span style="color: #0000ff;">clrRed</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,labelID,</span><span style="color: #0000ff;">OBJPROP_XDISTANCE</span><span>,100);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,labelID,</span><span style="color: #0000ff;">OBJPROP_YDISTANCE</span><span>,50);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetString</span><span>(0,labelID,</span><span style="color: #0000ff;">OBJPROP_FONT</span><span>,</span><span style="color: #008080;">"Trebuchet&nbsp;MS"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetString</span><span>(0,labelID,</span><span style="color: #0000ff;">OBJPROP_TEXT</span><span>,</span><span style="color: #008080;">"Нет&nbsp;информации"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,labelID,</span><span style="color: #0000ff;">OBJPROP_FONTSIZE</span><span>,20);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,labelID,</span><span style="color: #0000ff;">OBJPROP_SELECTABLE</span><span>,0);</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">INIT_SUCCEEDED</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Expert&nbsp;deinitialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnDeinit</span><span>(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;reason)</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectDelete</span><span>(0,buttonID);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectDelete</span><span>(0,labelID);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Expert&nbsp;tick&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnTick</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---</span><br> <span style="color: #808080;">&nbsp;</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnChartEvent</span><span>(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;id,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;&amp;lparam,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;&amp;dparam,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&amp;sparam)</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;проверим&nbsp;событие&nbsp;на&nbsp;нажатие&nbsp;кнопки&nbsp;мышки</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(id==</span><span style="color: #0000ff;">CHARTEVENT_OBJECT_CLICK</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;clickedChartObject=sparam;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;если&nbsp;нажатие&nbsp;на&nbsp;объекте&nbsp;с&nbsp;именем&nbsp;buttonID</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(clickedChartObject==buttonID)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;состояние&nbsp;кнопки&nbsp;-&nbsp;нажата&nbsp;кнопка&nbsp;или&nbsp;нет</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;selected=</span><span style="color: #0000ff;">ObjectGetInteger</span><span>(0,buttonID,</span><span style="color: #0000ff;">OBJPROP_STATE</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;выведем&nbsp;в&nbsp;лог&nbsp;отладочное&nbsp;сообщение</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Кнопка&nbsp;нажата&nbsp;=&nbsp;"</span><span>,selected);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;customEventID;&nbsp;</span><span style="color: #808080;">//&nbsp;номер&nbsp;пользовательского&nbsp;события&nbsp;для&nbsp;отправки</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;message;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;сообщение&nbsp;для&nbsp;отправки&nbsp;в&nbsp;событии</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;если&nbsp;кнопка&nbsp;нажата</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(selected)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message=</span><span style="color: #008080;">"Кнопка&nbsp;нажата"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customEventID=</span><span style="color: #0000ff;">CHARTEVENT_CUSTOM</span><span>+1;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><span>&nbsp;</span><span style="color: #808080;">//&nbsp;кнопка&nbsp;не&nbsp;нажата</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message=</span><span style="color: #008080;">"Кнопка&nbsp;отжата"</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customEventID=</span><span style="color: #0000ff;">CHARTEVENT_CUSTOM</span><span>+999;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;отправим&nbsp;пользовательское&nbsp;событие&nbsp;"своему"графику</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">EventChartCustom</span><span>(0,customEventID-</span><span style="color: #0000ff;">CHARTEVENT_CUSTOM</span><span>,0,0,message);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;отправим&nbsp;сообщение&nbsp;всем&nbsp;открытым&nbsp;графикам</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BroadcastEvent(</span><span style="color: #0000ff;">ChartID</span><span>(),0,</span><span style="color: #008080;">"Broadcast&nbsp;Message"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;отладочное&nbsp;сообщение</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Отправлено&nbsp;событие&nbsp;с&nbsp;ID&nbsp;=&nbsp;"</span><span>,customEventID);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ChartRedraw</span><span>();</span><span style="color: #808080;">//&nbsp;принудительно&nbsp;перерисуем&nbsp;все&nbsp;объекты&nbsp;на&nbsp;графике</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;проверим&nbsp;событие&nbsp;на&nbsp;принадлежность&nbsp;к&nbsp;пользовательским&nbsp;событиям</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(id&gt;</span><span style="color: #0000ff;">CHARTEVENT_CUSTOM</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(id==broadcastEventID)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Получили&nbsp;широковещательное&nbsp;сообщение&nbsp;от&nbsp;графика&nbsp;с&nbsp;id&nbsp;=&nbsp;"</span><span>+lparam);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;прочитаем&nbsp;текстовое&nbsp;сообщение&nbsp;в&nbsp;событии</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;info=sparam;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Обрабатывается&nbsp;ПОЛЬЗОВАТЕЛЬСКОЕ&nbsp;событие&nbsp;с&nbsp;ID&nbsp;=&nbsp;"</span><span>,id);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;выведем&nbsp;сообщение&nbsp;в&nbsp;метке</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetString</span><span>(0,labelID,</span><span style="color: #0000ff;">OBJPROP_TEXT</span><span>,sparam);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ChartRedraw</span><span>();</span><span style="color: #808080;">//&nbsp;принудительно&nbsp;перерисуем&nbsp;все&nbsp;объекты&nbsp;на&nbsp;графике</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;послать&nbsp;широковещательное&nbsp;сообщение&nbsp;всем&nbsp;открытым&nbsp;графикам&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;BroadcastEvent(</span><span style="color: #0000ff;">long</span><span>&nbsp;lparam,</span><span style="color: #0000ff;">double</span><span>&nbsp;dparam,</span><span style="color: #0000ff;">string</span><span>&nbsp;sparam)</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;eventID=broadcastEventID-</span><span style="color: #0000ff;">CHARTEVENT_CUSTOM</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;currChart=</span><span style="color: #0000ff;">ChartFirst</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">while</span><span>(i&lt;</span><span style="color: #0000ff;">CHARTS_MAX</span><span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;у&nbsp;нас&nbsp;наверняка&nbsp;не&nbsp;больше&nbsp;CHARTS_MAX&nbsp;открытых&nbsp;графиков</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">EventChartCustom</span><span>(currChart,eventID,lparam,dparam,sparam);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currChart=</span><span style="color: #0000ff;">ChartNext</span><span>(currChart);&nbsp;</span><span style="color: #808080;">//&nbsp;на&nbsp;основании&nbsp;предыдущего&nbsp;получим&nbsp;новый&nbsp;график</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(currChart==-1)&nbsp;</span><span style="color: #0000ff;">break</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;достигли&nbsp;конца&nbsp;списка&nbsp;графиков</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;не&nbsp;забудем&nbsp;увеличить&nbsp;счетчик</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Смотри также</span></p> 
<p><span><a href="/runtime/event_fire">События клиентского терминала</a>, <a href="/basis/function/events">Функции обработки событий</a></span></p>
<br>