<h1>Ресурсы</h1> 
<h2>Использование графики и звука в программах на MQL4</h2> 
<p><span>Программы на MQL4 позволяют работать со звуковыми и графическими файлами:</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span><a href="/common/playsound">PlaySound()</a> воспроизводит звуковой файл;</span></p>
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span><a href="/objects/objectcreate">ObjectCreate()</a> позволяет с помощью <a href="/constants/objectconstants/enum_object">графических объектов</a> OBJ_BITMAP и OBJ_BITMAP_LABEL создавать пользовательские интерфейсы. </span></p>
<p><span>&nbsp;</span></p> 
<h3>PlaySound()</h3> 
<p><span>Пример вызова функции </span><span><a href="/common/playsound">PlaySound()</a>:</span></p>
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Функция&nbsp;вызывает&nbsp;штатную&nbsp;OrderSend()&nbsp;и&nbsp;проигрывает&nbsp;звук&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;OrderSendWithAudio()</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;price=</span><span style="color: #0000ff;">Ask</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;размещение&nbsp;рыночного&nbsp;ордера&nbsp;на&nbsp;покупку&nbsp;1&nbsp;лота&nbsp;текущего&nbsp;символа</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;ticket=</span><span style="color: #0000ff;">OrderSend</span><span>(</span><span style="color: #0000ff;">Symbol</span><span>(),</span><span style="color: #0000ff;">OP_BUY</span><span>,1,price,3,0,0,</span><span style="color: #008080;">"My&nbsp;order"</span><span>,16384,0,</span><span style="color: #0000ff;">clrGreen</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(ticket&lt;0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Вызов&nbsp;OrderSend&nbsp;завершился&nbsp;с&nbsp;ошибкой&nbsp;#"</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;при&nbsp;ошибке&nbsp;проигрывает&nbsp;звук&nbsp;из&nbsp;файла&nbsp;&nbsp;timeout.wav</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PlaySound</span><span>(</span><span style="color: #008080;">"timeout.wav"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Ордер&nbsp;успешно&nbsp;размещен"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;при&nbsp;удачном&nbsp;размещении&nbsp;ордера&nbsp;проигрывает&nbsp;звук&nbsp;из&nbsp;файла&nbsp;Ok.wav&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PlaySound</span><span>(</span><span style="color: #008080;">"Ok.wav"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>В данном примере показано как проигрывать звуки из файлов Ok.wav и timeoit.wav, входящих в стандартную поставку терминала. Эти файлы находятся в папке </span><span style="font-weight: bold;">каталог_терминала\Sounds</span><span>. Здесь </span><span style="font-weight: bold;">каталог_терминала</span><span> означает папку, из которой запущен клиентский терминал MetaTrader 4. &nbsp;Программным путем из mql4-программы каталог терминала можно узнать следующим образом:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;Папка,&nbsp;в&nbsp;которой&nbsp;хранятся&nbsp;данные&nbsp;терминала</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;terminal_path=</span><span style="color: #0000ff;">TerminalInfoString</span><span>(</span><span style="color: #0000ff;">TERMINAL_PATH</span><span>);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Можно использовать звуковые файлы не только из папки </span><span style="font-weight: bold;">каталог_терминала\Sounds</span><span>, но и из любой подпапки, находящейся в папке </span><span style="font-weight: bold;">каталог_данных_терминала\MQL4. </span><span>Расположение каталога данных терминала на компьютере можно выяснить через меню терминала "Файл"-"Открыть каталог данных" или программным путем:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;Папка,&nbsp;в&nbsp;которой&nbsp;хранятся&nbsp;данные&nbsp;терминала</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;terminal_data_path=</span><span style="color: #0000ff;">TerminalInfoString</span><span>(</span><span style="color: #0000ff;">TERMINAL_DATA_PATH</span><span>);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Например, если звуковой файл Demo.wav лежит в папке каталог_данных_терминала\MQL4\Files, то вызов PlaySound() должен быть записан таким образом:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;проиграем&nbsp;звуковой&nbsp;файл&nbsp;Demo.wav&nbsp;из&nbsp;папки&nbsp;каталог_данных_терминала\MQL4\Files\Demo.wav</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PlaySound</span><span>(</span><span style="color: #008080;">"\\Files\\Demo.wav"</span><span>);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Обратите внимание на то, что в комментарии путь к файлу написан с использованием символа "\", а в самой функции для разделения папок в пути используется последовательность "\\".</span></p> 
<p><span>При указании пути всегда используйте только двойную обратную косую черту в качестве разделителя, так как одиночная обратная черта является управляющим символом для компилятора при разборе константных строк и <a href="/basis/types/integer/symbolconstants">символьных констант</a> в исходном коде программы. </span></p>
<p><span>Для остановки воспроизведения файла нужно вызвать функцию <a href="/common/playsound">PlaySound()</a> с параметром NULL:</span></p>
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;вызов&nbsp;PlaySound&nbsp;с&nbsp;параметром&nbsp;NULL&nbsp;останавливает&nbsp;воспроизведение&nbsp;звука</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PlaySound</span><span>(</span><span style="color: #0000ff;">NULL</span><span>);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>&nbsp;</span></p> 
<h3>ObjectCreate()</h3> 
<p><span>Пример эксперта, который с помощью функции &nbsp;ObjectCreate() создает объект "Графическая метка" (OBJ_BITMAP_LABEL).</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">string</span><span>&nbsp;label_name=</span><span style="color: #008080;">"currency_label"</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;объекта&nbsp;OBJ_BITMAP_LABEL&nbsp;</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;euro&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</span><span style="color: #008080;">"\\Images\\euro.bmp"</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;путь&nbsp;к&nbsp;файлу&nbsp;каталог_данных_терминала\MQL4\Images\euro.bmp</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;dollar&nbsp;&nbsp;&nbsp;&nbsp;=</span><span style="color: #008080;">"\\Images\\dollar.bmp"</span><span>;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;путь&nbsp;к&nbsp;файлу&nbsp;каталог_данных_терминала\MQL4\Images\dollar.bmp</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Expert&nbsp;initialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;</span><span style="color: #0000ff;">OnInit</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;создадим&nbsp;кнопку&nbsp;OBJ_BITMAP_LABEL,&nbsp;если&nbsp;ее&nbsp;еще&nbsp;нет</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">ObjectFind</span><span>(0,label_name)&lt;0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;попробуем&nbsp;создать&nbsp;объект&nbsp;OBJ_BITMAP_LABEL</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;created=</span><span style="color: #0000ff;">ObjectCreate</span><span>(0,label_name,</span><span style="color: #0000ff;">OBJ_BITMAP_LABEL</span><span>,0,0,0);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(created)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;привяжем&nbsp;кнопку&nbsp;к&nbsp;правому&nbsp;верхнему&nbsp;углу&nbsp;графика</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,label_name,</span><span style="color: #0000ff;">OBJPROP_CORNER</span><span>,</span><span style="color: #0000ff;">CORNER_RIGHT_UPPER</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;теперь&nbsp;настроим&nbsp;свойства&nbsp;объекта</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,label_name,</span><span style="color: #0000ff;">OBJPROP_XDISTANCE</span><span>,100);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(0,label_name,</span><span style="color: #0000ff;">OBJPROP_YDISTANCE</span><span>,50);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;сбросим&nbsp;код&nbsp;последней&nbsp;ошибки&nbsp;в&nbsp;0</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;загрузим&nbsp;картинку&nbsp;для&nbsp;состояния&nbsp;кнопки&nbsp;"Нажата"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;set=</span><span style="color: #0000ff;">ObjectSetString</span><span>(0,label_name,</span><span style="color: #0000ff;">OBJPROP_BMPFILE</span><span>,0,euro);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;проверим&nbsp;результат</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!set)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Не&nbsp;удалось&nbsp;загрузить&nbsp;картинку&nbsp;из&nbsp;файла&nbsp;%s.&nbsp;Код&nbsp;ошибки&nbsp;%d"</span><span>,euro,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;загрузим&nbsp;картинку&nbsp;для&nbsp;состояния&nbsp;кнопки&nbsp;"Отжата"</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set=</span><span style="color: #0000ff;">ObjectSetString</span><span>(0,label_name,</span><span style="color: #0000ff;">OBJPROP_BMPFILE</span><span>,1,dollar);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!set)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Не&nbsp;удалось&nbsp;загрузить&nbsp;картинку&nbsp;из&nbsp;файла&nbsp;%s.&nbsp;Код&nbsp;ошибки&nbsp;%d"</span><span>,dollar,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;отдадим&nbsp;графику&nbsp;команду&nbsp;на&nbsp;обновление,&nbsp;чтобы&nbsp;кнопка&nbsp;появилась&nbsp;сразу&nbsp;же,&nbsp;не&nbsp;дожидаясь&nbsp;тика</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ChartRedraw</span><span>(0);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;объект&nbsp;создать&nbsp;не&nbsp;удалось,&nbsp;сообщим&nbsp;об&nbsp;этом</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Не&nbsp;удалось&nbsp;создать&nbsp;объект&nbsp;OBJ_BITMAP_LABEL.&nbsp;Код&nbsp;ошибки&nbsp;%d"</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">INIT_SUCCEEDED</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Expert&nbsp;deinitialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnDeinit</span><span>(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;reason)</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;удалим&nbsp;объект&nbsp;с&nbsp;графика&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectDelete</span><span>(0,label_name);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Создание и настройка графического объекта с именем currency_label происходят в</span><span> функции OnInit(). Пути к загружаемым графическим файлам заданы в <a href="/basis/variables/global">глобальных переменных</a> </span><span style="font-weight: bold;">euro</span><span> и </span><span style="font-weight: bold;">dollar</span><span>, в качестве разделителя использована двойная обратная косая черта:</span></p>
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">string</span><span>&nbsp;euro&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</span><span style="color: #008080;">"\\Images\\euro.bmp"</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;путь&nbsp;к&nbsp;файлу&nbsp;каталог_данных_терминала\MQL4\Images\euro.bmp</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;dollar&nbsp;&nbsp;&nbsp;&nbsp;=</span><span style="color: #008080;">"\\Images\\dollar.bmp"</span><span>;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;путь&nbsp;к&nbsp;файлу&nbsp;каталог_данных_терминала\MQL4\Images\dollar.bmp</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Сами файлы при этом находятся в папке </span><span style="font-weight: bold;">каталог_данных_терминала\</span><span>MQL4\Images.</span></p> 
<p><span>Объект OBJ_BITMAP_LABEL фактически представляет собою кнопку, которая в зависимости от состояния (нажата или отжата) может отображать одну из двух картинок: euro.bmp или dollar.bmp.</span></p> 
<p style="text-align: center;"><img alt="Свойства объекта OBJ_BITMAP_LABEL" title="Свойства объекта OBJ_BITMAP_LABEL" width="537" height="297" style="margin:0px auto 0px auto;width:537px;height:297px;border:none" src="https://c.mql4.com/i/docs/ru/demo_create_obj_bitmap_label_ea.png"></p> 
<p><span>Размеры кнопки с графическим интерфейсом автоматически устанавливаются под размер отображаемой картинки. Смена изображения производится при нажатии левой кнопкой мышки на объекте OBJ_BITMAP_LABEL (</span><span style="font-weight: bold;">в свойствах должен быть выбрано &nbsp;"Отключить выделение"</span><span>). Объект OBJ_BITMAP создается аналогичным образом и предназначен для создания фона с требуемым рисунком. </span></p> 
<p><span>Значение свойства <a href="/constants/objectconstants/enum_object_property#enum_object_property_integer">OBJPROP_BMPFILE</a>, которое отвечает за вид объектов </span><span>OBJ_BITMAP и OBJ_BITMAP_LABEL</span><span>, можно менять динамически. Это позволяет создавать разнообразные интерактивные пользовательские интерфейсы для mql4-программ.</span></p>
<p><span>&nbsp;</span></p> 
<h2><a id="resource_include"></a>Включение ресурсов в исполняемые файлы при компиляции mql4-программ</h2> 
<p><span>Для работы mql4-программы может потребоваться множество разнообразных загружаемых ресурсов в виде файлов изображений и звуков. Для того чтобы исключить необходимость переноса всех этих файлов при передаче исполняемой программы на MQL4, следует использовать директиву компилятора </span><span style="color: #0000ff;">#resource</span><span>:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>&nbsp;</span><span style="color: #0000ff;">#resource</span><span>&nbsp;путь_к_файлу_ресурса</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Команда </span><span style="color: #0000ff;">#resource</span><span> указывает компилятору, что ресурс по указанному пути </span><span style="font-weight: bold;">путь_к_файлу_ресурса</span><span> нужно включить в исполняемый файл EX4. Таким образом, все необходимые картинки и звуки можно поместить непосредственно в EX4-файл и для запуска программы в другом терминале не потребуется передавать все используемые в ней отдельные файлы. Любой EX4-файл может содержать ресурсы, и любая EX4-программа может использовать ресурсы из другой EX4-программы.</span></p> 
<p><span>Файлы в формате BMP и WAV перед включением в исполняемый EX4 файл автоматически сжимаются. Это означает, что использование ресурсов не только позволяет создавать полноценные программы на MQL4, но и уменьшает общий размер требуемых терминалу файлов при использовании графики и звука по сравнению с обычным способом написания mql4-программ.</span></p> 
<p><span>Размер файла ресурса не может быть больше 16 Mb.</span></p> 
<p><span>&nbsp;</span></p> 
<h2>Поиск компилятором указанных ресурсов </h2> 
<p><span>Ресурс вставляется командой #resource "&lt;путь к файлу ресурса&gt;"</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>&nbsp;</span><span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"&lt;путь_к_файлу_ресурса&gt;"</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Длина константной строки &lt;путь_к_файлу_ресурса&gt; не должна превышать 63 символа.</span></p> 
<p><span>Имена всех файлов и каталогов, включаемых в ресурсы, должны быть на английском языке.</span></p> 
<p><span>Компилятор ищет ресурс по указанному пути в следующей последовательности:</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>если в начале пути стоит разделитель обратная косая черта "\" (пишется "\\"), то ресурс ищется относительно каталога </span><span style="font-weight: bold;">каталог_данных_терминала</span><span>\MQL4\,</span></p> 
<p style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 2px 17px 3px 17px;"><span style="display:inline-block;width:13px;margin-left:-13px;font-size:10pt;font-family:'Symbol';font-style:normal;color:#565656;text-decoration:none;">•</span><span>если обратной косой черты нет, то ресурс ищется относительно расположения исходного файла, в котором этот ресурс прописывается.</span></p> 
<p><span>В пути ресурса недопустимо использовать подстроки "..\\" и ":\\".</span></p> 
<p><span>Примеры включения ресурсов:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;правильное&nbsp;указание&nbsp;ресурсов</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Images\\euro.bmp"</span><span>&nbsp;</span><span style="color: #808080;">//&nbsp;euro.bmp&nbsp;находится&nbsp;в&nbsp;каталог_данных_терминала\MQL4\Images\</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"picture.bmp"</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;picture.bmp&nbsp;находится&nbsp;в&nbsp;том&nbsp;же&nbsp;каталоге,&nbsp;где&nbsp;и&nbsp;исходный&nbsp;файл</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"Resource\\map.bmp"</span><span>&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;ресурс&nbsp;находится&nbsp;в&nbsp;папке&nbsp;каталог_исходного_файла\Resource\map.bmp</span><br> <span style="color: #808080;">&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;неправильное&nbsp;указание&nbsp;ресурсов</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">":picture_2.bmp"</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;нельзя&nbsp;использовать&nbsp;":"</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"..\\picture_3.bmp"</span><span>&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;нельзя&nbsp;использовать&nbsp;".."</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Files\\Images\\Folder_First\\My_panel\\Labels\\too_long_path.bmp"</span><span>&nbsp;</span><span style="color: #808080;">//больше&nbsp;63&nbsp;символов</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>&nbsp;</span></p> 
<h2>Использование ресурсов</h2> 
<h3>Имя ресурса </h3> 
<p><span>После того как ресурс объявлен директивой </span><span style="color: #0000ff;">#resource</span><span>, его можно использовать в любой части программы. Именем ресурса становится его путь без косой черты в начале строки, задающей путь к ресурсу. Для использования своего ресурса в коде нужно перед именем ресурса добавлять специальный признак "::".</span></p> 
<p><span>Примеры:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;примеры&nbsp;указания&nbsp;ресурсов&nbsp;и&nbsp;их&nbsp;имена&nbsp;в&nbsp;комментарии</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Images\\euro.bmp"</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;ресурса&nbsp;-&nbsp;Images\euro.bmp</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"picture.bmp"</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;ресурса&nbsp;-&nbsp;picture.bmp</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"Resource\\map.bmp"</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;ресурса&nbsp;-&nbsp;Resource\map.bmp</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Files\\Pictures\\good.bmp"</span><span>&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;ресурса&nbsp;-&nbsp;Files\Pictures\good.bmp</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Files\\Demo.wav"</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;ресурса&nbsp;-&nbsp;Files\Demo.wav"</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Sounds\\thrill.wav"</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;ресурса&nbsp;-&nbsp;Sounds\thrill.wav"</span><br> <span>...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br> <span>&nbsp;</span><br> <span style="color: #808080;">//---&nbsp;использование&nbsp;ресурсов</span><br> <span style="color: #0000ff;">ObjectSetString</span><span>(0,bitmap_name,</span><span style="color: #0000ff;">OBJPROP_BMPFILE</span><span>,0,</span><span style="color: #008080;">"::Images\\euro.bmp"</span><span>);</span><br> <span>...</span><br> <span style="color: #0000ff;">ObjectSetString</span><span>(0,my_bitmap,</span><span style="color: #0000ff;">OBJPROP_BMPFILE</span><span>,0,</span><span style="color: #008080;">"::picture.bmp"</span><span>);</span><br> <span>...</span><br> <span>set=</span><span style="color: #0000ff;">ObjectSetString</span><span>(0,bitmap_label,</span><span style="color: #0000ff;">OBJPROP_BMPFILE</span><span>,1,</span><span style="color: #008080;">"::Files\\Pictures\\good.bmp"</span><span>);</span><br> <span>...</span><br> <span style="color: #0000ff;">PlaySound</span><span>(</span><span style="color: #008080;">"::Files\\Demo.wav"</span><span>);</span><br> <span>...</span><br> <span style="color: #0000ff;">PlaySound</span><span>(</span><span style="color: #008080;">"::Sounds\\thrill.wav"</span><span>);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Необходимо отметить, что при установке объектам </span><span>OBJ_BITMAP и OBJ_BITMAP_LABEL изображения из ресурса, значение свойства OBJPROP_BMPFILE уже нельзя менять вручную. Например, пусть мы используем для создания OBJ_BITMAP_LABEL ресурсы файлов euro.bmp и dollar.bmp.</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Images\\euro.bmp"</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;euro.bmp&nbsp;находится&nbsp;в&nbsp;каталог_данных_терминала\MQL4\Images\</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Images\\dollar.bmp"</span><span>;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;dollar.bmp&nbsp;находится&nbsp;в&nbsp;каталог_данных_терминала\MQL4\Images\</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Тогда при просмотре свойств этого объекта мы увидим, что свойства BitMap File (On) и BitMap File (Off) имеют серый цвет и недоступны для изменения вручную:</span></p> 
<p style="text-align: center;"><img alt="using_resource" width="505" height="301" style="margin:0px auto 0px auto;width:505px;height:301px;border:none" src="https://c.mql4.com/i/docs/ru/using_resource.png"></p> 
<p><span>&nbsp;</span></p> 
<h3>Использование ресурсов других mql4-программ</h3> 
<p><span>Использование ресурсов имеет и другое преимущество – в любой mql4-программе можно использовать ресурсы из любого файла EX4. Таким образом, ресурсы из одного файла EX4 можно использовать во многих других mql4-программах.</span></p> 
<p><span>Для того чтобы использовать имя ресурса из стороннего файла, его нужно указать в виде &lt;путь_имя_файла_EX4&gt;::&lt;имя_ресурса&gt;. Например, пусть в скрипте Draw_Triangles_Script.mq5 указан ресурс на картинку в файле triangle.bmp:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span>&nbsp;</span><span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Files\\triangle.bmp"</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Тогда его имя для использования в самом скрипте будет выглядеть как "Files\triangle.bmp", а для использования к имени ресурса нужно добавить &nbsp;специальный признак "::".</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;использование&nbsp;ресурса&nbsp;в&nbsp;самом&nbsp;скрипте</span><br> <span style="color: #0000ff;">ObjectSetString</span><span>(0,my_bitmap_name,</span><span style="color: #0000ff;">OBJPROP_BMPFILE</span><span>,0,</span><span style="color: #008080;">"::Files\\triangle.bmp"</span><span>);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Чтобы использовать этот же ресурс из другой программы, например, эксперта, нужно к имени ресурса дополнительно добавить путь к EX4-файлу относительно папки </span><span style="font-weight: bold;">каталог_данных_терминала\MQL4\</span><span> и</span><span style="font-weight: bold;"> </span><span>имя EX4-файла этого скрипта - </span><span style="font-weight: bold;">Draw_Triangles_Script.ex4</span><span>. Пусть скрипт лежит в стандартной папке </span><span style="font-weight: bold;">каталог_данных_терминала\MQL4\</span><span>Scripts\, тогда вызов нужно написать таким образом:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;использование&nbsp;ресурса&nbsp;скрипта&nbsp;в&nbsp;эксперте</span><br> <span style="color: #0000ff;">ObjectSetString</span><span>(0,my_bitmap_name,</span><span style="color: #0000ff;">OBJPROP_BMPFILE</span><span>,0,</span><span style="color: #008080;">"\\Scripts\\Draw_Triangles_Script.ex4::Files\\triangle.bmp"</span><span>);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Если при обращении к ресурсу в другом EX4-файле не указать путь к этому исполняемому файлу, то исполняемый файл ищется в той же папке, где находится и обратившаяся за ресурсом программа. Это означает, что если в советнике запрашивается ресурс из файла </span><span>Draw_Triangles_Script.ex4 без указания пути, например, так:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//---&nbsp;запрос&nbsp;ресурса&nbsp;скрипта&nbsp;в&nbsp;эксперте&nbsp;без&nbsp;указания&nbsp;пути</span><br> <span style="color: #0000ff;">ObjectSetString</span><span>(0,my_bitmap_name,</span><span style="color: #0000ff;">OBJPROP_BMPFILE</span><span>,0,</span><span style="color: #008080;">"Draw_Triangles_Script.ex4::Files\\triangle.bmp"</span><span>);</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>то файл будет искаться в папке </span><span style="font-weight: bold;">каталог_данных_терминала\MQL4\</span><span>Experts\, если сам советник находится в папке </span><span> </span><span style="font-weight: bold;">каталог_данных_терминала\MQL4\</span><span>Experts\.</span></p> 
<p><span>&nbsp;</span></p> 
<h3>Работа с пользовательскими индикаторами, подключенными в качестве ресурсов</h3> 
<p><span>Для работы mql4-программ может потребоваться один или несколько пользовательских индикаторов, все они могут быть включены в код исполняемой mql4-программы. Включение индикаторов в качестве ресурсов позволяет упростить распространение программ.</span></p> 
<p><span>Пример подключения и использования пользовательского индикатора SampleIndicator.ex4, расположенного в папке: </span><span style="font-weight: bold;">каталог_данных_терминала</span><span>\MQL4\Indicators\:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SampleEA.mq4&nbsp;|</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright&nbsp;2013,&nbsp;MetaQuotes&nbsp;Software&nbsp;Corp.&nbsp;|</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://www.mql5.com&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">#resource</span><span>&nbsp;</span><span style="color: #008080;">"\\Indicators\\SampleIndicator.ex4"</span><br> <span style="color: #0000ff;">#property&nbsp;strict</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Expert&nbsp;initialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;</span><span style="color: #0000ff;">OnInit</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;получим&nbsp;значение&nbsp;пользовательского&nbsp;индикатора</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;value=</span><span style="color: #0000ff;">iCustom</span><span>(</span><span style="color: #0000ff;">_Symbol</span><span>,</span><span style="color: #0000ff;">_Period</span><span>,</span><span style="color: #008080;">"::Indicators\\SampleIndicator.ex4"</span><span>,0,0);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Indicator:&nbsp;iCustom&nbsp;value=%f"</span><span>,value);</span><br> <span style="color: #808080;">//---&nbsp;...</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">INIT_SUCCEEDED</span><span>);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Случай, когда пользовательский индикатор в функции <a href="/basis/function/events#oninit">OnInit()</a> создает одну или несколько копий себя, требует отдельного рассмотрения. Напомним, что для использования ресурса из mql4-программы его необходимо указывать в виде: </span><span style="font-weight: bold;">&lt;путь_имя_файла_EX4&gt;::&lt;имя_ресурса&gt;</span><span>.</span></p>
<p><span>Например, если индикатор SampleIndicator.ex4 включается в советник SampleEA.ex4 в качестве ресурса, то путь к самому себе, указанный при вызове <a href="/indicators/icustom">iCustom()</a> в функции инициализации пользовательского индикатора, будет выглядеть следующим образом: "\\Experts\\SampleEA.ex4::Indicators\\SampleIndicator.ex4". При явном указании данного пути пользовательский индикатор SampleIndicator.ex4 будет жестко привязан к советнику SampleEA.ex4 и теряет способность самостоятельной работы.</span></p>
<p><span>Путь до самого себя можно получить при помощи функции GetRelativeProgramPath(), пример использования которой приведен ниже:</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SampleIndicator.mq4&nbsp;|</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright&nbsp;2013,&nbsp;MetaQuotes&nbsp;Software&nbsp;Corp.&nbsp;|</span><br> <span style="color: #808080;">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://www.mql5.com&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">indicator_separate_window</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;handle;</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Custom&nbsp;indicator&nbsp;initialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;</span><span style="color: #0000ff;">OnInit</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;неправильный&nbsp;способ&nbsp;указания&nbsp;ссылки&nbsp;на&nbsp;себя</span><br> <span style="color: #808080;">//---&nbsp;string&nbsp;path="\\Experts\\SampleEA.ex4::Indicators\\SampleIndicator.ex4";</span><br> <span style="color: #808080;">//---&nbsp;правильный&nbsp;способ&nbsp;получения&nbsp;ссылки&nbsp;на&nbsp;себя</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;path=GetRelativeProgramPath();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">double</span><span>&nbsp;value=</span><span style="color: #0000ff;">iCustom</span><span>(</span><span style="color: #0000ff;">_Symbol</span><span>,</span><span style="color: #0000ff;">_Period</span><span>,path,0,0);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">PrintFormat</span><span>(</span><span style="color: #008080;">"Path=%s,&nbsp;iCustom&nbsp;value=%f"</span><span>,path,value);</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">INIT_SUCCEEDED</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;GetRelativeProgramPath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">string</span><span>&nbsp;GetRelativeProgramPath()</span><br> <span>&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;pos2;</span><br> <span style="color: #808080;">//---&nbsp;получаем&nbsp;абсолютный&nbsp;путь&nbsp;к&nbsp;программе</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;path=</span><span style="color: #0000ff;">MQLInfoString</span><span>(</span><span style="color: #0000ff;">MQL_PROGRAM_PATH</span><span>);</span><br> <span style="color: #808080;">//---&nbsp;находим&nbsp;позицию&nbsp;подстроки&nbsp;"\MQL4\"</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=</span><span style="color: #0000ff;">StringFind</span><span>(path,</span><span style="color: #008080;">"\\MQL4\\"</span><span>);</span><br> <span style="color: #808080;">//---&nbsp;подстрока&nbsp;не&nbsp;найдена&nbsp;-&nbsp;ошибка</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(pos&lt;0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">NULL</span><span>);</span><br> <span style="color: #808080;">//---&nbsp;пропускаем&nbsp;каталог&nbsp;"\MQL4"</span><br> <span>&nbsp;&nbsp;&nbsp;pos+=5;</span><br> <span style="color: #808080;">//---&nbsp;пропускаем&nbsp;лишние&nbsp;'\'</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">while</span><span>(</span><span style="color: #0000ff;">StringGetCharacter</span><span>(path,pos+1)=='\\')</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos++;</span><br> <span style="color: #808080;">//---&nbsp;если&nbsp;это&nbsp;ресурс,&nbsp;возвращаем&nbsp;путь&nbsp;относительно&nbsp;MQL4-каталога</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">StringFind</span><span>(path,</span><span style="color: #008080;">"::"</span><span>,pos)&gt;=0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">StringSubstr</span><span>(path,pos));</span><br> <span style="color: #808080;">//---&nbsp;найдем&nbsp;разделитель&nbsp;для&nbsp;первого&nbsp;подкаталога&nbsp;в&nbsp;MQL4&nbsp;(например,&nbsp;MQL4\Indicators)</span><br> <span style="color: #808080;">//---&nbsp;если&nbsp;его&nbsp;нет,&nbsp;то&nbsp;вернем&nbsp;путь&nbsp;относительно&nbsp;MQL4-каталога</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>((pos2=</span><span style="color: #0000ff;">StringFind</span><span>(path,</span><span style="color: #008080;">"\\"</span><span>,pos+1))&lt;0)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">StringSubstr</span><span>(path,pos));</span><br> <span style="color: #808080;">//---&nbsp;вернем&nbsp;путь&nbsp;относительно&nbsp;подкаталога&nbsp;(например,&nbsp;MQL4\Indicators)</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">StringSubstr</span><span>(path,pos2+1));</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Custom&nbsp;indicator&nbsp;iteration&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">int</span><span>&nbsp;</span><span style="color: #0000ff;">OnCalculate</span><span>(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;rates_total,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;prev_calculated,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;begin,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">double</span><span>&amp;&nbsp;price[])</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;return&nbsp;value&nbsp;of&nbsp;prev_calculated&nbsp;for&nbsp;next&nbsp;call</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(rates_total);</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<p><span>Смотри также</span></p> 
<p><span><a href="/common/resourcecreate">ResourceCreate()</a>, <a href="/common/resourcesave">ResourceSave()</a>, <a href="/common/playsound">PlaySound()</a>, <a href="/objects/objectsetinteger">ObjectSetInteger()</a>, <a href="/chart_operations/chartapplytemplate">ChartApplyTemplate()</a>, <a href="/files">Файловые операции</a> </span></p>
<br>