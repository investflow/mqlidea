<h1>OBJ_VLINE</h1> 
<p><span>Вертикальная линия.</span></p> 
<p style="text-align: center;"><img alt="ObjVLine" width="580" height="371" style="margin:0px auto 0px auto;width:580px;height:371px;border:none" src="https://c.mql4.com/i/docs/ru/objvline.png"></p> 
<p><span>Пример</span></p> 
<p><span>Следующий скрипт создает и перемещает на графике вертикальную линию. Для создания и изменения свойств графического объекта написаны специальные функции, которые вы можете использовать "как есть" в своих собственных программах.</span></p> 
<div style="text-align: left; text-indent: 0px; page-break-inside: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"> 
 <table cellpadding="3" style="border:none; border-spacing:0px;"> 
  <tbody> 
   <tr>
    <td style="vertical-align:top; padding:3px;"><p><span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">strict</span><br> <span style="color: #808080;">//---&nbsp;описание</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"Скрипт&nbsp;строит&nbsp;графический&nbsp;объект&nbsp;\"Вертикальная&nbsp;линия\"."</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"Дата&nbsp;точки&nbsp;привязки&nbsp;задается&nbsp;в&nbsp;процентах&nbsp;от&nbsp;ширины"</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">description</span><span>&nbsp;</span><span style="color: #008080;">"окна&nbsp;графика&nbsp;в&nbsp;барах."</span><br> <span style="color: #808080;">//---&nbsp;покажем&nbsp;окно&nbsp;входных&nbsp;параметров&nbsp;при&nbsp;запуске&nbsp;скрипта</span><br> <span style="color: #0000ff;">#property</span><span>&nbsp;</span><span style="color: #0000ff;">script_show_inputs</span><br> <span style="color: #808080;">//---&nbsp;входные&nbsp;параметры&nbsp;скрипта</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InpName=</span><span style="color: #008080;">"VLine"</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Имя&nbsp;линии</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InpDate=25;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Дата&nbsp;линии&nbsp;в&nbsp;%</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">color</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InpColor=</span><span style="color: #0000ff;">clrRed</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Цвет&nbsp;линии</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">ENUM_LINE_STYLE</span><span>&nbsp;InpStyle=</span><span style="color: #0000ff;">STYLE_DASH</span><span>;&nbsp;</span><span style="color: #808080;">//&nbsp;Стиль&nbsp;линии</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InpWidth=1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Толщина&nbsp;линии</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InpBack=</span><span style="color: #0000ff;">false</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Линия&nbsp;на&nbsp;заднем&nbsp;плане</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InpSelection=</span><span style="color: #0000ff;">true</span><span>;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Выделить&nbsp;для&nbsp;перемещений</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InpHidden=</span><span style="color: #0000ff;">true</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Скрыт&nbsp;в&nbsp;списке&nbsp;объектов</span><br> <span style="color: #0000ff;">input</span><span>&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InpZOrder=0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;Приоритет&nbsp;на&nbsp;нажатие&nbsp;мышью</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Создает&nbsp;вертикальную&nbsp;линию&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;VLineCreate(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chart_ID=0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;ID&nbsp;графика</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name=</span><span style="color: #008080;">"VLine"</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_window=0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;номер&nbsp;подокна</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">datetime</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">time</span><span>=0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;время&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">color</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr=</span><span style="color: #0000ff;">clrRed</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;цвет&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">ENUM_LINE_STYLE</span><span>&nbsp;style=</span><span style="color: #0000ff;">STYLE_SOLID</span><span>,&nbsp;</span><span style="color: #808080;">//&nbsp;стиль&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width=1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;толщина&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;back=</span><span style="color: #0000ff;">false</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;на&nbsp;заднем&nbsp;плане</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selection=</span><span style="color: #0000ff;">true</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;выделить&nbsp;для&nbsp;перемещений</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">bool</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hidden=</span><span style="color: #0000ff;">true</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;скрыт&nbsp;в&nbsp;списке&nbsp;объектов</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z_order=0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;приоритет&nbsp;на&nbsp;нажатие&nbsp;мышью</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;если&nbsp;время&nbsp;линии&nbsp;не&nbsp;задано,&nbsp;то&nbsp;проводим&nbsp;ее&nbsp;через&nbsp;последний&nbsp;бар</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!</span><span style="color: #0000ff;">time</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">time</span><span>=</span><span style="color: #0000ff;">TimeCurrent</span><span>();</span><br> <span style="color: #808080;">//---&nbsp;сбросим&nbsp;значение&nbsp;ошибки</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span style="color: #808080;">//---&nbsp;создадим&nbsp;вертикальную&nbsp;линию</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!</span><span style="color: #0000ff;">ObjectCreate</span><span>(chart_ID,name,</span><span style="color: #0000ff;">OBJ_VLINE</span><span>,sub_window,</span><span style="color: #0000ff;">time</span><span>,0))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">__FUNCTION__</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">":&nbsp;не&nbsp;удалось&nbsp;создать&nbsp;вертикальную&nbsp;линию!&nbsp;Код&nbsp;ошибки&nbsp;=&nbsp;"</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;установим&nbsp;цвет&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(chart_ID,name,</span><span style="color: #0000ff;">OBJPROP_COLOR</span><span>,clr);</span><br> <span style="color: #808080;">//---&nbsp;установим&nbsp;стиль&nbsp;отображения&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(chart_ID,name,</span><span style="color: #0000ff;">OBJPROP_STYLE</span><span>,style);</span><br> <span style="color: #808080;">//---&nbsp;установим&nbsp;толщину&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(chart_ID,name,</span><span style="color: #0000ff;">OBJPROP_WIDTH</span><span>,width);</span><br> <span style="color: #808080;">//---&nbsp;отобразим&nbsp;на&nbsp;переднем&nbsp;(false)&nbsp;или&nbsp;заднем&nbsp;(true)&nbsp;плане</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(chart_ID,name,</span><span style="color: #0000ff;">OBJPROP_BACK</span><span>,back);</span><br> <span style="color: #808080;">//---&nbsp;включим&nbsp;(true)&nbsp;или&nbsp;отключим&nbsp;(false)&nbsp;режим&nbsp;перемещения&nbsp;линии&nbsp;мышью</span><br> <span style="color: #808080;">//---&nbsp;при&nbsp;создании&nbsp;графического&nbsp;объекта&nbsp;функцией&nbsp;ObjectCreate,&nbsp;по&nbsp;умолчанию&nbsp;объект</span><br> <span style="color: #808080;">//---&nbsp;нельзя&nbsp;выделить&nbsp;и&nbsp;перемещать.&nbsp;Внутри&nbsp;же&nbsp;этого&nbsp;метода&nbsp;параметр&nbsp;selection</span><br> <span style="color: #808080;">//---&nbsp;по&nbsp;умолчанию&nbsp;равен&nbsp;true,&nbsp;что&nbsp;позволяет&nbsp;выделять&nbsp;и&nbsp;перемещать&nbsp;этот&nbsp;объект</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(chart_ID,name,</span><span style="color: #0000ff;">OBJPROP_SELECTABLE</span><span>,selection);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(chart_ID,name,</span><span style="color: #0000ff;">OBJPROP_SELECTED</span><span>,selection);</span><br> <span style="color: #808080;">//---&nbsp;скроем&nbsp;(true)&nbsp;или&nbsp;отобразим&nbsp;(false)&nbsp;имя&nbsp;графического&nbsp;объекта&nbsp;в&nbsp;списке&nbsp;объектов</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(chart_ID,name,</span><span style="color: #0000ff;">OBJPROP_HIDDEN</span><span>,hidden);</span><br> <span style="color: #808080;">//---&nbsp;установим&nbsp;приоритет&nbsp;на&nbsp;получение&nbsp;события&nbsp;нажатия&nbsp;мыши&nbsp;на&nbsp;графике</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ObjectSetInteger</span><span>(chart_ID,name,</span><span style="color: #0000ff;">OBJPROP_ZORDER</span><span>,z_order);</span><br> <span style="color: #808080;">//---&nbsp;успешное&nbsp;выполнение</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">true</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Перемещение&nbsp;вертикальной&nbsp;линии&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;VLineMove(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;&nbsp;&nbsp;chart_ID=0,&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;ID&nbsp;графика</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;name=</span><span style="color: #008080;">"VLine"</span><span>,&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">datetime</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">time</span><span>=0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;время&nbsp;линии</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;если&nbsp;время&nbsp;линии&nbsp;не&nbsp;задано,&nbsp;то&nbsp;перемещаем&nbsp;ее&nbsp;на&nbsp;последний&nbsp;бар</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!</span><span style="color: #0000ff;">time</span><span>)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">time</span><span>=</span><span style="color: #0000ff;">TimeCurrent</span><span>();</span><br> <span style="color: #808080;">//---&nbsp;сбросим&nbsp;значение&nbsp;ошибки</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span style="color: #808080;">//---&nbsp;переместим&nbsp;вертикальную&nbsp;линию</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!</span><span style="color: #0000ff;">ObjectMove</span><span>(chart_ID,name,0,</span><span style="color: #0000ff;">time</span><span>,0))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">__FUNCTION__</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">":&nbsp;не&nbsp;удалось&nbsp;переместить&nbsp;вертикальную&nbsp;линию!&nbsp;Код&nbsp;ошибки&nbsp;=&nbsp;"</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;успешное&nbsp;выполнение</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">true</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Удаляет&nbsp;вертикальную&nbsp;линию&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">bool</span><span>&nbsp;VLineDelete(</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">long</span><span>&nbsp;&nbsp;&nbsp;chart_ID=0,&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;ID&nbsp;графика</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">const</span><span>&nbsp;</span><span style="color: #0000ff;">string</span><span>&nbsp;name=</span><span style="color: #008080;">"VLine"</span><span>)&nbsp;</span><span style="color: #808080;">//&nbsp;имя&nbsp;линии</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;сбросим&nbsp;значение&nbsp;ошибки</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span style="color: #808080;">//---&nbsp;удалим&nbsp;вертикальную&nbsp;линию</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!</span><span style="color: #0000ff;">ObjectDelete</span><span>(chart_ID,name))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #0000ff;">__FUNCTION__</span><span>,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008080;">":&nbsp;не&nbsp;удалось&nbsp;удалить&nbsp;вертикальную&nbsp;линию!&nbsp;Код&nbsp;ошибки&nbsp;=&nbsp;"</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">false</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;успешное&nbsp;выполнение</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>(</span><span style="color: #0000ff;">true</span><span>);</span><br> <span>&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br> <span style="color: #808080;">//+------------------------------------------------------------------+</span><br> <span style="color: #0000ff;">void</span><span>&nbsp;</span><span style="color: #0000ff;">OnStart</span><span>()</span><br> <span>&nbsp;&nbsp;{</span><br> <span style="color: #808080;">//---&nbsp;проверим&nbsp;входные&nbsp;параметры&nbsp;на&nbsp;корректность</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(InpDate&lt;0&nbsp;||&nbsp;InpDate&gt;100)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Ошибка!&nbsp;Некорректные&nbsp;значения&nbsp;входных&nbsp;параметров!"</span><span>);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;количество&nbsp;видимых&nbsp;баров&nbsp;в&nbsp;окне&nbsp;графика</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;</span><span style="color: #0000ff;">bars</span><span>=(</span><span style="color: #0000ff;">int</span><span>)</span><span style="color: #0000ff;">ChartGetInteger</span><span>(0,</span><span style="color: #0000ff;">CHART_VISIBLE_BARS</span><span>);</span><br> <span style="color: #808080;">//---&nbsp;массив&nbsp;для&nbsp;хранения&nbsp;значений&nbsp;дат,&nbsp;которые&nbsp;будут&nbsp;использованы</span><br> <span style="color: #808080;">//---&nbsp;для&nbsp;установки&nbsp;и&nbsp;изменения&nbsp;координаты&nbsp;точки&nbsp;привязки&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">datetime</span><span>&nbsp;date[];</span><br> <span style="color: #808080;">//---&nbsp;выделение&nbsp;памяти</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ArrayResize</span><span>(date,</span><span style="color: #0000ff;">bars</span><span>);</span><br> <span style="color: #808080;">//---&nbsp;заполним&nbsp;массив&nbsp;дат</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ResetLastError</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">CopyTime</span><span>(</span><span style="color: #0000ff;">Symbol</span><span>(),</span><span style="color: #0000ff;">Period</span><span>(),0,</span><span style="color: #0000ff;">bars</span><span>,date)==-1)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Print</span><span>(</span><span style="color: #008080;">"Не&nbsp;удалось&nbsp;скопировать&nbsp;значения&nbsp;времени!&nbsp;Код&nbsp;ошибки&nbsp;=&nbsp;"</span><span>,</span><span style="color: #0000ff;">GetLastError</span><span>());</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;определим&nbsp;точки&nbsp;для&nbsp;рисования&nbsp;линии</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;d=InpDate*(</span><span style="color: #0000ff;">bars</span><span>-1)/100;</span><br> <span style="color: #808080;">//---&nbsp;создадим&nbsp;вертикальную&nbsp;линию</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!VLineCreate(0,InpName,0,date[d],InpColor,InpStyle,InpWidth,InpBack,</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InpSelection,InpHidden,InpZOrder))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>;</span><br> <span style="color: #808080;">//---&nbsp;перерисуем&nbsp;график&nbsp;и&nbsp;подождем&nbsp;1&nbsp;секунду</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ChartRedraw</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Sleep</span><span>(1000);</span><br> <span style="color: #808080;">//---&nbsp;теперь&nbsp;будем&nbsp;перемещать&nbsp;линию</span><br> <span style="color: #808080;">//---&nbsp;счетчик&nbsp;цикла</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span>&nbsp;h_steps=</span><span style="color: #0000ff;">bars</span><span>/2;</span><br> <span style="color: #808080;">//---&nbsp;перемещаем&nbsp;линию</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span>(</span><span style="color: #0000ff;">int</span><span>&nbsp;i=0;i&lt;h_steps;i++)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;возьмем&nbsp;следующее&nbsp;значение</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(d&lt;</span><span style="color: #0000ff;">bars</span><span>-1)</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d+=1;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;сдвигаем&nbsp;точку</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(!VLineMove(0,InpName,date[d]))</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;проверим&nbsp;факт&nbsp;принудительного&nbsp;завершения&nbsp;скрипта</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span>(</span><span style="color: #0000ff;">IsStopped</span><span>())</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span>;</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//---&nbsp;перерисуем&nbsp;график</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ChartRedraw</span><span>();</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #808080;">//&nbsp;задержка&nbsp;в&nbsp;0.03&nbsp;секунды</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Sleep</span><span>(30);</span><br> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br> <span style="color: #808080;">//---&nbsp;задержка&nbsp;в&nbsp;1&nbsp;секунду</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Sleep</span><span>(1000);</span><br> <span style="color: #808080;">//---&nbsp;удалим&nbsp;канал&nbsp;с&nbsp;графика</span><br> <span>&nbsp;&nbsp;&nbsp;VLineDelete(0,InpName);</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">ChartRedraw</span><span>();</span><br> <span style="color: #808080;">//---&nbsp;задержка&nbsp;в&nbsp;1&nbsp;секунду</span><br> <span>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">Sleep</span><span>(1000);</span><br> <span style="color: #808080;">//---</span><br> <span>&nbsp;&nbsp;}</span></p></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<br>